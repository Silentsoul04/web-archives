<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Debian -- Automated Audit Example: RATS </title>
  <link rel="author" href="mailto:webmaster@debian.org">
  <meta name="Generator" content="WML 2.12.2">
  <meta name="Modified" content="2021-06-11 12:44:31">
  <meta name="viewport" content="width=device-width">
  <meta name="mobileoptimized" content="300">
  <meta name="HandheldFriendly" content="true">
<link href="../../../debian.css" rel="stylesheet" type="text/css">
  <link href="../../../debian-en.css" rel="stylesheet" type="text/css" media="all">
<link rel="search" type="application/opensearchdescription+xml" title="Debian website search" href="../../../search.en.xml">
</head>
<body>
<div id="header">
  <div id="upperheader">
    <div id="logo">
    <a href="../../../" title="Debian Home"><img src="../../../Pics/openlogo-50.png" alt="Debian" width="50" height="61"></a>
    </div> <!-- end logo -->
    <div id="searchbox">
      <form name="p" method="get" action="https://search.debian.org/cgi-bin/omega">
      <p>
<input type="hidden" name="DB" value="en">
        <input name="P" value="" size="14">
        <input type="submit" value="Search">
      </p>
      </form>
    </div>   <!-- end sitetools -->
  </div> <!-- end upperheader -->
  <!--UdmComment-->
  <div id="navbar">
    <p class="hidecss"><a href="#content">Skip Quicknav</a></p>
    <ul>
      <!-- Link to Debian's own Social Media resources -->
      <li><a href="https://bits.debian.org/" title="Bits from Debian">Blog</a></li>
      <li><a href="https://micronews.debian.org" title="Micronews from Debian">Micronews</a></li>
      <li><a href="https://planet.debian.org/" title="The Planet of Debian">Planet</a></li>
    </ul>
  </div> <!-- end navbar -->
<p id="breadcrumbs"><a href="./../../">Security Information</a>
 &#x2F; <a href="./../">Debian Security Audit Project</a>
 &#x2F; <a href="./">Automated Audit Examples</a>
 &#x2F;
Automated Audit Example: RATS</p>
</div> <!-- end header -->
<!--/UdmComment-->
<div id="content">
<h1>Automated Audit Example: RATS</h1>
<p><a href="https://packages.debian.org/rats">RATS</a> is a general purpose scanner for detecting potential security problems in a number of programming languages.</p>
<h2>Running RATS</h2>
<p>Running RATS is as simple as invoking the command with a directory to process. Each of the recognised source files it finds will be processed. RATS understands several programming languages, C, Perl, PHP, and Python and will treat each as valid source to examine.</p>
<p>There are several options which may be given in addition to a directory name to scane, these are described in the manpage.</p>
<p>The most useful of the options are those concerning the output, such as:</p>
<ul>
<li>--warning &lt;level&gt; (Set the level of flaws to be reported upon)
<ul>
<li>1 includes only default and high severity.</li>
<li>2 includes medium severity (default).</li>
<li>3 includes low severity vulnerabilities.</li>
</ul></li>
<li>--xml (Output in XML)</li>
<li>--html (Output in HTML)</li>
</ul>
<p>Assuming that we have the <a href="test.c.html">test file</a> located in the current directory, with no other source files we can invoke the scanner with the following command:</p>
<pre>
rats --warning 1 --html . &gt;output.html
</pre>
<p>This will produce an HTML file containing the results of the scan, which can be loaded by a browser.</p>
<h2>The Results</h2>
<p>Running RATS against our <a href="test.c.html">sample code</a> produces the following output:</p>
<hr>
<div class="sampleblock">
<h3>Severity: High</h3>
<p>Issue: fixed size global buffer</p>
<p>
  Extra care should be taken to ensure that character arrays that are
  allocated on the stack are used safely. They are prime targets for
  buffer overflow attacks.
</p>
<p>
File: <b>test.c</b><br>
Lines: 10 11 12
</p>
<h3>Severity: High</h3>
<p>Issue: strcpy</p>
<p>
    Check to be sure that argument 2 passed to this function call will not
    copy more data than can be handled, resulting in a buffer overflow.
  </p>
<p>
File: <b>test.c</b><br>
Lines: 18
</p>
<h3>Severity: High</h3>
<p>Issue: getenv</p>
<p>Environment variables are highly untrustable input. They may be of any length, and contain any data. Do not make any assumptions regarding content or length. If at all possible avoid using them, and if it is necessary, sanitize them and truncate them to a reasonable length.
  </p>
<p>
File: <b>test.c</b><br>
Lines: 22 24 </p>
<h3>Severity: High</h3>
<p>Issue: sprintf</p>
<p>
    Check to be sure that the format string passed as argument 2 to this
    function call does not come from an untrusted source that could have added
    formatting characters that the code is not prepared to handle.
    Additionally, the format string could contain `%s' without precision that
    could result in a buffer overflow.
</p>
<p>
File: <b>test.c</b><br>
Lines: 24 </p>
<h3>Severity: High</h3>
<p>Issue: popen</p>
<p>
    Argument 1 to this function call should be checked to ensure that it does
    not come from an untrusted source without first verifying that it contains
    nothing dangerous.
</p>
<p>
File: <b>test.c</b><br>
Lines: 33 </p>
<h3>Severity: High</h3>
<p> Issue: printf</p>
<p>
    Check to be sure that the non-constant format string passed as argument 1
    to this function call does not come from an untrusted source that could
    have added formatting characters that the code is not prepared to handle.
</p>
<p>
File: <b>test.c</b><br>
Lines: 42 </p>
<p>
Total lines analyzed: <b>49</b><br>
Total time <b>0.000288</b> seconds<br>
<b>170138</b> lines per second</p>
</div>
<hr>
<p>This output is quite volumous, despite the code itself being very short - this shows one of the downsides of automated scanning which is the sheer volume of output.</p>
<h2>Understanding The Output</h2>
<p>The output that has been produced is basically a description of the functions which it encountered, the line number of which the flaw was detected and a description of the problem. (As we used the "--warning" level to restrict the output to only "high" level functions we've reduced the output somewhat.)</p>
<p>Each of the issues that have been discovered should be manually examined to see if there is something really wrong, or if it was a false positive (ie. a function that may be misused being used correctly).</p>
<p>In this case we can see that all of the vulnerabilities in our code have been spotted, but it's not exactly clear without going through the code with an editor and matching up the lines.</p>
<p>One big omission is that the output doesn't include the lines which are reported upon - something that <a href="flawfinder">flawfinder</a> does allow you to include.</p>
<hr>
<p><a href="..">Back to the auditing project</a> | <a href="index">Back to the sample auditing page</a></p>
<div class="clr"></div>
</div> <!-- end content -->
<div id="footer">
<hr class="hidecss">
<p>Back to the <a href="../../../">Debian Project homepage</a>.</p>
<hr>
<!--UdmComment-->
<div id="pageLang">
<div id="langSelector">
This page is also available in the following languages:
<div id="langContainer">
 <a href="RATS.de.html" title="German" hreflang="de" lang="de" rel="alternate">Deutsch</a>
 <a href="RATS.es.html" title="Spanish" hreflang="es" lang="es" rel="alternate">espa&ntilde;ol</a>
 <a href="RATS.fr.html" title="French" hreflang="fr" lang="fr" rel="alternate">fran&ccedil;ais</a>
 <a href="RATS.nl.html" title="Dutch" hreflang="nl" lang="nl" rel="alternate">Nederlands</a>
 <a href="RATS.pt.html" title="Portuguese" hreflang="pt" lang="pt" rel="alternate">Portugu&ecirc;s</a>
 <a href="RATS.ru.html" title="Russian" hreflang="ru" lang="ru" rel="alternate">&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;&nbsp;(Russkij)</a>
</div>
How to set <a href="../../../intro/cn">the default document language</a>
</div></div><!--/UdmComment-->
<hr>
<div id="footermap">
<!--UdmComment-->
<p><strong><a href="/">Home</a></strong></p>
    <ul id="footermap-cola">
		<li><a href="../../../intro/about">About</a>
		  <ul>
		  <li><a href="../../../social_contract">Social Contract</a></li>
		  <li><a href="../../../code_of_conduct">Code of Conduct</a></li>
		  <li><a href="../../../intro/free">Free Software</a></li>
		  <li><a href="../../../partners/">Partners</a></li>
		  <li><a href="../../../donations">Donations</a></li>
          <li><a href="../../../legal">Legal Info</a></li>
          <li><a href="../../../legal/privacy">Data Privacy</a></li>
		  <li><a href="../../../contact">Contact Us</a></li>
		  </ul>
		</li>
        <li><a href="../../../intro/help">Help Debian</a></li>
    </ul>
	<ul id="footermap-colb">
			<li><a href="../../../distrib/">Getting Debian</a>
			  <ul>
			  <li><a href="../../../distrib/netinst">Network install</a></li>
			  <li><a href="../../../CD/">CD/USB ISO images</a></li>
			  <li><a href="../../../CD/vendors/">CD vendors</a></li>
			  <li><a href="../../../distrib/pre-installed">Pre-installed</a></li>
			  </ul>
			</li>
            <li><a href="../../../blends/">Pure Blends</a></li>
			<li><a href="../../../distrib/packages">Debian Packages</a></li>
			<li><a href="../../../devel/">Developers' Corner</a></li>
	</ul>
	<ul id="footermap-colc">
		<li><a href="../../../News/">News</a>
		  <ul>
		  <li><a href="../../../News/weekly/">Project News</a></li>
		  <li><a href="../../../events/">Events</a></li>
		  </ul>
		</li>
    <li><a href="../../../doc/">Documentation</a>
      <ul>
      <li><a href="../../../releases/">Release Info</a></li>
      <li><a href="../../../releases/stable/installmanual">Installation manual</a></li>
      <li><a href="../../../doc/books">Debian Books</a></li>
      <li><a href="https://wiki.debian.org/">Debian Wiki</a></li>
      </ul>
    </li>
   </ul>
   <ul id="footermap-cold">
    <li><a href="../../../support">Support</a>
	  <ul>
			  <li><a href="../../../international/">Debian International</a></li>
			  <li><a href="../../../security/">Security Information</a></li>
			  <li><a href="../../../Bugs/">Bug reports</a></li>
			  <li><a href="../../../MailingLists/">Mailing Lists</a></li>
			  <li><a href="https://lists.debian.org/">Mailing List Archives</a></li>
			  <li><a href="../../../ports/">Ports/Architectures</a></li>
      </ul>
    </li>
</ul>
<ul id="footermap-cole">
  <li><a href="../../../sitemap">Site map</a></li>
  <li><a href="https://search.debian.org/">Search</a></li>
  <li><a href="https://bits.debian.org">The Debian Blog</a></li>
  <li><a href="https://micronews.debian.org">Debian Micronews</a></li>
  <li><a href="https://planet.debian.org">Debian Planet</a></li>
</ul>
<!--/UdmComment-->
</div> <!-- end footermap -->
<div id="fineprint">
  <p>To report a problem with the web site, please e-mail our publicly archived mailing list <a href="mailto:debian-www@lists.debian.org">debian-www@lists.debian.org</a> in English. For other contact information, see the Debian <a href="../../../contact">contact page</a>. Web site source code is <a href="https://salsa.debian.org/webmaster-team/webwml">available</a>.</p>
<p>
Last Modified: Sat, Sep 19 05:49:02 UTC 2020
&emsp;
Last Built: Fri, Jun 11 12:44:31 UTC 2021
  <br>
  Copyright &copy; 1997-2020
 <a href="https://www.spi-inc.org/">SPI</a> and others; See <a href="../../../license" rel="copyright">license terms</a><br>
  Debian is a registered <a href="../../../trademark">trademark</a> of Software in the Public Interest, Inc.
</p>
</div>
</div> <!-- end footer -->
</body>
</html>
