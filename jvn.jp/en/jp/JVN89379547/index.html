<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>JVN#89379547: Apache Commons FileUpload vulnerable to denial-of-service (DoS)</title>
	<meta name="Keywords" content="Japan Vulnerability Notes" />
	<meta name="Description" content="Japan Vulnerability Notes" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<link href="/common/css/master.css" rel="stylesheet" type="text/css" media="screen,print" />
	<link href="/common/css/font.css" rel="stylesheet" type="text/css" media="screen,print" />
	<link href="/common/css/print.css" rel="stylesheet" type="text/css" media="print" />
	<link href="/common/css/rightmenu.css" rel="stylesheet" type="text/css" media="screen,print" />
	<script src="/common/js/swapImg.js" type="text/javascript"></script>
	<script src="/common/js/cvss.js" type="text/javascript"></script>
    <style type="text/css">
        .margin_list ul {
            padding-left:16px;
            margin-left:16px;
        }
    </style>
</head>
<body>
<a name="top" id="top"></a>
<div id="wrapper">
  <!-- header begin -->
  <div id="header">
    <div class="logo"><img src="/common/img/note_logo.gif" border="0" alt="Japan Vulnerability Notes" width="370" height="45" /></div>
  </div>
  <!-- header begin -->

  <!-- mainarea begin -->
  <div id="mainarea">
    <!-- leftarea begin -->
    <div id="leftarea">
      <div id="head-bar2">
        <div id="head-bar-txt"><span class="margin-lb">Published:2016/06/30&nbsp;&nbsp;Last Updated:2018/01/26</span></div>
      </div>
      <h1 class="h1ver2">
        JVN#89379547<br />
        Apache Commons FileUpload vulnerable to denial-of-service (DoS)<br />
              </h1>
      <!-- textbox begin -->
      <div class="textbox margin_list">
        <h2>Overview</h2>
        <p>Apache Commons FileUpload contains a denial-of-service (DoS) vulnerability.</p>
      </div>
      <!-- textbox end -->


      <!-- textbox begin -->
      <div class="textbox margin_list">
        <h2>Products Affected</h2>
        <p><ul>
	<li>Commons FileUpload 1.3 to 1.3.1</li>
	<li>Commons FileUpload 1.2 to 1.2.2</li>
	<li>Tomcat 9.0.0.M1 to 9.0.0M6</li>
	<li>Tomcat 8.5.0 to 8.5.2</li>
	<li>Tomcat 8.0.0.RC1 to 8.0.35</li>
	<li>Tomcat 7.0.0 to 7.0.69</li>
	<li>Struts 2.5.x and earlier</li>
</ul>
According to the developer, the unsupported versions of Commons FileUpload 1.0.x and 1.1.x may also be affected.<br />
<br />
The developer also states that Apache Commons FileUpload is widely used for multiple Apache products, therefore, multiple Apache products other than&nbsp; Tomcat and Struts 2 may be affected by this vulnerability.<br />
According to the developer, the following products may be affected.
<ul>
	<li>Jenkins</li>
	<li>JSPWiki</li>
	<li>JXP</li>
	<li>Lucene-Solr</li>
	<li>onemind-commons</li>
	<li>Spring</li>
	<li>Stapler</li>
	<li>Struts 1</li>
	<li>WSDL2c</li>
</ul></p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox margin_list">
        <h2>Description</h2>
        <p>Apache Commons FileUpload provided by the Apache Software Foundation contains a flaw when processing multi-part requests, which may lead to a denial-of-service (DoS).</p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox margin_list">
        <h2>Impact</h2>
        <p>Processing a specially crafted request may result in the server&#39;s CPU resources to be exhausted.</p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox margin_list">
        <h2>Solution</h2>
        <p><strong>Apply the update</strong><br />
Update to the latest version that contains a fix fot this vulnerability:
<ul>
	<li><a href="http://commons.apache.org/proper/commons-fileupload/download_fileupload.cgi">Commons Fileupload 1.3.2</a></li>
	<li><a href="http://www.apache.org/dist/tomcat/tomcat-9/v9.0.0.M8/">Tomcat 9.0.0M8</a></li>
	<li><a href="http://www.apache.org/dist/tomcat/tomcat-8/v8.5.3/">Tomcat 8.5.3</a></li>
	<li><a href="http://www.apache.org/dist/tomcat/tomcat-8/v8.0.36/">Tomcat 8.0.36</a></li>
	<li><a href="http://www.apache.org/dist/tomcat/tomcat-7/v7.0.70/">Tomcat 7.0.70</a></li>
</ul>
User of Apache Struts should replace the copy of Commons FileUpload with the fixed version.<br />
<br />
<strong>Apply a workaround</strong><br />
Until an update can be applied, the following workaround may mitigate the effect of this vulnerability.
<ul>
	<li>Llimit the maximum size of HTTP requests</li>
</ul>
According to the developer, Apache Httpd contains the LimitRequestFieldSize directive and Apache Tomcat contains the maxHttpHeaderSize attribute in their respective configuration files to limit the maximum size for HTTP requests. Also it is stated that limiting the maximum size to 2048 bytes will mitigate this vulnerability. For more details, refer to the information provided by the developer.</p>
      </div>
      <!-- textbox end -->


            <!-- textbox begin -->
      <div class="textbox">
        <!-- table begin -->
        <h2>Vendor Status</h2>
                <div class="tbl-vinfo">
          <table border="0" cellspacing="1" cellpadding="0" width="100%">
            <tr>
              <th class="wdt-a">Vendor</th>
              <th>Status</th>
              <th class="wdt-b" nowrap>Last Update</th>
              <th>Vendor Notes</th>
            </tr>

                        <tr>
              <td>FUJITSU LIMITED</td>
              <td>
                                                                            <a href="2390/index.html">Vulnerable</a>
                                                                    </td>
              <td>2018/01/26</td>
              <td>
                              </td>
            </tr>
                        <tr>
              <td>NEC Corporation</td>
              <td>
                                                                            <a href="6443/index.html">Vulnerable</a>
                                                                    </td>
              <td>2016/09/15</td>
              <td>
                              </td>
            </tr>
                        <tr>
              <td>NTT DATA Corporation</td>
              <td>
                                                                            <a href="995570/index.html">Vulnerable</a>
                                                                    </td>
              <td>2016/08/03</td>
              <td>
                                <a href="https://en.osdn.jp/projects/terasoluna/" target="_top">NTT DATA Corporation website</a>
                              </td>
            </tr>
                      </table>
        </div>
                <!-- table end -->

        <!-- Vendor status written in English starts from here
        Vendor status written in English is end -->

        <!-- table begin -->
        <div class="margin-tbd">

                    <div class="ie5">
            <table class="style_table" border="0" cellspacing="1">
              <tbody>
                <tr>
                  <td class="style_td">
                    Vendor
                  </td>
                  <td class="style_td">
                    Link
                  </td>
                </tr>
                                <tr>
                  <td class="style_td">
                    ASF Apache Commons FileUpload                  </td>
                  <td class="style_td">
                                        <a href="https://mail-archives.apache.org/mod_mbox/www-announce/201606.mbox/%3C45A20804-ABFF-4FED-A297-69AC95AB9A3F@apache.org%3E" target="_top">Fwd: CVE-2016-3092: Apache Commons Fileupload information disclosure vulnerability (www-announce mailing list archives)</a>
                                      </td>
                </tr>
                                <tr>
                  <td class="style_td">
                                      </td>
                  <td class="style_td">
                                        <a href="http://commons.apache.org/proper/commons-fileupload/download_fileupload.cgi" target="_top">Download Apache Commons FileUpload -- Apache Commons FileUpload 1.3.2</a>
                                      </td>
                </tr>
                                <tr>
                  <td class="style_td">
                    ASF Apache Tomcat                  </td>
                  <td class="style_td">
                                        <a href="http://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.0.M8" target="_top">Fixed in Apache Tomcat 9.0.0.M8</a>
                                      </td>
                </tr>
                                <tr>
                  <td class="style_td">
                                      </td>
                  <td class="style_td">
                                        <a href="http://tomcat.apache.org/security-8.html#Fixed_in_Apache_Tomcat_8.5.3_and_8.0.36" target="_top">Fixed in Apache Tomcat 8.5.3 and 8.0.36</a>
                                      </td>
                </tr>
                                <tr>
                  <td class="style_td">
                                      </td>
                  <td class="style_td">
                                        <a href="http://tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.70" target="_top">Fixed in Apache Tomcat 7.0.70</a>
                                      </td>
                </tr>
                              </tbody>
            </table>
          </div>
          
        </div>
        <!-- table end -->
      </div>
      <!-- textbox end -->
      
      <!-- textbox begin -->
      <div class="textbox">
        <h2>References</h2>
        <p>
          <ol class='list1' style='padding-left:16px;margin-left:16px'>
                      </ol>
          <p class='empty'></p>
        </p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox">
        <h2>JPCERT/CC Addendum</h2>
        <p><p>The title in the <a href="https://mail-archives.apache.org/mod_mbox/www-announce/201606.mbox/%3C45A20804-ABFF-4FED-A297-69AC95AB9A3F@apache.org%3E">link</a> under &quot;Vendor Status&quot; states an &quot;information disclosure vulnerability&quot; but &quot;Denial of Service (DoS)&quot; is correct.</p></p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox">
        <h2>Vulnerability Analysis by JPCERT/CC</h2>

                  <div class="cvss-wrapper">
            <div id="cvss-v3-line" class="cvss-line">
              <span class="cvss-version">CVSS v3</span>
              <span id="cvss-v3-vector-string" class="cvss-vector-string">CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</span>
              <div class="cvss-right-elem clearfix">
                <div class="base-score">
                  <span class="base-score-label">Base Score:</span>
                  <span id="cvss-v3-base-score">5.3</span>
                </div>
                <span id="cvss-v3-toggle-marker" class="cvss-toggle-marker"></span>
              </div>
            </div>
            <table id="cvss-v3-table" class="cvss-table">
                                            <tr>
                  <th>Attack Vector(AV)</th>
                                                        <td class="unselected">
                      Physical (P)                    </td>
                                      <td class="unselected">
                      Local (L)                    </td>
                                      <td class="unselected">
                      Adjacent (A)                    </td>
                                      <td class="selected">
                      Network (N)                    </td>
                                  </tr>
                              <tr>
                  <th>Attack Complexity(AC)</th>
                                                        <td class="unselected">
                      High (H)                    </td>
                                      <td class="selected">
                      Low (L)                    </td>
                                  </tr>
                              <tr>
                  <th>Privileges Required(PR)</th>
                                                        <td class="unselected">
                      High (H)                    </td>
                                      <td class="unselected">
                      Low (L)                    </td>
                                      <td class="selected">
                      None (N)                    </td>
                                  </tr>
                              <tr>
                  <th>User Interaction(UI)</th>
                                                        <td class="unselected">
                      Required (R)                    </td>
                                      <td class="selected">
                      None (N)                    </td>
                                  </tr>
                              <tr>
                  <th>Scope(S)</th>
                                                        <td class="selected">
                      Unchanged (U)                    </td>
                                      <td class="unselected">
                      Changed (C)                    </td>
                                  </tr>
                              <tr>
                  <th>Confidentiality Impact(C)</th>
                                                        <td class="selected">
                      None (N)                    </td>
                                      <td class="unselected">
                      Low (L)                    </td>
                                      <td class="unselected">
                      High (H)                    </td>
                                  </tr>
                              <tr>
                  <th>Integrity Impact(I)</th>
                                                        <td class="selected">
                      None (N)                    </td>
                                      <td class="unselected">
                      Low (L)                    </td>
                                      <td class="unselected">
                      High (H)                    </td>
                                  </tr>
                              <tr>
                  <th>Availability Impact(A)</th>
                                                        <td class="unselected">
                      None (N)                    </td>
                                      <td class="selected">
                      Low (L)                    </td>
                                      <td class="unselected">
                      High (H)                    </td>
                                  </tr>
                          </table>
          </div>
        
                              <div class="cvss-wrapper">
              <div id="cvss-v2-line" class="cvss-line">
                <span class="cvss-version">CVSS v2</span>
                <span id="cvss-v2-vector-string" class="cvss-vector-string">AV:N/AC:L/Au:N/C:N/I:N/A:P</span>
                <div class="cvss-right-elem clearfix">
                  <div class="base-score">
                    <span class="base-score-label">Base Score:</span>
                    <span id="cvss-v2-base-score">5.0</span>
                  </div>
                  <span id="cvss-v2-toggle-marker" class="cvss-toggle-marker"></span>
                </div>
              </div>
              <table id="cvss-v2-table" class="cvss-table">
                                                  <tr>
                    <th>Access Vector(AV)</th>
                                                              <td class="unselected">
                        Local (L)                      </td>
                                          <td class="unselected">
                        Adjacent Network (A)                      </td>
                                          <td class="selected">
                        Network (N)                      </td>
                                      </tr>
                                  <tr>
                    <th>Access Complexity(AC)</th>
                                                              <td class="unselected">
                        High (H)                      </td>
                                          <td class="unselected">
                        Medium (M)                      </td>
                                          <td class="selected">
                        Low (L)                      </td>
                                      </tr>
                                  <tr>
                    <th>Authentication(Au)</th>
                                                              <td class="unselected">
                        Multiple (M)                      </td>
                                          <td class="unselected">
                        Single (S)                      </td>
                                          <td class="selected">
                        None (N)                      </td>
                                      </tr>
                                  <tr>
                    <th>Confidentiality Impact(C)</th>
                                                              <td class="selected">
                        None (N)                      </td>
                                          <td class="unselected">
                        Partial (P)                      </td>
                                          <td class="unselected">
                        Complete (C)                      </td>
                                      </tr>
                                  <tr>
                    <th>Integrity Impact(I)</th>
                                                              <td class="selected">
                        None (N)                      </td>
                                          <td class="unselected">
                        Partial (P)                      </td>
                                          <td class="unselected">
                        Complete (C)                      </td>
                                      </tr>
                                  <tr>
                    <th>Availability Impact(A)</th>
                                                              <td class="unselected">
                        None (N)                      </td>
                                          <td class="selected">
                        Partial (P)                      </td>
                                          <td class="unselected">
                        Complete (C)                      </td>
                                      </tr>
                              </table>
            </div>
                  <!-- table end -->
        
                <p></p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox">
        <h2>Credit</h2>
        <p>TERASOLUNA FW(Struts1) Team of NTT DATA Corporation reported this vulnerability to IPA.<br />
JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.</p>
      </div>
      <!-- textbox end -->

      <!-- textbox begin -->
      <div class="textbox">
        <h2>Other Information</h2>
        <p>
          <div class='ie5'>
            <table class='style_table' cellspacing='1' border='0'>
                            <tr>
                <td class='style_td'>
                  JPCERT Alert                </td>
                <td class='style_td'>
                                    <a href="" target="_top"></a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  JPCERT Reports                </td>
                <td class='style_td'>
                                    <a href="" target="_top"></a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  CERT Advisory                </td>
                <td class='style_td'>
                                    <a href="" target="_top"></a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  CPNI Advisory                </td>
                <td class='style_td'>
                                    <a href="" target="_top"></a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  TRnotes                </td>
                <td class='style_td'>
                                    <a href="" target="_top"></a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  CVE                </td>
                <td class='style_td'>
                                    <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3092" target="_top">CVE-2016-3092</a><br />                                  </td>
              </tr>
                            <tr>
                <td class='style_td'>
                  JVN iPedia                </td>
                <td class='style_td'>
                                    <a href="http://jvndb.jvn.jp/jvndb/JVNDB-2016-000121" target="_top">JVNDB-2016-000121</a><br />                                  </td>
              </tr>
                          </table>
          </div>
          <p class='empty'></p>
        </p>
      </div>
      <!-- textbox end -->

            <!-- textbox begin -->
      <div class="textbox">
        <h2>Update History</h2>

        <p class='empty'>
        </p>
        <dl>
                    <dt>2016/07/01</dt>
          <dd>FUJITSU LIMITED update status</dd>
                    <dt>2016/07/06</dt>
          <dd>NEC Corporation update status</dd>
                    <dt>2016/07/07</dt>
          <dd>Fixed error under &quot;Solution&quot;. FUJITSU LIMITED update status.</dd>
                    <dt>2016/08/04</dt>
          <dd>NTT DATA Corporation update status</dd>
                    <dt>2016/08/12</dt>
          <dd>NEC Corporation update status</dd>
                    <dt>2016/09/15</dt>
          <dd>NEC Corporation update status</dd>
                    <dt>2018/01/26</dt>
          <dd>FUJITSU LIMITED update status</dd>
                  </dl>
        <p class='empty'>
        </p>
      </div>
      <!-- textbox end -->
      
    </div>
    <!-- leftarea end -->

    <!-- rightarea begin -->
<div id="rightarea">
  <div id="ajaxmenu">
    <ul>
      <li class="jvnhead">JVN</li>
      <li class="link"><a href="/en/index.html">HOME</a></li>
      <li><a href="/en/nav/jvn.html">What is JVN ?</a></li>
      <li><a href="/en/nav/jvnhelp.html">Instructions</a></li>
      <li><a href="/en/report/index.html">List of Vulnerability Report</a></li>
      <li class="draft"><a href="/en/jp/index.html">VN_JP</a></li>
      <li class="draft"><a href="/en/adj/index.html">VN_JP(Unreachable)</a></li>
      <li class="draft"><a href="/en/vu/index.html">VN_VU</a></li>
      <li class="draft"><a href="/en/ta/index.html">TA</a></li>
      <li><a href="/en/tr/index.html">TRnotes</a></li>
      <li><a href="http://jvndb.jvn.jp/en/">JVN iPedia</a></li>
      <li><a href="http://jvndb.jvn.jp/en/apis/myjvn/index.html">MyJVN</a></li>
      <li><a href="/en/rss/index.html">JVNJS/RSS</a></li>
      <li><a href="/en/nav/index.html">Vendor List</a></li>
      <li><a href="/en/reply/index.html">List of unreachable developers</a></li>
      <li><a href="/en/contact/index.html">Contact</a></li>
    </ul>
  </div>
  <!-- rightarea end -->
</div>

  </div>
	<!-- mainarea end -->

	<!-- footer begin -->
	<div id="footer">
		<div class="footertext">Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.</div>
	</div>
	<!-- footer begin -->
</div>
</body>
</html>

