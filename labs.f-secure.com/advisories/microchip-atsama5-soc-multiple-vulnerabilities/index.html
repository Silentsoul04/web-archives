<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>Microchip ATSAMA5 SoC Multiple Vulnerabilities</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/microchip-atsama5-soc-multiple-vulnerabilities/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/microchip-atsama5-soc-multiple-vulnerabilities/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/microchip-atsama5-soc-multiple-vulnerabilities/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>Microchip ATSAMA5 SoC Multiple Vulnerabilities</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>Microchip ATSAMA5 SoC Series</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>High</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>CVE-2020-12787, CVE-2020-12788, CVE-2020-12789</td>
          </tr>
          <tr>
            <td>Type</td>
            <td>Multiple</td>
          </tr>
        </table>
        
        <h2>Description</h2><p>Multiple vulnerabilities have been discovered which affect the security of solutions built using the Microchip ATSAMA5 SoC series, when making use of the Secure Boot capabilities of these SoCs. This pre-release advisory describes the identified vulnerable situations and affected part numbers while trying to limit exposure for products integrating these SoCs. The full technical advisory will be released in the near future.</p><h2>Improper applet handling</h2><p>A programming error was discovered which allows an attacker to bypass existing security mechanisms related to applet handling when the attacked device is in Secure Mode.</p><p>This only affects products which have Secure Monitor enabled.</p><h2>CMAC verification susceptible to SPA</h2><p>The AES-128 based CMAC authentication is used to prove authenticity and integrity of software components such as monitor applets and bootstrap code. The implementation of CMAC verification functionality was found to be vulnerable to timing and power analysis attacks.</p><h2>Hardcoded keys are used for protecting applets</h2><p>It was found that the key set used to encrypt and authenticate secure applets is hardcoded within the Secure Monitor and is available for abuse once this code has been extracted.</p><p>This only affects products which have Secure Monitor enabled.</p><h2>Impact</h2><p>The cumulative impact of the described issues leads to a significant compromise of the expected security guarantees provided by the Secure Boot feature when no mitigations are applied.</p><h2>Affected part numbers</h2><p>Affected CPNs for the SAMA5D2 product line:</p><ul><li>ATSAMA5D21C-CU, ATSAMA5D21C-CUR</li>
</ul><ul><li>ATSAMA5D22C-CN, ATSAMA5D22C-CNR, ATSAMA5D22C-CU, ATSAMA5D22C-CUR</li>
</ul><ul><li>ATSAMA5D23C-CN, ATSAMA5D23C-CNR, ATSAMA5D23C-CU, ATSAMA5D23C-CUR</li>
</ul><ul><li>ATSAMA5D24C-CU, ATSAMA5D24C-CUF, ATSAMA5D24C-CUR</li>
</ul><ul><li>ATSAMA5D26C-CN, ATSAMA5D26C-CNR, ATSAMA5D26C-CU, ATSAMA5D26C-CUR</li>
</ul><ul><li>ATSAMA5D27C-CN, ATSAMA5D27C-CNR, ATSAMA5D27C-CU, ATSAMA5D27C-CUR</li>
</ul><ul><li>ATSAMA5D28C-CN, ATSAMA5D28C-CNR, ATSAMA5D28C-CU, ATSAMA5D28C-CUR</li>
</ul><ul><li>ATSAMA5D27C-CNVAO, ATSAMA5D27C-CNRVAO</li>
</ul><p>SiP variants:</p><ul><li>ATSAMA5D225C-D1M-CUR</li>
</ul><ul><li>ATSAMA5D27C-D5M-CU, ATSAMA5D27C-D5M-CUR,</li>
</ul><ul><li>ATSAMA5D27C-D1G-CU, ATSAMA5D27C-D1G-CUR</li>
</ul><ul><li>ATSAMA5D28C-D1G-CU, ATSAMA5D28C-D1G-CUR</li>
</ul><ul><li>ATSAMA5D27C-LD1G-CU, ATSAMA5D27C-LD1G-CUR</li>
</ul><ul><li>ATSAMA5D27C-LD2G-CU, ATSAMA5D27C-LD2G-CUR</li>
</ul><ul><li>ATSAMA5D28C-LD1G-CU, ATSAMA5D28C-LD1G-CUR</li>
</ul><ul><li>ATSAMA5D28C-LD2G-CU, ATSAMA5D28C-LD2G-CUR</li>
</ul><p>SoM variants:</p><ul><li>ATSAMA5D27-WLSOM1</li>
</ul><ul><li>ATSAMA5D27-SOM1</li>
</ul><p>Affected CPNs for the SAMA5D3 product line:</p><ul><li>ATSAMA5D31A-CU, ATSAMA5D31A-CUR, ATSAMA5D31A-CFU, ATSAMA5D31A-CFUR</li>
</ul><ul><li>ATSAMA5D33A-CU, ATSAMA5D33A-CUR</li>
</ul><ul><li>ATSAMA5D34A-CU, ATSAMA5D34A-CUR</li>
</ul><ul><li>ATSAMA5D35A-CU, ATSAMA5D35A-CUR, ATSAMA5D35A-CN, ATSAMA5D35A-CNR</li>
</ul><ul><li>ATSAMA5D36A-CU, ATSAMA5D36A-CUR, ATSAMA5D36A-CN, ATSAMA5D36A-CNR</li>
</ul><p>Affected CPNs for the SAMA5D4 product line:</p><ul><li>ATSAMA5D41A-CU, ATSAMA5D41A-CUR, ATSAMA5D41B-CU, ATSAMA5D41B-CUR</li>
</ul><ul><li>ATSAMA5D42A-CU, ATSAMA5D42A-CUR, ATSAMA5D42B-CU, ATSAMA5D42B-CUR</li>
</ul><ul><li>ATSAMA5D43A-CU, ATSAMA5D43A-CUR, ATSAMA5D43B-CU, ATSAMA5D43B-CUR</li>
</ul><ul><li>ATSAMA5D44A-CU, ATSAMA5D44A-CUR, ATSAMA5D44B-CU, ATSAMA5D44B-CUR</li>
</ul><h2>Solution</h2><p>For products based on the SAMA5D2 and SAMA5D4 devices, disabling the SAM-BA monitor after provisioning the chips mitigates all the reported issues. This can be done by setting the "Disable Monitor" bit in the fuse area.</p><p>CMAC verification issue may be mitigated by choosing the RSA authentication option to replace CMAC calculation.</p><p>For products based on the SAMA5D3 devices, no mitigations were identified. The only identified solution is to update the products to the next silicon revision when made available by Microchip.</p><h2>CVE assignment</h2><table><tbody><tr><td>CVE</td>
<td>Description</td>
</tr><tr><td>CVE-2020-12787</td>
<td>Improper applet verification</td>
</tr><tr><td>CVE-2020-12788</td>
<td>CMAC verification susceptible to SPA</td>
</tr><tr><td>CVE-2020-12789</td>
<td>Hardcoded keys are used for protecting applets</td>
</tr></tbody></table><h2>Credit</h2><p>The issues were discovered by Dmitry Janushkevich of F-Secure Hardware Security team.</p><h2>Detailed timeline</h2><table><tbody><tr><td>Date</td>
<td>Event</td>
</tr><tr><td>2020-01-23</td>
<td>Initial contact. Details and suggested mitigations provided to Microchip, as well as proposing a 90 days disclosure timeline.</td>
</tr><tr><td>2020-01-24</td>
<td>Microchip confirms the reception.</td>
</tr><tr><td>2020-01-28</td>
<td>Microchip informs they are in the process of confirming the issues.</td>
</tr><tr><td>2020-02-04</td>
<td>F-Secure requests a status update.</td>
</tr><tr><td>2020-02-05</td>
<td>Microchip provides the status update and confirms the issues against SAMA5D27. Microchip intends to respond "in few days" regarding the disclosure timeline.</td>
</tr><tr><td>2020-02-25</td>
<td>F-Secure requests a status update.</td>
</tr><tr><td>2020-02-27</td>
<td>Microchip informs they are still working on identifying mitigations.</td>
</tr><tr><td>2020-03-17</td>
<td>F-Secure requests a status update.</td>
</tr><tr><td>2020-03-19</td>
<td>Microchip confirms SAMA5D3 and SAMA5D4 are also vulnerable, as well as informing F-Secure that suggested mitigations may not be applicable for all devices. Microchip starts planning a disclosure toward the customers.</td>
</tr><tr><td>2020-04-20</td>
<td>F-Secure informs Microchip about the embargo period expiring.</td>
</tr><tr><td>2020-04-23</td>
<td>90 day disclosure deadline missed.</td>
</tr><tr><td>2020-04-28</td>
<td>Microchip informs regarding the mitigation plan for SAMA5D3. Microchip requests postponing the disclosure until December 2020 or early 2021.</td>
</tr><tr><td>2020-04-28</td>
<td>F-Secure suggests timing the disclosure to the planned customer communication activities as information will become effectively public despite the limited amount of people being informed.</td>
</tr><tr><td>2020-05-04</td>
<td>Conference call between Microchip and F-Secure. An agreement is reached for limited (what is vulnerable, impact) disclosure within weeks and full disclosure upon fixed part availability.</td>
</tr><tr><td>2020-05-09</td>
<td>Microchip provides a draft of planned customer communication document. Also included is the list of affected part numbers for the D2 series.</td>
</tr><tr><td>2020-05-11</td>
<td>F-Secure requests CVE identifiers from MITRE.</td>
</tr><tr><td>2020-05-12</td>
<td>F-Secure provides a draft of planned limited disclosure document together with feedback on the Microchip document.</td>
</tr><tr><td>2020-05-19</td>
<td>Microchip responds regarding the level of detail provided.</td>
</tr><tr><td>2020-05-21</td>
<td>F-Secure provides a second draft of planned limited disclosure document with bare minimum of information included.</td>
</tr><tr><td>2020-05-25</td>
<td>Tentative deadline for limited disclosure missed.</td>
</tr><tr><td>2020-05-30</td>
<td>Microchip responds regarding the level of detail provided. Microchip also informs about starting the dissemination of limited information among select customers.</td>
</tr><tr><td>2020-05-30</td>
<td>Microchip provides the list of affected part numbers for the D3 and D4 series.</td>
</tr><tr><td>2020-06-04</td>
<td>F-Secure informs the vendor on the decision to adhere to the previously discussed limited disclosure, setting the new deadline to 2020-06-10.</td>
</tr><tr><td>2020-06-10</td>
<td>Limited disclosure document published.</td>
</tr></tbody></table><h2>References</h2><p>References will be provided upon availability from Microchip.</p>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/microchip-atsama5-soc-multiple-vulnerabilities/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/microchip-atsama5-soc-multiple-vulnerabilities/&text=Microchip ATSAMA5 SoC Multiple Vulnerabilities" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/microchip-atsama5-soc-multiple-vulnerabilities/&title=Microchip ATSAMA5 SoC Multiple Vulnerabilities" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/microchip-atsama5-soc-multiple-vulnerabilities/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
