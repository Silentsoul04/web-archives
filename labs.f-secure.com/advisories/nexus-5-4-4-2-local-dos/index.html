<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>Nexus 5 &lt;= 4.4.2 Local DoS</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/nexus-5-4-4-2-local-dos/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/nexus-5-4-4-2-local-dos/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/nexus-5-4-4-2-local-dos/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>Nexus 5 &lt;= 4.4.2 Local DoS</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>Nexus 5</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>High</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Type</td>
            <td> Nexus 5 &lt;= 4.4.2 Local DoS</td>
          </tr>
        </table>
        
        <h2>Nexus 5</h2>
<dl><dt>Software</dt><dd>Android</dd><dt>Affected Versions</dt><dd>Nexus 5 w/ Android &lt;= 4.4.2</dd><dt>Authors</dt><dd>Joseph Redfern</dd><dt>Severity</dt><dd>Medium</dd><dt>Vendor</dt><dd>Google</dd><dt>Vendor Response</dt><dd>Fixed in Android 4.4.3</dd></dl><h3>Description:</h3>
<p>The Nexus 5 comes pre-installed with a hidden network connectivity testing application. Up until Android 4.4.3, various activities contained within the application were exported, and required no permissions to launch. One of these activities caused the phone to reboot, making the device vulnerable to a Denial-of-Service attack.</p>
<h3>Impact</h3>
<p>On launching the com.lge.SprintHiddenMenu.sprintspec.SCRTN activity on a Nexus 5 running 4.2.2 or earlier, the device would restart.</p>
<p>If a malicious application that responded to the BOOT_COMPLETED broadcast receiver and sent an appropriate intent to com.lge.SprintHiddenMenu.sprintspec.SCRTN were installed, then the device could be put in a reboot loop.</p>
<h3>Cause:</h3>
<p>The com.lge.SprintHiddenMenu.sprintspec.SCRTN activity did not require any specific permissions, allowing any it to be launched by any un-privileged application.</p>
<h3>Interim Workaround:</h3>
<p>There are no known workarounds for this vulnerability – com.lge.SprintHiddenMenu is installed as a system package and cannot be removed on a non-rooted device. The preferred fix is to upgrade to Android 4.4.3 or greater.</p>
<h3>Solution:</h3>
<p>The Nexus 5 with Android 4.4.3 and above requires that calling applications have the com.lge.permission.SPRINTHIDDEN permission in order to start the com.lge.SprintHiddenMenu.sprintspec.SCRTN activity.</p>
<p>Application Developers should check that no potentially dangerous activities are un-intentionally exported, using a tool such as <a href="https://www.mwrinfosecurity.com/products/drozer/">drozer</a></p>
<h3>Technical details:</h3>
<p>The com.lge.SprintHiddenMenu package contains tools for debugging the data connections of the Nexus 5:</p>
<p><img src="system/assets/732/normal/Screenshot_2014-06-29-11-33-23_normal.png" alt="com.lge.SprintHiddenMenu.sprintspec.Debug" title=""></p>
<p>Using drozer, it was possible to list the activities defined by the com.lge.SprintHiddenMenu package:</p>
<pre>dz&gt; run app.activity.info -a com.lge.SprintHiddenMenu
Package: com.lge.SprintHiddenMenu
  com.lge.SprintHiddenMenu.sprintspec.RTN
  com.lge.SprintHiddenMenu.sprintspec.Data
  com.lge.SprintHiddenMenu.sprintspec.data.edit.ApnSettingsHiddenMenu
    Permission: com.lge.permission.SPRINTHIDDEN
  com.lge.SprintHiddenMenu.sprintspec.data.edit.ApnEditorHiddenMenu
    Permission: com.lge.permission.SPRINTHIDDEN
  com.lge.SprintHiddenMenu.sprintspec.Debug
  com.lge.SprintHiddenMenu.sprintspec.Test
  com.lge.SprintHiddenMenu.sprintspec.MSL
  com.lge.SprintHiddenMenu.sprintspec.TestCheckSPC
  com.lge.SprintHiddenMenu.sprintspec.SCRTN
  com.lge.SprintHiddenMenu.sprintspec.data.Mmsc</pre>
<p>It was noted that when starting the com.lge.SprintHiddenMenu.sprintspec.<span class="caps">SCRTN</span> activity (run app.activity.start --component com.lge.SprintHiddenMenu com.lge.SprintHiddenMenu.sprintspec.SCRTN), the following dialog would appear:</p>
<p><img src="system/assets/733/normal/Screenshot_2014-06-29-12-56-22_normal.png" alt="com.lge.SprintHiddenMenu.sprintspec.Debug" title=""></p>
<p>Shortly after, the standard Android “Shutting Down” would be displayed, and the device would reboot. It is suggested that the <span class="caps">SCRTN</span> activity performs a “Carrier Reset” on the device, which causes the phone to be re-registered with a <span class="caps">CDMA</span> network.</p>
<h3>Detailed Timeline:</h3>
<table><tbody><tr><td>Date</td>
<td>Summary</td>
</tr><tr><td>17/02/2014</td>
<td>Reported to Google</td>
</tr><tr><td>18/02/2014</td>
<td>Google start investigating issue</td>
</tr><tr><td>24/04/2014</td>
<td>Google replied stating that a patch has been created</td>
</tr><tr><td>04/06/2014</td>
<td>Android 4.4.3 officially released containing patch</td>
</tr><tr><td>10/07/2014</td>
<td>Credited on the <a href="https://source.android.com/devices/tech/security/acknowledgements.html">Android Security Acknowledgements</a> page</td>
</tr></tbody></table>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/nexus-5-4-4-2-local-dos/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/nexus-5-4-4-2-local-dos/&text=Nexus 5 &lt;= 4.4.2 Local DoS" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/nexus-5-4-4-2-local-dos/&title=Nexus 5 &lt;= 4.4.2 Local DoS" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      
      <a href="/assets/733/original/Screenshot_2014-06-29-12-56-22.png" class="flex-container__box">
            <span class="content-type">Download</span>
            
            <h3 class="flex-container__box-title">Download the advisory here.</h3>
            
      </a>
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/nexus-5-4-4-2-local-dos/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
