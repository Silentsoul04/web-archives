<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>IBM GPFS / Spectrum Scale Command Injection</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/ibm-gpfs-spectrum-scale-command-injection/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/ibm-gpfs-spectrum-scale-command-injection/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/ibm-gpfs-spectrum-scale-command-injection/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>IBM GPFS / Spectrum Scale Command Injection</h1>
      <p>A command injection vulnerability in GPFS / Spectrum Scale allows attackers to escalate privileges to root</p>
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>IBM GPFS / Spectrum Scale</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>High</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>CVE-2016-0392</td>
          </tr>
          <tr>
            <td>Type</td>
            <td>Command injection</td>
          </tr>
        </table>
        
        <h1>Description</h1>
<p>IBM’s General Parallel File System (GPFS), now known as Spectrum Scale, is affected by a vulnerability that allows an adversary on any system which mounts GPFS to inject commands which are later executed as root.</p>
<h1>Impact</h1>
<p>Exploitation of this vulnerability allows any user of a system with a GPFS filesystem mounted to execute commands as root across the GPFS cluster.</p>
<h1 class="Heading2nonum">Cause</h1>
<p>This is caused by a failure to safely handle arguments supplied to a number of setuid binaries.</p>
<h1><span>Affected Versions</span></h1>
<ul><li><span style="line-height: 1.4em;">IBM Spectrum Scale V4.2.0.0 thru V4.2.0.2</span></li>
<li><span style="line-height: 1.4em;">IBM Spectrum Scale V4.1.1.0 thru V4.1.1.6</span></li>
<li><span style="line-height: 1.4em;">IBM GPFS V4.1.0.0 thru V4.1.0.8</span></li>
<li><span style="line-height: 1.4em;">IBM GPFS V3.5.0.0 thru V3.5.0.30</span></li>
<li><span style="line-height: 1.4em;">All older IBM GPFS versions no longer supported</span></li>
</ul><h1 class="Heading2nonum">Interim Workaround</h1>
<p>IBM have provided patches in order to resolve this issue. It is recommended that these patches (described in the ‘Solution’ section below) are applied. However, if this is not possible some workarounds may also be applied: </p>
<p>Remove the setuid from the files in the /usr/lpp/mmfs/bin directory. These can be identified by running</p>
<pre class="Code">ls -l /usr/lpp/mmfs/bin | grep r-s</pre>
<p>Reset the setuid bit for each such file by issuing this command on each file</p>
<pre class="Code">chmod u-s file</pre>
<p>Once the workaround is applied, a number of commands may no longer work when not invoked by unprivileged users, including:</p>
<pre class="Code">mmchfileset<br>mmcrsnapshot<br>mmdelsnapshot<br>mmdf<br>mmedquota<br>mmgetacl<br>mmlsdisk<br>mmlsfileset<br>mmlsfs<br>mmlsmgr<br>mmlspolicy<br>mmlspool<br>mmlsquota<br>mmlssnapshot<br>mmputacl<br>mmsnapdir</pre>
<p><em>(These workarounds are taken from the IBM supplied advisory which can be found at: <a title="IBM Advisory" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763" target="_blank">http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763</a>)</em></p>
<p>If the workarounds would not affect the usability of GPFS within your environment, then MWR recommend applying these workarounds in addition to the IBM supplied patches detailed below.</p>
<h1>Solution</h1>
<p><span>IBM have provided fixes for this issue; however, MWR have not tested the effectiveness of these patches:</span></p>
<ul><li>For IBM Spectrum Scale V4.2.0.0 thru V4.2.0.2, apply IBM Spectrum Scale V4.2.0.3 available from Fix Central at:</li>
</ul><p style="padding-left: 60px;"><a href="http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&amp;product=ibm/StorageSoftware/IBM+Spectrum+Scale&amp;release=4.2.0&amp;platform=All&amp;function=all" target="_blank">http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&amp;product=ibm/StorageSoftware/IBM+Spectrum+Scale&amp;release=4.2.0&amp;platform=All&amp;function=all</a></p>
<ul><li>For IBM Spectrum Scale V4.1.1.0 thru 4.1.1.6 and IBM GPFS V4.1.0.0 thru V4.1.0.8, apply V4.1.1.7 at:</li>
</ul><p style="padding-left: 60px;"><a href="http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&amp;product=ibm/StorageSoftware/IBM+Spectrum+Scale&amp;release=4.1.1&amp;platform=All&amp;function=all">http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&amp;product=ibm/StorageSoftware/IBM+Spectrum+Scale&amp;release=4.1.1&amp;platform=All&amp;function=all</a></p>
<p> </p>
<ul><li>For IBM GPFS V3.5.0.0 thru V3.5.0.30, apply V3.5.0.31 at:</li>
</ul><p style="padding-left: 60px;"><a href="http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Cluster%2Bsoftware&amp;product=ibm/power/IBM+General+Parallel+File+System&amp;release=3.5.0&amp;platform=All&amp;function=all">http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Cluster%2Bsoftware&amp;product=ibm/power/IBM+General+Parallel+File+System&amp;release=3.5.0&amp;platform=All&amp;function=all</a></p>
<p><br> For older versions of IBM GPFS, if you have an extended service contract, please contact IBM Service.</p>
<p>(These solutions are taken from the IBM supplied advisory which can be found at: <a href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763">http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763</a>)</p>
<p><span style="line-height: 1.4em;"> </span></p>
<h1>Further Information</h1>
<p><span style="line-height: 1.4em;">The IBM advisory relating to this issue can be found at the following location: </span><a style="line-height: 1.4em;" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763">http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763</a></p>
<p>This issue is closely related to a format string issue in GPFS (CVE-2015-0197) found by Florian Grunwo and Felix Wilhelm of ERNW: <a href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1022062">http://www-01.ibm.com/support/docview.wss?uid=isg3T1022062</a></p>
<p>Further technical information may be released at a later date when users have had a chance to resolve this issue.</p>
<h1 class="Heading2nonum">Detailed Timeline</h1>
<table style="width: 98%;" cellspacing="0" cellpadding="0"><tbody><tr><td width="298" valign="top">
<p>Date</p>
</td>
<td width="724" valign="top">
<p>Summary</p>
</td>
</tr><tr><td width="298" valign="top">
<p>2016-04-02</p>
</td>
<td width="724" valign="top">
<p>Issue reported to vendor</p>
</td>
</tr><tr><td width="298" valign="top">
<p>2016-05-31</p>
</td>
<td width="724" valign="top">
<p>Patch and vendor advisory released</p>
</td>
</tr><tr><td width="298" valign="top">
<p>2016-06-07</p>
</td>
<td width="724" valign="top">
<p>MWR advisory released</p>
</td>
</tr></tbody></table>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/ibm-gpfs-spectrum-scale-command-injection/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/ibm-gpfs-spectrum-scale-command-injection/&text=IBM GPFS / Spectrum Scale Command Injection" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/ibm-gpfs-spectrum-scale-command-injection/&title=IBM GPFS / Spectrum Scale Command Injection" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      
      <a href="/assets/BlogFiles/mwri-ibm-gpfs-spectrum-scale-command-injection-2016-06-07.pdf" class="flex-container__box">
            <span class="content-type">Download</span>
            
            <h3 class="flex-container__box-title">Download the advisory here.</h3>
            
      </a>
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/ibm-gpfs-spectrum-scale-command-injection/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
