<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://labs.f-secure.com/"><!--[if lte IE 6]></base><![endif]-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="x-subsite-id" content="1" />

    <title>Apple iOS Host Pairing Bypass</title>

    <link rel="stylesheet" href="https://labs.f-secure.com/themes/mwr/css/style.css?t=20200715">
    <link rel="stylesheet" href="https://labs.f-secure.com/themes/labs/css/style.css?t=20200715">

    <meta name="description" content="">
    <link rel="canonical" href="https://labs.f-secure.com/advisories/apple-ios-host-pairing-bypass/">
    <meta name="robots" content="NOODP,index,follow">

    

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="format-detection" content="telephone=no">
    
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="F-Secure Labs">
    <meta property="og:url" content="https://labs.f-secure.com/advisories/apple-ios-host-pairing-bypass/">
    
    <meta property="og:locale" content='en_GB'>
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">

  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})
    (window,document,'script','dataLayer','GTM-KD9T85H');
  </script>
  <meta name="google-site-verification" content="jqRTM8I_uI-jDIu1ITng14jD-3iJy0l3TTCIl2I-BIo" />
<link rel="stylesheet" type="text/css" href="/themes/labs/css/style.css?m=1600760392" />
</head>
<body class="BlogPost" dir="ltr">

    <header class="head menu-opened" id="top">
	<div class="container">
		<div class="col12">
			<div class="logo">
				<a href="/">F-Secure</a>
			</div>
		    <a href="/advisories/apple-ios-host-pairing-bypass/#nav" class="btn-menu">Menu</a>

<nav class="main-nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul>
        
            <li class="section nav-advisories"><a href="/advisories/" title="Advisories">Advisories</a></li>
        
            <li class="link nav-blog"><a href="/blog/" title="/var/log/messages">/var/log/messages</a></li>
        
            <li class="link nav-publications"><a href="/publications/" title="Publications">Publications</a></li>
        
            <li class="link nav-tools"><a href="/tools/" title="Tools">Tools</a></li>
        
            <li class="link nav-archive"><a href="/archive/" title="Archive">Archive</a></li>
        
        <li class="nav-careers"><a href="https://www.f-secure.com/en/web/about_global/careers/job-openings">Careers</a></li>
    </ul>
</nav>

		</div>
	</div>
</header>


    <div class="wrapper">

        <section class="section">
  <div class="page-title">
    <div class="container">
      <span class="content-type"></span>
      <h1>Apple iOS Host Pairing Bypass</h1>
      
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="col8">
      <div class="blog-post">
        
        <table>
          <tr>
            <td>Product</td>
            <td>Apple iOS</td>
          </tr>
          <tr>
            <td>Severity</td>
            <td>Low</td>
          </tr>
          <tr>
            <td>CVE Reference</td>
            <td>CVE-2017-13806</td>
          </tr>
          <tr>
            <td>Type</td>
            <td>Logic Bug</td>
          </tr>
        </table>
        
        <h1>Description</h1><p>It was found to be possible to bypass the host-pairing (allow pairing with non-configurator hosts) restriction applied to a supervised iOS device that is enrolled in the Apple Device Enrolment Program (DEP).</p><p>On iOS, device supervision allows an organisation to apply additional device security settings that are not configurable via a traditional MDM configuration profile or via device settings. One such setting is the ability to prevent the iOS device from connecting to hosts, other than the supervising device.</p><p>Under normal circumstances, when host-pairing is restricted it is not possible to pair the iOS device with a host other than the supervising device. When attempting to do so, the user is presented with the message “This device is being supervised by another device”.</p><p>It was possible to bypass this restriction using the Download Firmware Update (DFU) mode to update to the latest iOS version, where it appears that a host “keypair” is automatically added to pair_records of the iOS device.</p><h1>Impact</h1><p>This issue allows an attacker to pair a host machine, other than the supervising host, with an iOS device that has host-pairing restricted. During testing a macOS Sierra 10.12.1 (Macbook) device was used, as well as an iOS 10.1 (iPhone 7) device. The following actions were found to be possible even though the device supervision of the iOS device should prevent them:</p><ul><li>Perform an encrypted backup of the device.</li>
<li>Screen (video) record the device via QuickTime.</li>
<li>Import photos from the device.</li>
</ul><p>Due to configuration restrictions applied by a configuration profile installed on the device, the following actions were not possible from a host-paired device, but would be possible if additional security settings had not been applied to the device:</p><ul><li>Installation of 3rd party configuration profiles.</li>
<li>Unencrypted backup of the device.</li>
<li>Installation of applications. </li>
</ul><h1>Cause</h1><p>The root cause of this issue is currently unclear. It is suspected that during the DFU update process, the iOS device creates a pairing record for the connected Mac OS device (pairing records on iOS are stored within /var/root/Library/pair_records), and that this record is not subsequently removed after the DFU update. </p><h1>Interim Workaround</h1><p>Currently, host-pair restrictions should not be relied upon to restrict iOS features. A defence-in-depth approach should be taken with additional security controls applied the iOS device via the device supervision profile. In particular, it is recommended that the following restrictions are applied in order to mitigate this issue:</p><ul><li>Prevent screen recording.</li>
<li>Prevent the installation of configuration profiles.</li>
<li>Prevent the installation of untrusted applications.</li>
<li>A username &amp; password combination should be required for DEP enrolment.</li>
</ul><h1>Solution</h1><p>Update to the latest stable and secure iOS version (iOS 11 and above). </p><p><a href="https://support.apple.com/en-gb/HT208112">https://support.apple.com/en-gb/HT208112</a></p><h1>Technical details</h1><p>Please refer to the attached advisory. </p><h1>Disclosure Timeline</h1><table><tbody><tr><td>Date</td>
<td>Summary</td>
</tr><tr><td><span>02/02/2017</span></td>
<td>Issue reported to vendor</td>
</tr><tr><td>19/09/2017</td>
<td>Vendor releases patch</td>
</tr><tr><td>14/11/2017</td>
<td>Advisory published</td>
</tr></tbody></table>
      </div>
      <div class="social-share">
        <p><span class="content-type">Share</span></p>
        <ul class="social">
  <li class="facebook"><a href="http://www.facebook.com/sharer.php?u=https://labs.f-secure.com/advisories/apple-ios-host-pairing-bypass/" target="_blank">Share on Facebook</a></li>
  <li class="twitter"><a href="https://twitter.com/share?url=https://labs.f-secure.com/advisories/apple-ios-host-pairing-bypass/&text=Apple iOS Host Pairing Bypass" target="_blank">Share on LinkedIn</a></li>
  <li class="linkedin"><a href="http://www.linkedin.com/shareArticle?url=https://labs.f-secure.com/advisories/apple-ios-host-pairing-bypass/&title=Apple iOS Host Pairing Bypass" target="_blank">Share on Twitter</a></li>
</ul>

      </div>
    </div>
    <div class="col4">
      
      <a href="/assets/BlogFiles/mwri-apple-iOS-host-pairing-bypass-2017-11-14.pdf" class="flex-container__box">
            <span class="content-type">Download</span>
            
            <h3 class="flex-container__box-title">Download the advisory here.</h3>
            
      </a>
      

      
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="col12">
        <p>&nbsp;</p>
      </div>
    </div>
  </section>


    </div>

    <footer class="foot">
	<div class="container">
    <div class="footer-flex-wrap">
     <p class="logo"><img src="https://labs.f-secure.com//themes/labs/img/fs-labs-logo-white.svg" alt="F-Secure" width="180" height="60"></p>
      <ul class="top-menu">
        <li><a href="/advisories/apple-ios-host-pairing-bypass/#top" class="btn-gototop">Top</a></li>
        
        <li class="link"><a href="https://www.f-secure.com/en/consulting/contact">Contact</a></li>
        
        
      </ul>
   </div>
   <hr/>
    <div class="col5 suf1 foot-about">
      <p>F-Secure provides specialist advice and solutions in all areas of cyber security, from professional and managed services, through to developing commercial and open source security tools.  </p>
    </div>
    <div class="col3">
      <ul class="footer-list no-margin">
        
        <li><a href="/publications/ti-report-lazarus-group-cryptocurrency-vertical/">Threat Intelligence Report: Lazarus Group Campaign Targeting the Cryptocurrency Vertical</a></li>
        
        <li><a href="/publications/the-fake-cisco/">The Fake Cisco</a></li>
        
        <li><a href="/publications/u-booting-securely/">U-Booting securely</a></li>
        
      </ul>
    </div>
    <div class="col3">
     <ul class="footer-list">
      
      <li><a href="/blog/prelude-to-ransomware-systembc/">Prelude to Ransomware: SystemBC</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-3/">Attack Detection Fundamentals 2021: Azure - Lab #3</a></li>
      
      <li><a href="/blog/attack-detection-fundamentals-2021-azure-lab-2/">Attack Detection Fundamentals 2021: Azure - Lab #2</a></li>
      
    </ul>
  </div>
</div>
<div class="end">
 <div class="container">
  <hr/>
  <div class="footer-flex-wrap">
   <p class="copyright">Copyright &copy; 2021 F-Secure</p>
    <ul class="social">
      
      <li class="linkedin for-footer"><a href="https://www.linkedin.com/showcase/28493188" target="_blank">Connect with us on LinkedIn</a></li>
      
      
      <li class="twitter for-footer"><a href="https://twitter.com/fsecurelabs" target="_blank">Follow us on Twitter</a></li>
      
      
      <li class="github for-footer"><a href="https://github.com/fsecurelabs" target="_blank">Follow us on GitHub</a></li>
      
    </ul>
 </div>
</div>
</div>
</footer>

    <script src="/themes/mwr/js/min/jquery-3.5.1.min.js" id="jqueryscript"></script>

    
    <script src="/themes/mwr/js/min/slides.min.js"></script>
    

    <script src="/themes/mwr/js/min/scripts.js?20190917" id="pagescripts"></script>

    <script type="application/ld+json">
    { "@context" : "http://schema.org",
      "@type" : "Organization",
      "name" : "F-Secure Labs",
      "url" : "https://labs.f-secure.com",
      "logo" : "https://labs.f-secure.com/themes/labs/img/fs-labs-logo-white.svg",
      "sameAs" : [
          "https://twitter.com/fsecurelabs",
          "https://www.linkedin.com/showcase/28493188"],
      "contactPoint" : [
        { "@type" : "ContactPoint",
          "telephone" : "+441256300920",
          "contactType" : "customer service"
        } ]
    }
    </script>
</body>
</html>
