<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>XSA-39 - Xen Security Advisories</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1>Information</h1><table><tr><th>Advisory</th> <td><a href="advisory-39.html">XSA-39</a></td></tr><tr><th>Public release</th> <td>2013-02-05 12:00</td></tr><tr><th>Updated</th> <td>2013-02-05 12:59</td></tr><tr><th>Version</th> <td>2</td></tr><tr><th>CVE(s)</th> <td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0216">CVE-2013-0216</a> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0217">CVE-2013-0217</a></td></tr><tr><th>Title</th> <td>Linux netback DoS via malicious guest ring.</td></tr></table><h1>Files</h1><a href="advisory-39.txt">advisory-39.txt</a> (signed advisory file)<br /><a href="xsa39-classic-0001-xen-netback-garbage-ring.patch">xsa39-classic-0001-xen-netback-garbage-ring.patch</a><br /><a href="xsa39-classic-0002-xen-netback-wrap-around.patch">xsa39-classic-0002-xen-netback-wrap-around.patch</a><br /><a href="xsa39-pvops-0001-xen-netback-shutdown-the-ring-if-it-contains-garbage.patch">xsa39-pvops-0001-xen-netback-shutdown-the-ring-if-it-contains-garbage.patch</a><br /><a href="xsa39-pvops-0002-xen-netback-don-t-leak-pages-on-failure-in-xen_netbk.patch">xsa39-pvops-0002-xen-netback-don-t-leak-pages-on-failure-in-xen_netbk.patch</a><br /><a href="xsa39-pvops-0003-xen-netback-free-already-allocated-memory-on-failure.patch">xsa39-pvops-0003-xen-netback-free-already-allocated-memory-on-failure.patch</a><br /><a href="xsa39-pvops-0004-netback-correct-netbk_tx_err-to-handle-wrap-around.patch">xsa39-pvops-0004-netback-correct-netbk_tx_err-to-handle-wrap-around.patch</a><h1>Advisory</h1><hr /><pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

    Xen Security Advisory CVE-2013-0216,CVE-2013-0217 / XSA-39
			      version 2

          Linux netback DoS via malicious guest ring.

UPDATES IN VERSION 2
====================

Public release.

ISSUE DESCRIPTION
=================

The Xen netback implementation contains a couple of flaws which can
allow a guest to cause a DoS in the backend domain, potentially
affecting other domains in the system.

CVE-2013-0216 is a failure to sanity check the ring producer/consumer
pointers which can allow a guest to cause netback to loop for an
extended period preventing other work from occurring.

CVE-2013-0217 is a memory leak on an error path which is guest
triggerable.

IMPACT
======

A malicious guest can mount a DoS affecting the entire system.

VULNERABLE SYSTEMS
==================

All systems running guests with access to PV network devices are
vulnerable.

CVE-2013-0216 affects both mainline (&quot;pvops&quot;) and classic-Xen patch
kernels.

CVE-2013-0217 affects only mainline (&quot;pvops&quot;) kernels.

MITIGATION
==========

Running HVM guests with only emulated or passthrough NICs or PV guests
with only passthrough NICs will avoid this vulnerability.

RESOLUTION
==========

Applying the appropriate attached patches in sequence resolves this issue.

xsa39-pvops-*.patch            Apply to mainline Linux 3.8-rc2
xsa39-classic-*.patch          Apply to linux-2.6.18-xen tree.

All patches for the given branch should be applied in numerical order.

$ sha256sum xsa39*.patch
<a href="xsa39-classic-0001-xen-netback-garbage-ring.patch">4b75961673b940f5eb31451080dd668b9119eb88db1df44db1a3ba4b0d037ce1  xsa39-classic-0001-xen-netback-garbage-ring.patch</a>
<a href="xsa39-classic-0002-xen-netback-wrap-around.patch">096143750b99eb2d88970338c3f9debfbbfdaef766525a620281b28528ebe0ce  xsa39-classic-0002-xen-netback-wrap-around.patch</a>
<a href="xsa39-pvops-0001-xen-netback-shutdown-the-ring-if-it-contains-garbage.patch">99cf93e37985908243b974cc726f57e592e62ae005eca52969f11fb6fdea6fb5  xsa39-pvops-0001-xen-netback-shutdown-the-ring-if-it-contains-garbage.patch</a>
<a href="xsa39-pvops-0002-xen-netback-don-t-leak-pages-on-failure-in-xen_netbk.patch">e0c4226b0910ca455f22ae117e8346d87053e9faf03ec155dd6c31e2f58a1969  xsa39-pvops-0002-xen-netback-don-t-leak-pages-on-failure-in-xen_netbk.patch</a>
<a href="xsa39-pvops-0003-xen-netback-free-already-allocated-memory-on-failure.patch">70e6cb644a57cdda7f29eb86086a8e697706c3fc974a44c52322e451fd6b9d5c  xsa39-pvops-0003-xen-netback-free-already-allocated-memory-on-failure.patch</a>
<a href="xsa39-pvops-0004-netback-correct-netbk_tx_err-to-handle-wrap-around.patch">5d0db59bbd5ad3a7efae78a6c26fc2491b7c553e5519dd946d1422a116af73dd  xsa39-pvops-0004-netback-correct-netbk_tx_err-to-handle-wrap-around.patch</a>
$
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJREQI5AAoJEIP+FMlX6CvZLbcIAL7gpD+EzDjb+g3ZlORl1jPV
+icqyDoPWeWructbggY+YcJJc2IavNrRXBSN/9edSTUXSi7YTW+Tjeh8bcLza1JM
McWKxPtJB8CKEIAjAeT8qMVaNUNQuJQTtTLtXHGuQE6xwxK8YmgLzQSx91OOp9Bx
49GK1Ptnp7bQoEoc7B3oN6GXr/hs/FvaD0Cr481yUxXX1GxV+AL7sxXiJ4kXu1rE
UTSLFAzUfw1KWI5wP3GQCREhysCvgIq4mZyD5+TF8MUagpg+m1aURs2AUUxrJ/Zw
o+LVEKWYRsTtWIRtwYOdPHn73bllyPOrBgimTDBM9rY9CztOnN8yoPRlUz0Sux0=
=UhBt
-----END PGP SIGNATURE-----
</pre><hr /><address>Xenproject.org Security Team</address>
</body>
</html>