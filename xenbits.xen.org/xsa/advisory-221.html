<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>XSA-221 - Xen Security Advisories</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1>Information</h1><table><tr><th>Advisory</th> <td><a href="advisory-221.html">XSA-221</a></td></tr><tr><th>Public release</th> <td>2017-06-20 11:58</td></tr><tr><th>Updated</th> <td>2017-07-07 13:52</td></tr><tr><th>Version</th> <td>3</td></tr><tr><th>CVE(s)</th> <td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10917">CVE-2017-10917</a></td></tr><tr><th>Title</th> <td>NULL pointer deref in event channel poll</td></tr></table><h1>Files</h1><a href="advisory-221.txt">advisory-221.txt</a> (signed advisory file)<br /><a href="xsa221.patch">xsa221.patch</a><h1>Advisory</h1><hr /><pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2017-10917 / XSA-221
                              version 3

               NULL pointer deref in event channel poll

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

When polling event channels, in general arbitrary port numbers can be
specified.  Specifically, there is no requirement that a polled event
channel ports has ever been created.  When the code was generalised
from an earlier implementation, introducing some intermediate
pointers, a check should have been made that these intermediate
pointers are non-NULL.  However, that check was omitted.

IMPACT
======

A malicious or buggy guest may cause the hypervisor to access
addresses it doesn&#39;t control, usually leading to a host crash (Denial
of Service).  Information leaks cannot be excluded.

VULNERABLE SYSTEMS
==================

Xen versions 4.4 and newer are vulnerable.  Xen versions 4.3 and
earlier are not affected.

Both x86 and ARM systems are vulnerable.

While all guest kinds can cause a Denial of Service, only x86 PV guests
may be able to leverage the possible information leaks.

MITIGATION
==========

There is no known mitigation.

CREDITS
=======

This issue was discovered by Ankur Arora of Oracle.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa221.patch           Xen 4.4.x and later, including xen-unstable

$ sha256sum xsa221*
<a href="xsa221.patch">2425396a713466808b0f75f91337be4dd20a4dee7733972b04489773c6e97655  xsa221.patch</a>
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team&#39;s decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community&#39;s agreed Security Policy:
  <a href="http://www.xenproject.org/security-policy.html">http://www.xenproject.org/security-policy.html</a>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZX5IrAAoJEIP+FMlX6CvZvrQH/iiAi2rNN1mXhC9wRArVRhN4
CHQLswKxeCfL38sAkOCD1oshNsf5Cskv5WI0/row0SzUPuwsdglPBvpXjUdC+4c/
TNm119wRA3XigJl/eW+OlenA/QdXIjp7D3/IqVu5fEZ+bGntOgo7q4GhgsRRl2SR
mKMgoN7/PCaLd5KtoCr76FygqBcTHYQDswa97alNXdwALC5PPb1R8lO+GDq4FPNj
VYCsynBjVhScnbayEWmbPLXvkaz+6u2VccpfWDIS7i+dyTnAVTNkqS+Mzjsk07za
FRisjlyc3rZTF/7nJ9Vtk4bCPC3+zmKsCTfzbOqdDYu9VJryK7gZl8yksfqw37s=
=HElV
-----END PGP SIGNATURE-----
</pre><hr /><address>Xenproject.org Security Team</address>
</body>
</html>